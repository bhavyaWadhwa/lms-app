{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\n\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\n\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\n\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar GraphqlQuery = require(\"../../shared/utils/GraphqlQuery.bs.js\");\n\nvar TopicsShow__Post = require(\"../types/TopicsShow__Post.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nvar ppx_printed_query = \"mutation CreatePostLikeMutation($postId: ID!)  {\\ncreatePostLike(postId: $postId)  {\\nsuccess  \\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"createPostLike\");\n  var tmp;\n\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"success\");\n    var tmp$1;\n\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeBoolean(value$3);\n      tmp$1 = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$3));\n    } else {\n      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field success on type CreatePostLikePayload is missing\");\n    }\n\n    tmp = {\n      success: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field createPostLike on type Mutation is missing\");\n  }\n\n  return {\n    createPostLike: tmp\n  };\n}\n\nfunction make(postId, param) {\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"postId\", postId]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeWithVariables(variables) {\n  var postId = variables.postId;\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"postId\", postId]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeVariables(postId, param) {\n  return Js_dict.fromArray([\n  /* tuple */\n  [\"postId\", postId]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  }));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, postId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n  /* tuple */\n  [\"postId\", postId]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  })));\n}\n\nvar definition =\n/* tuple */\n[parse, ppx_printed_query, definition_002];\n\nfunction ret_type(f) {\n  return {};\n}\n\nvar MT_Ret = {};\nvar CreatePostLikeQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\nvar ppx_printed_query$1 = \"mutation DeletePostLikeMutation($postId: ID!)  {\\ndeletePostLike(postId: $postId)  {\\nsuccess  \\n}\\n\\n}\\n\";\n\nfunction parse$1(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"deletePostLike\");\n  var tmp;\n\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"success\");\n    var tmp$1;\n\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeBoolean(value$3);\n      tmp$1 = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$3));\n    } else {\n      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field success on type DeletePostLikePayload is missing\");\n    }\n\n    tmp = {\n      success: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field deletePostLike on type Mutation is missing\");\n  }\n\n  return {\n    deletePostLike: tmp\n  };\n}\n\nfunction make$1(postId, param) {\n  return {\n    query: ppx_printed_query$1,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"postId\", postId]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse$1\n  };\n}\n\nfunction makeWithVariables$1(variables) {\n  var postId = variables.postId;\n  return {\n    query: ppx_printed_query$1,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"postId\", postId]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse$1\n  };\n}\n\nfunction makeVariables$1(postId, param) {\n  return Js_dict.fromArray([\n  /* tuple */\n  [\"postId\", postId]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  }));\n}\n\nfunction definition_002$1(graphql_ppx_use_json_variables_fn, postId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n  /* tuple */\n  [\"postId\", postId]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  })));\n}\n\nvar definition$1 =\n/* tuple */\n[parse$1, ppx_printed_query$1, definition_002$1];\n\nfunction ret_type$1(f) {\n  return {};\n}\n\nvar MT_Ret$1 = {};\nvar DeletePostLikeQuery = {\n  ppx_printed_query: ppx_printed_query$1,\n  query: ppx_printed_query$1,\n  parse: parse$1,\n  make: make$1,\n  makeWithVariables: makeWithVariables$1,\n  makeVariables: makeVariables$1,\n  definition: definition$1,\n  ret_type: ret_type$1,\n  MT_Ret: MT_Ret$1\n};\n\nfunction iconClasses(liked, saving) {\n  return \"text-lg\" + (saving ? \" fas fa-thumbs-up cursor-pointer text-primary-200\" : liked ? \" fas fa-thumbs-up cursor-pointer text-primary-400\" : \" far fa-thumbs-up cursor-pointer\");\n}\n\nfunction handlePostLike(saving, liked, setSaving, postId, removeLikeCB, handleCreateResponse, addLikeCB, $$event) {\n  $$event.preventDefault();\n\n  if (saving) {\n    return (\n      /* () */\n      0\n    );\n  } else {\n    Curry._1(setSaving, function (param) {\n      return true;\n    });\n\n    if (liked) {\n      (function (eta) {\n        return GraphqlQuery.sendQuery(undefined, eta);\n      })(make$1(postId,\n      /* () */\n      0)).then(function (response) {\n        if (response.deletePostLike.success) {\n          Curry._1(removeLikeCB,\n          /* () */\n          0);\n\n          Curry._1(setSaving, function (param) {\n            return false;\n          });\n        } else {\n          Curry._1(setSaving, function (param) {\n            return false;\n          });\n        }\n\n        return Promise.resolve(\n        /* () */\n        0);\n      })[\"catch\"](function (param) {\n        Curry._1(setSaving, function (param) {\n          return false;\n        });\n\n        return Promise.resolve(\n        /* () */\n        0);\n      });\n      return (\n        /* () */\n        0\n      );\n    } else {\n      (function (eta) {\n        return GraphqlQuery.sendQuery(undefined, eta);\n      })(make(postId,\n      /* () */\n      0)).then(function (response) {\n        if (response.createPostLike.success) {\n          Curry._2(handleCreateResponse, setSaving, addLikeCB);\n        } else {\n          Curry._1(setSaving, function (param) {\n            return false;\n          });\n        }\n\n        return Promise.resolve(\n        /* () */\n        0);\n      })[\"catch\"](function (param) {\n        Curry._1(setSaving, function (param) {\n          return false;\n        });\n\n        return Promise.resolve(\n        /* () */\n        0);\n      });\n      return (\n        /* () */\n        0\n      );\n    }\n  }\n}\n\nfunction handleCreateResponse(setSaving, addLikeCB) {\n  Curry._1(setSaving, function (param) {\n    return false;\n  });\n\n  return Curry._1(addLikeCB,\n  /* () */\n  0);\n}\n\nfunction TopicsShow__LikeManager(Props) {\n  var post = Props.post;\n  var addPostLikeCB = Props.addPostLikeCB;\n  var removePostLikeCB = Props.removePostLikeCB;\n  var match = React.useState(function () {\n    return false;\n  });\n  var setSaving = match[1];\n  var saving = match[0];\n  var liked = TopicsShow__Post.likedByUser(post);\n  var partial_arg = TopicsShow__Post.id(post);\n  return React.createElement(\"div\", {\n    className: \"text-center pr-3 md:pr-4\"\n  }, React.createElement(\"div\", {\n    \"aria-label\": (liked ? \"Unlike\" : \"Like\") + (\" reply \" + TopicsShow__Post.id(post)),\n    className: \"cursor-pointer\",\n    onClick: function onClick(param) {\n      return handlePostLike(saving, liked, setSaving, partial_arg, removePostLikeCB, handleCreateResponse, addPostLikeCB, param);\n    }\n  }, React.createElement(\"div\", {\n    key: iconClasses(liked, saving),\n    className: \"flex items-center justify-center rounded-lg lg:rounded-full lg:bg-gray-100 hover:bg-gray-300 text-gray-700 hover:text-gray-900 h-8 w-8 md:h-10 md:w-10 p-1 md:p-2 mx-auto\"\n  }, React.createElement(\"i\", {\n    className: iconClasses(liked, saving)\n  })), React.createElement(\"p\", {\n    className: \"text-tiny lg:text-xs font-semibold\"\n  }, String(TopicsShow__Post.totalLikes(post)))));\n}\n\nvar make$2 = TopicsShow__LikeManager;\nexports.str = str;\nexports.CreatePostLikeQuery = CreatePostLikeQuery;\nexports.DeletePostLikeQuery = DeletePostLikeQuery;\nexports.iconClasses = iconClasses;\nexports.handlePostLike = handlePostLike;\nexports.handleCreateResponse = handleCreateResponse;\nexports.make = make$2;\n/* react Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/topics/components/TopicsShow__LikeManager.bs.js"],"names":["Curry","require","React","Js_exn","Js_dict","Js_json","Js_option","Caml_option","GraphqlQuery","TopicsShow__Post","str","prim","ppx_printed_query","parse","value","value$1","getExn","decodeObject","match","get","tmp","undefined","value$2","valFromOption","match$1","tmp$1","value$3","match$2","decodeBoolean","raiseError","JSON","stringify","success","createPostLike","make","postId","param","query","variables","fromArray","filter","test","makeWithVariables","makeVariables","definition_002","graphql_ppx_use_json_variables_fn","_1","definition","ret_type","f","MT_Ret","CreatePostLikeQuery","ppx_printed_query$1","parse$1","deletePostLike","make$1","makeWithVariables$1","makeVariables$1","definition_002$1","definition$1","ret_type$1","MT_Ret$1","DeletePostLikeQuery","iconClasses","liked","saving","handlePostLike","setSaving","removeLikeCB","handleCreateResponse","addLikeCB","$$event","preventDefault","eta","sendQuery","then","response","Promise","resolve","_2","TopicsShow__LikeManager","Props","post","addPostLikeCB","removePostLikeCB","useState","likedByUser","partial_arg","id","createElement","className","onClick","key","String","totalLikes","make$2","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar GraphqlQuery = require(\"../../shared/utils/GraphqlQuery.bs.js\");\nvar TopicsShow__Post = require(\"../types/TopicsShow__Post.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nvar ppx_printed_query = \"mutation CreatePostLikeMutation($postId: ID!)  {\\ncreatePostLike(postId: $postId)  {\\nsuccess  \\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"createPostLike\");\n  var tmp;\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"success\");\n    var tmp$1;\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeBoolean(value$3);\n      tmp$1 = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$3));\n    } else {\n      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field success on type CreatePostLikePayload is missing\");\n    }\n    tmp = {\n      success: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field createPostLike on type Mutation is missing\");\n  }\n  return {\n          createPostLike: tmp\n        };\n}\n\nfunction make(postId, param) {\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([/* tuple */[\n                    \"postId\",\n                    postId\n                  ]].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeWithVariables(variables) {\n  var postId = variables.postId;\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([/* tuple */[\n                    \"postId\",\n                    postId\n                  ]].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeVariables(postId, param) {\n  return Js_dict.fromArray([/* tuple */[\n                  \"postId\",\n                  postId\n                ]].filter((function (param) {\n                    return !Js_json.test(param[1], /* Null */5);\n                  })));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, postId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([/* tuple */[\n                      \"postId\",\n                      postId\n                    ]].filter((function (param) {\n                        return !Js_json.test(param[1], /* Null */5);\n                      }))));\n}\n\nvar definition = /* tuple */[\n  parse,\n  ppx_printed_query,\n  definition_002\n];\n\nfunction ret_type(f) {\n  return { };\n}\n\nvar MT_Ret = { };\n\nvar CreatePostLikeQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nvar ppx_printed_query$1 = \"mutation DeletePostLikeMutation($postId: ID!)  {\\ndeletePostLike(postId: $postId)  {\\nsuccess  \\n}\\n\\n}\\n\";\n\nfunction parse$1(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"deletePostLike\");\n  var tmp;\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"success\");\n    var tmp$1;\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeBoolean(value$3);\n      tmp$1 = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$3));\n    } else {\n      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field success on type DeletePostLikePayload is missing\");\n    }\n    tmp = {\n      success: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field deletePostLike on type Mutation is missing\");\n  }\n  return {\n          deletePostLike: tmp\n        };\n}\n\nfunction make$1(postId, param) {\n  return {\n          query: ppx_printed_query$1,\n          variables: Js_dict.fromArray([/* tuple */[\n                    \"postId\",\n                    postId\n                  ]].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse$1\n        };\n}\n\nfunction makeWithVariables$1(variables) {\n  var postId = variables.postId;\n  return {\n          query: ppx_printed_query$1,\n          variables: Js_dict.fromArray([/* tuple */[\n                    \"postId\",\n                    postId\n                  ]].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse$1\n        };\n}\n\nfunction makeVariables$1(postId, param) {\n  return Js_dict.fromArray([/* tuple */[\n                  \"postId\",\n                  postId\n                ]].filter((function (param) {\n                    return !Js_json.test(param[1], /* Null */5);\n                  })));\n}\n\nfunction definition_002$1(graphql_ppx_use_json_variables_fn, postId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([/* tuple */[\n                      \"postId\",\n                      postId\n                    ]].filter((function (param) {\n                        return !Js_json.test(param[1], /* Null */5);\n                      }))));\n}\n\nvar definition$1 = /* tuple */[\n  parse$1,\n  ppx_printed_query$1,\n  definition_002$1\n];\n\nfunction ret_type$1(f) {\n  return { };\n}\n\nvar MT_Ret$1 = { };\n\nvar DeletePostLikeQuery = {\n  ppx_printed_query: ppx_printed_query$1,\n  query: ppx_printed_query$1,\n  parse: parse$1,\n  make: make$1,\n  makeWithVariables: makeWithVariables$1,\n  makeVariables: makeVariables$1,\n  definition: definition$1,\n  ret_type: ret_type$1,\n  MT_Ret: MT_Ret$1\n};\n\nfunction iconClasses(liked, saving) {\n  return \"text-lg\" + (\n          saving ? \" fas fa-thumbs-up cursor-pointer text-primary-200\" : (\n              liked ? \" fas fa-thumbs-up cursor-pointer text-primary-400\" : \" far fa-thumbs-up cursor-pointer\"\n            )\n        );\n}\n\nfunction handlePostLike(saving, liked, setSaving, postId, removeLikeCB, handleCreateResponse, addLikeCB, $$event) {\n  $$event.preventDefault();\n  if (saving) {\n    return /* () */0;\n  } else {\n    Curry._1(setSaving, (function (param) {\n            return true;\n          }));\n    if (liked) {\n      (function (eta) {\n                return GraphqlQuery.sendQuery(undefined, eta);\n              })(make$1(postId, /* () */0)).then((function (response) {\n                if (response.deletePostLike.success) {\n                  Curry._1(removeLikeCB, /* () */0);\n                  Curry._1(setSaving, (function (param) {\n                          return false;\n                        }));\n                } else {\n                  Curry._1(setSaving, (function (param) {\n                          return false;\n                        }));\n                }\n                return Promise.resolve(/* () */0);\n              })).catch((function (param) {\n              Curry._1(setSaving, (function (param) {\n                      return false;\n                    }));\n              return Promise.resolve(/* () */0);\n            }));\n      return /* () */0;\n    } else {\n      (function (eta) {\n                return GraphqlQuery.sendQuery(undefined, eta);\n              })(make(postId, /* () */0)).then((function (response) {\n                if (response.createPostLike.success) {\n                  Curry._2(handleCreateResponse, setSaving, addLikeCB);\n                } else {\n                  Curry._1(setSaving, (function (param) {\n                          return false;\n                        }));\n                }\n                return Promise.resolve(/* () */0);\n              })).catch((function (param) {\n              Curry._1(setSaving, (function (param) {\n                      return false;\n                    }));\n              return Promise.resolve(/* () */0);\n            }));\n      return /* () */0;\n    }\n  }\n}\n\nfunction handleCreateResponse(setSaving, addLikeCB) {\n  Curry._1(setSaving, (function (param) {\n          return false;\n        }));\n  return Curry._1(addLikeCB, /* () */0);\n}\n\nfunction TopicsShow__LikeManager(Props) {\n  var post = Props.post;\n  var addPostLikeCB = Props.addPostLikeCB;\n  var removePostLikeCB = Props.removePostLikeCB;\n  var match = React.useState((function () {\n          return false;\n        }));\n  var setSaving = match[1];\n  var saving = match[0];\n  var liked = TopicsShow__Post.likedByUser(post);\n  var partial_arg = TopicsShow__Post.id(post);\n  return React.createElement(\"div\", {\n              className: \"text-center pr-3 md:pr-4\"\n            }, React.createElement(\"div\", {\n                  \"aria-label\": (\n                    liked ? \"Unlike\" : \"Like\"\n                  ) + (\" reply \" + TopicsShow__Post.id(post)),\n                  className: \"cursor-pointer\",\n                  onClick: (function (param) {\n                      return handlePostLike(saving, liked, setSaving, partial_arg, removePostLikeCB, handleCreateResponse, addPostLikeCB, param);\n                    })\n                }, React.createElement(\"div\", {\n                      key: iconClasses(liked, saving),\n                      className: \"flex items-center justify-center rounded-lg lg:rounded-full lg:bg-gray-100 hover:bg-gray-300 text-gray-700 hover:text-gray-900 h-8 w-8 md:h-10 md:w-10 p-1 md:p-2 mx-auto\"\n                    }, React.createElement(\"i\", {\n                          className: iconClasses(liked, saving)\n                        })), React.createElement(\"p\", {\n                      className: \"text-tiny lg:text-xs font-semibold\"\n                    }, String(TopicsShow__Post.totalLikes(post)))));\n}\n\nvar make$2 = TopicsShow__LikeManager;\n\nexports.str = str;\nexports.CreatePostLikeQuery = CreatePostLikeQuery;\nexports.DeletePostLikeQuery = DeletePostLikeQuery;\nexports.iconClasses = iconClasses;\nexports.handlePostLike = handlePostLike;\nexports.handleCreateResponse = handleCreateResponse;\nexports.make = make$2;\n/* react Not a pure module */\n"]},"metadata":{},"sourceType":"module"}