{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../../../../shared/Api.bs.js\");\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\n\nvar Block = require(\"bs-platform/lib/js/block.js\");\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\n\nvar $$String = require(\"bs-platform/lib/js/string.js\");\n\nvar DateFns = require(\"../../../../shared/utils/DateFns.bs.js\");\n\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\n\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\n\nvar DomUtils = require(\"../../../../shared/utils/DomUtils.bs.js\");\n\nvar HelpIcon = require(\"../../../../shared/components/HelpIcon.bs.js\");\n\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\n\nvar DatePicker = require(\"../../../../shared/components/DatePicker.bs.js\");\n\nvar Belt_Option = require(\"bs-platform/lib/js/belt_Option.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\n\nvar WindowUtils = require(\"../../../../shared/utils/WindowUtils.bs.js\");\n\nvar GraphqlQuery = require(\"../../../../shared/utils/GraphqlQuery.bs.js\");\n\nvar $$Notification = require(\"../../../../shared/Notification.bs.js\");\n\nvar DisablingCover = require(\"../../../../shared/components/DisablingCover.bs.js\");\n\nvar AuthenticityToken = require(\"../../../../shared/utils/AuthenticityToken.bs.js\");\n\nvar CurriculumEditor__Level = require(\"../../types/curriculum_editor/CurriculumEditor__Level.bs.js\");\n\nvar CurriculumEditor__Course = require(\"../../types/curriculum_editor/CurriculumEditor__Course.bs.js\");\n\nvar SchoolAdmin__EditorDrawer = require(\"../../../components/SchoolAdmin__EditorDrawer.bs.js\");\n\nrequire(\"./CurriculumEditor__LevelEditor.css\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    if (action ===\n    /* BeginSaving */\n    0) {\n      return {\n        name: state.name,\n        unlockOn: state.unlockOn,\n        hasNameError: state.hasNameError,\n        dirty: state.dirty,\n        saving: true,\n        tab: state.tab,\n        mergeIntoLevelId: state.mergeIntoLevelId\n      };\n    } else {\n      return {\n        name: state.name,\n        unlockOn: state.unlockOn,\n        hasNameError: state.hasNameError,\n        dirty: state.dirty,\n        saving: false,\n        tab: state.tab,\n        mergeIntoLevelId: state.mergeIntoLevelId\n      };\n    }\n  } else {\n    switch (action.tag | 0) {\n      case\n      /* UpdateName */\n      0:\n        return {\n          name: action[0],\n          unlockOn: state.unlockOn,\n          hasNameError: action[1],\n          dirty: true,\n          saving: state.saving,\n          tab: state.tab,\n          mergeIntoLevelId: state.mergeIntoLevelId\n        };\n\n      case\n      /* UpdateUnlockOn */\n      1:\n        return {\n          name: state.name,\n          unlockOn: action[0],\n          hasNameError: state.hasNameError,\n          dirty: true,\n          saving: state.saving,\n          tab: state.tab,\n          mergeIntoLevelId: state.mergeIntoLevelId\n        };\n\n      case\n      /* UpdateTab */\n      2:\n        return {\n          name: state.name,\n          unlockOn: state.unlockOn,\n          hasNameError: state.hasNameError,\n          dirty: state.dirty,\n          saving: state.saving,\n          tab: action[0],\n          mergeIntoLevelId: state.mergeIntoLevelId\n        };\n\n      case\n      /* SelectLevelToMergeInto */\n      3:\n        return {\n          name: state.name,\n          unlockOn: state.unlockOn,\n          hasNameError: state.hasNameError,\n          dirty: state.dirty,\n          saving: state.saving,\n          tab: state.tab,\n          mergeIntoLevelId: action[0]\n        };\n    }\n  }\n}\n\nfunction updateName(send, name) {\n  var hasError = $$String.trim(name).length < 2;\n  return Curry._1(send,\n  /* UpdateName */\n  Block.__(0, [name, hasError]));\n}\n\nfunction saveDisabled(state) {\n  if (state.hasNameError || !state.dirty) {\n    return true;\n  } else {\n    return state.saving;\n  }\n}\n\nfunction setPayload(authenticityToken, state) {\n  var payload = {};\n  payload[\"authenticity_token\"] = authenticityToken;\n  payload[\"name\"] = state.name;\n  payload[\"unlock_on\"] = Belt_Option.mapWithDefault(state.unlockOn, \"\", DateFns.encodeISO);\n  return payload;\n}\n\nfunction formClasses(value) {\n  if (value) {\n    return \"drawer-right-form w-full opacity-50\";\n  } else {\n    return \"drawer-right-form w-full\";\n  }\n}\n\nfunction computeInitialState(level) {\n  var match;\n\n  if (level !== undefined) {\n    var level$1 = level;\n    match =\n    /* tuple */\n    [CurriculumEditor__Level.name(level$1), CurriculumEditor__Level.unlockOn(level$1)];\n  } else {\n    match =\n    /* tuple */\n    [\"\", undefined];\n  }\n\n  return {\n    name: match[0],\n    unlockOn: match[1],\n    hasNameError: false,\n    dirty: false,\n    saving: false,\n    tab:\n    /* Details */\n    0,\n    mergeIntoLevelId: \"0\"\n  };\n}\n\nfunction drawerTitle(level) {\n  if (level !== undefined) {\n    return \"Edit Level \" + String(CurriculumEditor__Level.number(level));\n  } else {\n    return \"Create New Level\";\n  }\n}\n\nfunction handleResponseCB(level, updateLevelsCB, state, json) {\n  var id = Json_decode.field(\"id\", Json_decode.string, json);\n  var number = Json_decode.field(\"number\", Json_decode.$$int, json);\n  var newLevel = CurriculumEditor__Level.create(id, state.name, number, state.unlockOn);\n\n  if (level !== undefined) {\n    $$Notification.success(\"Success\", \"Level updated successfully\");\n  } else {\n    $$Notification.success(\"Success\", \"Level created successfully\");\n  }\n\n  return Curry._1(updateLevelsCB, newLevel);\n}\n\nfunction createLevel(course, updateLevelsCB, state, send) {\n  Curry._1(send,\n  /* BeginSaving */\n  0);\n\n  var handleErrorCB = function handleErrorCB(param) {\n    return Curry._1(send,\n    /* FailSaving */\n    1);\n  };\n\n  var url = \"/school/courses/\" + (CurriculumEditor__Course.id(course) + \"/levels\");\n  return Api.create(url, setPayload(AuthenticityToken.fromHead(\n  /* () */\n  0), state), function (param) {\n    return handleResponseCB(undefined, updateLevelsCB, state, param);\n  }, handleErrorCB);\n}\n\nfunction updateLevel(level, updateLevelsCB, state, send) {\n  Curry._1(send,\n  /* BeginSaving */\n  0);\n\n  var handleErrorCB = function handleErrorCB(param) {\n    return Curry._1(send,\n    /* FailSaving */\n    1);\n  };\n\n  var url = \"/school/levels/\" + CurriculumEditor__Level.id(level);\n  var partial_arg = level;\n  return Api.update(url, setPayload(AuthenticityToken.fromHead(\n  /* () */\n  0), state), function (param) {\n    return handleResponseCB(partial_arg, updateLevelsCB, state, param);\n  }, handleErrorCB);\n}\n\nfunction detailsForm(level, course, updateLevelsCB, state, send) {\n  var match = state.tab;\n  var visibiltyClass = match ? \"hidden\" : undefined;\n  var tmp = {};\n\n  if (visibiltyClass !== undefined) {\n    tmp.className = Caml_option.valFromOption(visibiltyClass);\n  }\n\n  var tmp$1 = {\n    onChange: function onChange(date) {\n      return Curry._1(send,\n      /* UpdateUnlockOn */\n      Block.__(1, [date]));\n    },\n    id: \"unlock-on-input\"\n  };\n\n  if (state.unlockOn !== undefined) {\n    tmp$1.selected = Caml_option.valFromOption(state.unlockOn);\n  }\n\n  var tmp$2;\n\n  if (level !== undefined) {\n    var level$1 = level;\n    tmp$2 = React.createElement(\"button\", {\n      className: \"w-full btn btn-large btn-primary\",\n      disabled: saveDisabled(state),\n      onClick: function onClick(_event) {\n        return updateLevel(level$1, updateLevelsCB, state, send);\n      }\n    }, \"Update Level\");\n  } else {\n    tmp$2 = React.createElement(\"button\", {\n      className: \"w-full btn btn-large btn-primary\",\n      disabled: saveDisabled(state),\n      onClick: function onClick(_event) {\n        return createLevel(course, updateLevelsCB, state, send);\n      }\n    }, \"Create New Level\");\n  }\n\n  return React.createElement(\"div\", tmp, React.createElement(\"div\", {\n    className: \"mt-5\"\n  }, React.createElement(\"label\", {\n    className: \"inline-block tracking-wide text-xs font-semibold\",\n    htmlFor: \"name\"\n  }, \"Level Name\"), React.createElement(\"input\", {\n    className: \"appearance-none block w-full bg-white border border-gray-400 rounded py-3 px-4 mt-2 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\",\n    id: \"name\",\n    placeholder: \"Type level name here\",\n    type: \"text\",\n    value: state.name,\n    onChange: function onChange($$event) {\n      return updateName(send, $$event.target.value);\n    }\n  }), state.hasNameError ? React.createElement(\"div\", {\n    className: \"drawer-right-form__error-msg\"\n  }, \"not a valid name\") : null), React.createElement(\"div\", {\n    className: \"mt-5\"\n  }, React.createElement(\"label\", {\n    className: \"tracking-wide text-xs font-semibold\",\n    htmlFor: \"unlock-on-input\"\n  }, \"Unlock level on\"), React.createElement(\"span\", {\n    className: \"text-xs\"\n  }, \" (optional)\"), React.createElement(DatePicker.make, tmp$1)), React.createElement(\"div\", {\n    className: \"flex mt-5\"\n  }, tmp$2));\n}\n\nfunction handleSelectLevelForDeletion(send, $$event) {\n  var target = $$event.target;\n  return Curry._1(send,\n  /* SelectLevelToMergeInto */\n  Block.__(3, [target.value]));\n}\n\nvar ppx_printed_query = \"mutation MergeLevelsQuery($deleteLevelId: ID!, $mergeIntoLevelId: ID!)  {\\nmergeLevels(deleteLevelId: $deleteLevelId, mergeIntoLevelId: $mergeIntoLevelId)  {\\nsuccess  \\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"mergeLevels\");\n  var tmp;\n\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"success\");\n    var tmp$1;\n\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeBoolean(value$3);\n      tmp$1 = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$3));\n    } else {\n      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field success on type MergeLevelsPayload is missing\");\n    }\n\n    tmp = {\n      success: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field mergeLevels on type Mutation is missing\");\n  }\n\n  return {\n    mergeLevels: tmp\n  };\n}\n\nfunction make(deleteLevelId, mergeIntoLevelId, param) {\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"deleteLevelId\", deleteLevelId],\n    /* tuple */\n    [\"mergeIntoLevelId\", mergeIntoLevelId]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeWithVariables(variables) {\n  var deleteLevelId = variables.deleteLevelId;\n  var mergeIntoLevelId = variables.mergeIntoLevelId;\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"deleteLevelId\", deleteLevelId],\n    /* tuple */\n    [\"mergeIntoLevelId\", mergeIntoLevelId]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeVariables(deleteLevelId, mergeIntoLevelId, param) {\n  return Js_dict.fromArray([\n  /* tuple */\n  [\"deleteLevelId\", deleteLevelId],\n  /* tuple */\n  [\"mergeIntoLevelId\", mergeIntoLevelId]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  }));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, deleteLevelId, mergeIntoLevelId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n  /* tuple */\n  [\"deleteLevelId\", deleteLevelId],\n  /* tuple */\n  [\"mergeIntoLevelId\", mergeIntoLevelId]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  })));\n}\n\nvar definition =\n/* tuple */\n[parse, ppx_printed_query, definition_002];\n\nfunction ret_type(f) {\n  return {};\n}\n\nvar MT_Ret = {};\nvar MergeLevelsQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction deleteSelectedLevel(state, send, level, _event) {\n  return WindowUtils.confirm(undefined, \"Are you sure? This action cannot be undone.\", function (param) {\n    Curry._1(send,\n    /* BeginSaving */\n    0);\n\n    (function (eta) {\n      return GraphqlQuery.sendQuery(undefined, eta);\n    })(make(CurriculumEditor__Level.id(level), state.mergeIntoLevelId,\n    /* () */\n    0)).then(function (result) {\n      if (result.mergeLevels.success) {\n        DomUtils.reload(\n        /* () */\n        0);\n      } else {\n        Curry._1(send,\n        /* FailSaving */\n        1);\n      }\n\n      return Promise.resolve(\n      /* () */\n      0);\n    })[\"catch\"](function (error) {\n      console.log(error);\n      $$Notification.error(\"Oops!\", \"Something went wrong when we tried to merge & delete this level. Please reload this page before trying again.\");\n      return Promise.resolve(\n      /* () */\n      0);\n    });\n    return (\n      /* () */\n      0\n    );\n  });\n}\n\nfunction actionsForm(level, levels, state, send) {\n  var match = state.tab;\n  var visibiltyClass = match ? undefined : \"hidden\";\n  var otherLevels = levels.filter(function (l) {\n    if (CurriculumEditor__Level.id(level) !== CurriculumEditor__Level.id(l)) {\n      return CurriculumEditor__Level.number(l) !== 0;\n    } else {\n      return false;\n    }\n  });\n  var tmp = {};\n\n  if (visibiltyClass !== undefined) {\n    tmp.className = Caml_option.valFromOption(visibiltyClass);\n  }\n\n  return React.createElement(\"div\", tmp, React.createElement(\"div\", {\n    className: \"mt-5\"\n  }, React.createElement(\"label\", {\n    className: \"inline-block tracking-wide text-xs font-semibold\",\n    htmlFor: \"delete-and-merge-level\"\n  }, \"Delete & Merge Into\"), React.createElement(HelpIcon.make, {\n    className: \"ml-1 text-sm\",\n    children: \"Pick another level to merge this level into. This action will shift all targets and students in level.\"\n  }), React.createElement(\"select\", {\n    className: \"cursor-pointer appearance-none block w-full bg-white border border-gray-400 rounded py-3 px-4 mt-2 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\",\n    id: \"delete-and-merge-level\",\n    value: state.mergeIntoLevelId,\n    onChange: function onChange(param) {\n      return handleSelectLevelForDeletion(send, param);\n    }\n  }, React.createElement(\"option\", {\n    key: \"0\",\n    value: \"0\"\n  }, \"Select a different level\"), $$Array.map(function (level) {\n    return React.createElement(\"option\", {\n      key: CurriculumEditor__Level.id(level),\n      value: CurriculumEditor__Level.id(level)\n    }, \"L\" + (String(CurriculumEditor__Level.number(level)) + (\": \" + CurriculumEditor__Level.name(level))));\n  }, otherLevels)), React.createElement(\"button\", {\n    className: \"btn btn-primary mt-2\",\n    disabled: state.mergeIntoLevelId === \"0\",\n    onClick: function onClick(param) {\n      return deleteSelectedLevel(state, send, level, param);\n    }\n  }, \"Merge and Delete\")));\n}\n\nfunction tab(tab$1, state, send) {\n  var defaultClasses = \"level-editor__tab cursor-pointer\";\n  var match = tab$1 ?\n  /* tuple */\n  [\"Actions\", \"fa-cogs\"] :\n  /* tuple */\n  [\"Details\", \"fa-list-alt\"];\n  var selected = tab$1 === state.tab;\n  var classes = selected ? \"level-editor__tab cursor-pointer level-editor__tab--selected\" : defaultClasses;\n  return React.createElement(\"button\", {\n    className: classes,\n    onClick: function onClick(_e) {\n      return Curry._1(send,\n      /* UpdateTab */\n      Block.__(2, [tab$1]));\n    }\n  }, React.createElement(\"i\", {\n    className: \"fas \" + match[1]\n  }), React.createElement(\"span\", {\n    className: \"ml-2\"\n  }, match[0]));\n}\n\nfunction CurriculumEditor__LevelEditor(Props) {\n  var level = Props.level;\n  var levels = Props.levels;\n  var course = Props.course;\n  var hideEditorActionCB = Props.hideEditorActionCB;\n  var updateLevelsCB = Props.updateLevelsCB;\n  var match = React.useReducer(reducer, level, computeInitialState);\n  var send = match[1];\n  var state = match[0];\n  return React.createElement(SchoolAdmin__EditorDrawer.make, {\n    closeDrawerCB: hideEditorActionCB,\n    children: React.createElement(DisablingCover.make, {\n      disabled: state.saving,\n      children: null\n    }, React.createElement(\"div\", {\n      className: \"bg-gray-200 pt-6\"\n    }, React.createElement(\"div\", {\n      className: \"max-w-2xl px-6 mx-auto\"\n    }, React.createElement(\"h3\", undefined, drawerTitle(level))), level !== undefined ? React.createElement(\"div\", {\n      className: \"flex w-full max-w-2xl mx-auto px-6 text-sm -mb-px mt-2\"\n    }, tab(\n    /* Details */\n    0, state, send), tab(\n    /* Actions */\n    1, state, send)) : React.createElement(\"div\", {\n      className: \"h-4\"\n    })), React.createElement(\"div\", {\n      className: \"bg-white\"\n    }, React.createElement(\"div\", {\n      className: \"border-t border-gray-400\"\n    }, React.createElement(\"div\", {\n      className: \"max-w-2xl mx-auto px-6\"\n    }, detailsForm(level, course, updateLevelsCB, state, send), level !== undefined ? actionsForm(level, levels, state, send) : null))))\n  });\n}\n\nvar make$1 = CurriculumEditor__LevelEditor;\nexports.str = str;\nexports.reducer = reducer;\nexports.updateName = updateName;\nexports.saveDisabled = saveDisabled;\nexports.setPayload = setPayload;\nexports.formClasses = formClasses;\nexports.computeInitialState = computeInitialState;\nexports.drawerTitle = drawerTitle;\nexports.handleResponseCB = handleResponseCB;\nexports.createLevel = createLevel;\nexports.updateLevel = updateLevel;\nexports.detailsForm = detailsForm;\nexports.handleSelectLevelForDeletion = handleSelectLevelForDeletion;\nexports.MergeLevelsQuery = MergeLevelsQuery;\nexports.deleteSelectedLevel = deleteSelectedLevel;\nexports.actionsForm = actionsForm;\nexports.tab = tab;\nexports.make = make$1;\n/*  Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/schools/courses/components/curriculum_editor/CurriculumEditor__LevelEditor.bs.js"],"names":["Api","require","$$Array","Block","Curry","React","Js_exn","$$String","DateFns","Js_dict","Js_json","DomUtils","HelpIcon","Js_option","DatePicker","Belt_Option","Caml_option","Json_decode","WindowUtils","GraphqlQuery","$$Notification","DisablingCover","AuthenticityToken","CurriculumEditor__Level","CurriculumEditor__Course","SchoolAdmin__EditorDrawer","str","prim","reducer","state","action","name","unlockOn","hasNameError","dirty","saving","tab","mergeIntoLevelId","tag","updateName","send","hasError","trim","length","_1","__","saveDisabled","setPayload","authenticityToken","payload","mapWithDefault","encodeISO","formClasses","value","computeInitialState","level","match","undefined","level$1","drawerTitle","String","number","handleResponseCB","updateLevelsCB","json","id","field","string","$$int","newLevel","create","success","createLevel","course","handleErrorCB","param","url","fromHead","updateLevel","partial_arg","update","detailsForm","visibiltyClass","tmp","className","valFromOption","tmp$1","onChange","date","selected","tmp$2","createElement","disabled","onClick","_event","htmlFor","placeholder","type","$$event","target","make","handleSelectLevelForDeletion","ppx_printed_query","parse","value$1","getExn","decodeObject","get","value$2","match$1","value$3","match$2","decodeBoolean","raiseError","JSON","stringify","mergeLevels","deleteLevelId","query","variables","fromArray","filter","test","makeWithVariables","makeVariables","definition_002","graphql_ppx_use_json_variables_fn","definition","ret_type","f","MT_Ret","MergeLevelsQuery","deleteSelectedLevel","confirm","eta","sendQuery","then","result","reload","Promise","resolve","error","console","log","actionsForm","levels","otherLevels","l","children","key","map","tab$1","defaultClasses","classes","_e","CurriculumEditor__LevelEditor","Props","hideEditorActionCB","useReducer","closeDrawerCB","make$1","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../../../../shared/Api.bs.js\");\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\nvar Block = require(\"bs-platform/lib/js/block.js\");\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\nvar $$String = require(\"bs-platform/lib/js/string.js\");\nvar DateFns = require(\"../../../../shared/utils/DateFns.bs.js\");\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\nvar DomUtils = require(\"../../../../shared/utils/DomUtils.bs.js\");\nvar HelpIcon = require(\"../../../../shared/components/HelpIcon.bs.js\");\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\nvar DatePicker = require(\"../../../../shared/components/DatePicker.bs.js\");\nvar Belt_Option = require(\"bs-platform/lib/js/belt_Option.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\nvar WindowUtils = require(\"../../../../shared/utils/WindowUtils.bs.js\");\nvar GraphqlQuery = require(\"../../../../shared/utils/GraphqlQuery.bs.js\");\nvar $$Notification = require(\"../../../../shared/Notification.bs.js\");\nvar DisablingCover = require(\"../../../../shared/components/DisablingCover.bs.js\");\nvar AuthenticityToken = require(\"../../../../shared/utils/AuthenticityToken.bs.js\");\nvar CurriculumEditor__Level = require(\"../../types/curriculum_editor/CurriculumEditor__Level.bs.js\");\nvar CurriculumEditor__Course = require(\"../../types/curriculum_editor/CurriculumEditor__Course.bs.js\");\nvar SchoolAdmin__EditorDrawer = require(\"../../../components/SchoolAdmin__EditorDrawer.bs.js\");\n\n((require(\"./CurriculumEditor__LevelEditor.css\")));\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    if (action === /* BeginSaving */0) {\n      return {\n              name: state.name,\n              unlockOn: state.unlockOn,\n              hasNameError: state.hasNameError,\n              dirty: state.dirty,\n              saving: true,\n              tab: state.tab,\n              mergeIntoLevelId: state.mergeIntoLevelId\n            };\n    } else {\n      return {\n              name: state.name,\n              unlockOn: state.unlockOn,\n              hasNameError: state.hasNameError,\n              dirty: state.dirty,\n              saving: false,\n              tab: state.tab,\n              mergeIntoLevelId: state.mergeIntoLevelId\n            };\n    }\n  } else {\n    switch (action.tag | 0) {\n      case /* UpdateName */0 :\n          return {\n                  name: action[0],\n                  unlockOn: state.unlockOn,\n                  hasNameError: action[1],\n                  dirty: true,\n                  saving: state.saving,\n                  tab: state.tab,\n                  mergeIntoLevelId: state.mergeIntoLevelId\n                };\n      case /* UpdateUnlockOn */1 :\n          return {\n                  name: state.name,\n                  unlockOn: action[0],\n                  hasNameError: state.hasNameError,\n                  dirty: true,\n                  saving: state.saving,\n                  tab: state.tab,\n                  mergeIntoLevelId: state.mergeIntoLevelId\n                };\n      case /* UpdateTab */2 :\n          return {\n                  name: state.name,\n                  unlockOn: state.unlockOn,\n                  hasNameError: state.hasNameError,\n                  dirty: state.dirty,\n                  saving: state.saving,\n                  tab: action[0],\n                  mergeIntoLevelId: state.mergeIntoLevelId\n                };\n      case /* SelectLevelToMergeInto */3 :\n          return {\n                  name: state.name,\n                  unlockOn: state.unlockOn,\n                  hasNameError: state.hasNameError,\n                  dirty: state.dirty,\n                  saving: state.saving,\n                  tab: state.tab,\n                  mergeIntoLevelId: action[0]\n                };\n      \n    }\n  }\n}\n\nfunction updateName(send, name) {\n  var hasError = $$String.trim(name).length < 2;\n  return Curry._1(send, /* UpdateName */Block.__(0, [\n                name,\n                hasError\n              ]));\n}\n\nfunction saveDisabled(state) {\n  if (state.hasNameError || !state.dirty) {\n    return true;\n  } else {\n    return state.saving;\n  }\n}\n\nfunction setPayload(authenticityToken, state) {\n  var payload = { };\n  payload[\"authenticity_token\"] = authenticityToken;\n  payload[\"name\"] = state.name;\n  payload[\"unlock_on\"] = Belt_Option.mapWithDefault(state.unlockOn, \"\", DateFns.encodeISO);\n  return payload;\n}\n\nfunction formClasses(value) {\n  if (value) {\n    return \"drawer-right-form w-full opacity-50\";\n  } else {\n    return \"drawer-right-form w-full\";\n  }\n}\n\nfunction computeInitialState(level) {\n  var match;\n  if (level !== undefined) {\n    var level$1 = level;\n    match = /* tuple */[\n      CurriculumEditor__Level.name(level$1),\n      CurriculumEditor__Level.unlockOn(level$1)\n    ];\n  } else {\n    match = /* tuple */[\n      \"\",\n      undefined\n    ];\n  }\n  return {\n          name: match[0],\n          unlockOn: match[1],\n          hasNameError: false,\n          dirty: false,\n          saving: false,\n          tab: /* Details */0,\n          mergeIntoLevelId: \"0\"\n        };\n}\n\nfunction drawerTitle(level) {\n  if (level !== undefined) {\n    return \"Edit Level \" + String(CurriculumEditor__Level.number(level));\n  } else {\n    return \"Create New Level\";\n  }\n}\n\nfunction handleResponseCB(level, updateLevelsCB, state, json) {\n  var id = Json_decode.field(\"id\", Json_decode.string, json);\n  var number = Json_decode.field(\"number\", Json_decode.$$int, json);\n  var newLevel = CurriculumEditor__Level.create(id, state.name, number, state.unlockOn);\n  if (level !== undefined) {\n    $$Notification.success(\"Success\", \"Level updated successfully\");\n  } else {\n    $$Notification.success(\"Success\", \"Level created successfully\");\n  }\n  return Curry._1(updateLevelsCB, newLevel);\n}\n\nfunction createLevel(course, updateLevelsCB, state, send) {\n  Curry._1(send, /* BeginSaving */0);\n  var handleErrorCB = function (param) {\n    return Curry._1(send, /* FailSaving */1);\n  };\n  var url = \"/school/courses/\" + (CurriculumEditor__Course.id(course) + \"/levels\");\n  return Api.create(url, setPayload(AuthenticityToken.fromHead(/* () */0), state), (function (param) {\n                return handleResponseCB(undefined, updateLevelsCB, state, param);\n              }), handleErrorCB);\n}\n\nfunction updateLevel(level, updateLevelsCB, state, send) {\n  Curry._1(send, /* BeginSaving */0);\n  var handleErrorCB = function (param) {\n    return Curry._1(send, /* FailSaving */1);\n  };\n  var url = \"/school/levels/\" + CurriculumEditor__Level.id(level);\n  var partial_arg = level;\n  return Api.update(url, setPayload(AuthenticityToken.fromHead(/* () */0), state), (function (param) {\n                return handleResponseCB(partial_arg, updateLevelsCB, state, param);\n              }), handleErrorCB);\n}\n\nfunction detailsForm(level, course, updateLevelsCB, state, send) {\n  var match = state.tab;\n  var visibiltyClass = match ? \"hidden\" : undefined;\n  var tmp = { };\n  if (visibiltyClass !== undefined) {\n    tmp.className = Caml_option.valFromOption(visibiltyClass);\n  }\n  var tmp$1 = {\n    onChange: (function (date) {\n        return Curry._1(send, /* UpdateUnlockOn */Block.__(1, [date]));\n      }),\n    id: \"unlock-on-input\"\n  };\n  if (state.unlockOn !== undefined) {\n    tmp$1.selected = Caml_option.valFromOption(state.unlockOn);\n  }\n  var tmp$2;\n  if (level !== undefined) {\n    var level$1 = level;\n    tmp$2 = React.createElement(\"button\", {\n          className: \"w-full btn btn-large btn-primary\",\n          disabled: saveDisabled(state),\n          onClick: (function (_event) {\n              return updateLevel(level$1, updateLevelsCB, state, send);\n            })\n        }, \"Update Level\");\n  } else {\n    tmp$2 = React.createElement(\"button\", {\n          className: \"w-full btn btn-large btn-primary\",\n          disabled: saveDisabled(state),\n          onClick: (function (_event) {\n              return createLevel(course, updateLevelsCB, state, send);\n            })\n        }, \"Create New Level\");\n  }\n  return React.createElement(\"div\", tmp, React.createElement(\"div\", {\n                  className: \"mt-5\"\n                }, React.createElement(\"label\", {\n                      className: \"inline-block tracking-wide text-xs font-semibold\",\n                      htmlFor: \"name\"\n                    }, \"Level Name\"), React.createElement(\"input\", {\n                      className: \"appearance-none block w-full bg-white border border-gray-400 rounded py-3 px-4 mt-2 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\",\n                      id: \"name\",\n                      placeholder: \"Type level name here\",\n                      type: \"text\",\n                      value: state.name,\n                      onChange: (function ($$event) {\n                          return updateName(send, $$event.target.value);\n                        })\n                    }), state.hasNameError ? React.createElement(\"div\", {\n                        className: \"drawer-right-form__error-msg\"\n                      }, \"not a valid name\") : null), React.createElement(\"div\", {\n                  className: \"mt-5\"\n                }, React.createElement(\"label\", {\n                      className: \"tracking-wide text-xs font-semibold\",\n                      htmlFor: \"unlock-on-input\"\n                    }, \"Unlock level on\"), React.createElement(\"span\", {\n                      className: \"text-xs\"\n                    }, \" (optional)\"), React.createElement(DatePicker.make, tmp$1)), React.createElement(\"div\", {\n                  className: \"flex mt-5\"\n                }, tmp$2));\n}\n\nfunction handleSelectLevelForDeletion(send, $$event) {\n  var target = $$event.target;\n  return Curry._1(send, /* SelectLevelToMergeInto */Block.__(3, [target.value]));\n}\n\nvar ppx_printed_query = \"mutation MergeLevelsQuery($deleteLevelId: ID!, $mergeIntoLevelId: ID!)  {\\nmergeLevels(deleteLevelId: $deleteLevelId, mergeIntoLevelId: $mergeIntoLevelId)  {\\nsuccess  \\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"mergeLevels\");\n  var tmp;\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"success\");\n    var tmp$1;\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeBoolean(value$3);\n      tmp$1 = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$3));\n    } else {\n      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field success on type MergeLevelsPayload is missing\");\n    }\n    tmp = {\n      success: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field mergeLevels on type Mutation is missing\");\n  }\n  return {\n          mergeLevels: tmp\n        };\n}\n\nfunction make(deleteLevelId, mergeIntoLevelId, param) {\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"deleteLevelId\",\n                    deleteLevelId\n                  ],\n                  /* tuple */[\n                    \"mergeIntoLevelId\",\n                    mergeIntoLevelId\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeWithVariables(variables) {\n  var deleteLevelId = variables.deleteLevelId;\n  var mergeIntoLevelId = variables.mergeIntoLevelId;\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"deleteLevelId\",\n                    deleteLevelId\n                  ],\n                  /* tuple */[\n                    \"mergeIntoLevelId\",\n                    mergeIntoLevelId\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeVariables(deleteLevelId, mergeIntoLevelId, param) {\n  return Js_dict.fromArray([\n                /* tuple */[\n                  \"deleteLevelId\",\n                  deleteLevelId\n                ],\n                /* tuple */[\n                  \"mergeIntoLevelId\",\n                  mergeIntoLevelId\n                ]\n              ].filter((function (param) {\n                    return !Js_json.test(param[1], /* Null */5);\n                  })));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, deleteLevelId, mergeIntoLevelId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n                    /* tuple */[\n                      \"deleteLevelId\",\n                      deleteLevelId\n                    ],\n                    /* tuple */[\n                      \"mergeIntoLevelId\",\n                      mergeIntoLevelId\n                    ]\n                  ].filter((function (param) {\n                        return !Js_json.test(param[1], /* Null */5);\n                      }))));\n}\n\nvar definition = /* tuple */[\n  parse,\n  ppx_printed_query,\n  definition_002\n];\n\nfunction ret_type(f) {\n  return { };\n}\n\nvar MT_Ret = { };\n\nvar MergeLevelsQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction deleteSelectedLevel(state, send, level, _event) {\n  return WindowUtils.confirm(undefined, \"Are you sure? This action cannot be undone.\", (function (param) {\n                Curry._1(send, /* BeginSaving */0);\n                (function (eta) {\n                          return GraphqlQuery.sendQuery(undefined, eta);\n                        })(make(CurriculumEditor__Level.id(level), state.mergeIntoLevelId, /* () */0)).then((function (result) {\n                          if (result.mergeLevels.success) {\n                            DomUtils.reload(/* () */0);\n                          } else {\n                            Curry._1(send, /* FailSaving */1);\n                          }\n                          return Promise.resolve(/* () */0);\n                        })).catch((function (error) {\n                        console.log(error);\n                        $$Notification.error(\"Oops!\", \"Something went wrong when we tried to merge & delete this level. Please reload this page before trying again.\");\n                        return Promise.resolve(/* () */0);\n                      }));\n                return /* () */0;\n              }));\n}\n\nfunction actionsForm(level, levels, state, send) {\n  var match = state.tab;\n  var visibiltyClass = match ? undefined : \"hidden\";\n  var otherLevels = levels.filter((function (l) {\n          if (CurriculumEditor__Level.id(level) !== CurriculumEditor__Level.id(l)) {\n            return CurriculumEditor__Level.number(l) !== 0;\n          } else {\n            return false;\n          }\n        }));\n  var tmp = { };\n  if (visibiltyClass !== undefined) {\n    tmp.className = Caml_option.valFromOption(visibiltyClass);\n  }\n  return React.createElement(\"div\", tmp, React.createElement(\"div\", {\n                  className: \"mt-5\"\n                }, React.createElement(\"label\", {\n                      className: \"inline-block tracking-wide text-xs font-semibold\",\n                      htmlFor: \"delete-and-merge-level\"\n                    }, \"Delete & Merge Into\"), React.createElement(HelpIcon.make, {\n                      className: \"ml-1 text-sm\",\n                      children: \"Pick another level to merge this level into. This action will shift all targets and students in level.\"\n                    }), React.createElement(\"select\", {\n                      className: \"cursor-pointer appearance-none block w-full bg-white border border-gray-400 rounded py-3 px-4 mt-2 leading-tight focus:outline-none focus:bg-white focus:border-gray-500\",\n                      id: \"delete-and-merge-level\",\n                      value: state.mergeIntoLevelId,\n                      onChange: (function (param) {\n                          return handleSelectLevelForDeletion(send, param);\n                        })\n                    }, React.createElement(\"option\", {\n                          key: \"0\",\n                          value: \"0\"\n                        }, \"Select a different level\"), $$Array.map((function (level) {\n                            return React.createElement(\"option\", {\n                                        key: CurriculumEditor__Level.id(level),\n                                        value: CurriculumEditor__Level.id(level)\n                                      }, \"L\" + (String(CurriculumEditor__Level.number(level)) + (\": \" + CurriculumEditor__Level.name(level))));\n                          }), otherLevels)), React.createElement(\"button\", {\n                      className: \"btn btn-primary mt-2\",\n                      disabled: state.mergeIntoLevelId === \"0\",\n                      onClick: (function (param) {\n                          return deleteSelectedLevel(state, send, level, param);\n                        })\n                    }, \"Merge and Delete\")));\n}\n\nfunction tab(tab$1, state, send) {\n  var defaultClasses = \"level-editor__tab cursor-pointer\";\n  var match = tab$1 ? /* tuple */[\n      \"Actions\",\n      \"fa-cogs\"\n    ] : /* tuple */[\n      \"Details\",\n      \"fa-list-alt\"\n    ];\n  var selected = tab$1 === state.tab;\n  var classes = selected ? \"level-editor__tab cursor-pointer level-editor__tab--selected\" : defaultClasses;\n  return React.createElement(\"button\", {\n              className: classes,\n              onClick: (function (_e) {\n                  return Curry._1(send, /* UpdateTab */Block.__(2, [tab$1]));\n                })\n            }, React.createElement(\"i\", {\n                  className: \"fas \" + match[1]\n                }), React.createElement(\"span\", {\n                  className: \"ml-2\"\n                }, match[0]));\n}\n\nfunction CurriculumEditor__LevelEditor(Props) {\n  var level = Props.level;\n  var levels = Props.levels;\n  var course = Props.course;\n  var hideEditorActionCB = Props.hideEditorActionCB;\n  var updateLevelsCB = Props.updateLevelsCB;\n  var match = React.useReducer(reducer, level, computeInitialState);\n  var send = match[1];\n  var state = match[0];\n  return React.createElement(SchoolAdmin__EditorDrawer.make, {\n              closeDrawerCB: hideEditorActionCB,\n              children: React.createElement(DisablingCover.make, {\n                    disabled: state.saving,\n                    children: null\n                  }, React.createElement(\"div\", {\n                        className: \"bg-gray-200 pt-6\"\n                      }, React.createElement(\"div\", {\n                            className: \"max-w-2xl px-6 mx-auto\"\n                          }, React.createElement(\"h3\", undefined, drawerTitle(level))), level !== undefined ? React.createElement(\"div\", {\n                              className: \"flex w-full max-w-2xl mx-auto px-6 text-sm -mb-px mt-2\"\n                            }, tab(/* Details */0, state, send), tab(/* Actions */1, state, send)) : React.createElement(\"div\", {\n                              className: \"h-4\"\n                            })), React.createElement(\"div\", {\n                        className: \"bg-white\"\n                      }, React.createElement(\"div\", {\n                            className: \"border-t border-gray-400\"\n                          }, React.createElement(\"div\", {\n                                className: \"max-w-2xl mx-auto px-6\"\n                              }, detailsForm(level, course, updateLevelsCB, state, send), level !== undefined ? actionsForm(level, levels, state, send) : null))))\n            });\n}\n\nvar make$1 = CurriculumEditor__LevelEditor;\n\nexports.str = str;\nexports.reducer = reducer;\nexports.updateName = updateName;\nexports.saveDisabled = saveDisabled;\nexports.setPayload = setPayload;\nexports.formClasses = formClasses;\nexports.computeInitialState = computeInitialState;\nexports.drawerTitle = drawerTitle;\nexports.handleResponseCB = handleResponseCB;\nexports.createLevel = createLevel;\nexports.updateLevel = updateLevel;\nexports.detailsForm = detailsForm;\nexports.handleSelectLevelForDeletion = handleSelectLevelForDeletion;\nexports.MergeLevelsQuery = MergeLevelsQuery;\nexports.deleteSelectedLevel = deleteSelectedLevel;\nexports.actionsForm = actionsForm;\nexports.tab = tab;\nexports.make = make$1;\n/*  Not a pure module */\n"]},"metadata":{},"sourceType":"module"}