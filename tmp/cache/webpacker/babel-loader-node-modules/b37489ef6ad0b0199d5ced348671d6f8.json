{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../../../shared/Api.bs.js\");\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\n\nvar Block = require(\"bs-platform/lib/js/block.js\");\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar Avatar = require(\"../../../shared/Avatar.bs.js\");\n\nvar $$String = require(\"bs-platform/lib/js/string.js\");\n\nvar ArrayUtils = require(\"../../../shared/utils/ArrayUtils.bs.js\");\n\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\n\nvar $$Notification = require(\"../../../shared/Notification.bs.js\");\n\nvar Belt_SortArray = require(\"bs-platform/lib/js/belt_SortArray.js\");\n\nvar DisablingCover = require(\"../../../shared/components/DisablingCover.bs.js\");\n\nvar CourseCoaches__InfoForm = require(\"./course_coaches/CourseCoaches__InfoForm.bs.js\");\n\nvar SchoolAdmin__EditorDrawer = require(\"../../components/SchoolAdmin__EditorDrawer.bs.js\");\n\nvar CourseCoaches__CourseCoach = require(\"../types/course_coaches/CourseCoaches__CourseCoach.bs.js\");\n\nvar CourseCoaches__EnrollmentForm = require(\"./course_coaches/CourseCoaches__EnrollmentForm.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    return {\n      courseCoaches: state.courseCoaches,\n      formVisible: state.formVisible,\n      saving: !state.saving\n    };\n  } else {\n    switch (action.tag | 0) {\n      case\n      /* UpdateFormVisible */\n      0:\n        return {\n          courseCoaches: state.courseCoaches,\n          formVisible: action[0],\n          saving: state.saving\n        };\n\n      case\n      /* AddCourseCoaches */\n      1:\n        return {\n          courseCoaches: $$Array.append(action[0], state.courseCoaches),\n          formVisible: state.formVisible,\n          saving: state.saving\n        };\n\n      case\n      /* RemoveCoach */\n      2:\n        var coachId = action[0];\n        return {\n          courseCoaches: state.courseCoaches.filter(function (courseCoach) {\n            return CourseCoaches__CourseCoach.id(courseCoach) !== coachId;\n          }),\n          formVisible: state.formVisible,\n          saving: state.saving\n        };\n    }\n  }\n}\n\nfunction handleErrorCB(send, param) {\n  Curry._1(send,\n  /* UpdateSaving */\n  0);\n\n  return $$Notification.error(\"Coach enrollment could not be deleted\", \"Please try again\");\n}\n\nfunction handleResponseCB(send, json) {\n  Curry._1(send,\n  /* UpdateSaving */\n  0);\n\n  var coachId = Json_decode.field(\"coach_id\", Json_decode.string, json);\n\n  Curry._1(send,\n  /* RemoveCoach */\n  Block.__(2, [coachId]));\n\n  return $$Notification.success(\"Success\", \"Coach enrollment deleted successfully\");\n}\n\nfunction removeCoach(send, courseId, authenticityToken, coach, $$event) {\n  $$event.preventDefault();\n\n  if (window.confirm(\"Are you sure you want to remove \" + (CourseCoaches__CourseCoach.name(coach) + \" from this course?\"))) {\n    Curry._1(send,\n    /* UpdateSaving */\n    0);\n\n    var url = \"/school/courses/\" + (courseId + \"/delete_coach_enrollment\");\n    var payload = {};\n    payload[\"authenticity_token\"] = authenticityToken;\n    payload[\"coach_id\"] = CourseCoaches__CourseCoach.id(coach);\n    return Api.create(url, payload, function (param) {\n      return handleResponseCB(send, param);\n    }, function (param) {\n      return handleErrorCB(send, param);\n    });\n  } else {\n    return (\n      /* () */\n      0\n    );\n  }\n}\n\nfunction CourseCoaches__Root(Props) {\n  var courseCoaches = Props.courseCoaches;\n  var schoolCoaches = Props.schoolCoaches;\n  var courseId = Props.courseId;\n  var authenticityToken = Props.authenticityToken;\n  var match = React.useReducer(reducer, {\n    courseCoaches: courseCoaches,\n    formVisible:\n    /* None */\n    0,\n    saving: false\n  });\n  var send = match[1];\n  var state = match[0];\n\n  var updateCoachesCB = function updateCoachesCB(courseCoaches) {\n    Curry._1(send,\n    /* AddCourseCoaches */\n    Block.__(1, [courseCoaches]));\n\n    return Curry._1(send,\n    /* UpdateFormVisible */\n    Block.__(0, [\n    /* None */\n    0]));\n  };\n\n  var match$1 = state.formVisible;\n  return React.createElement(DisablingCover.make, {\n    disabled: state.saving,\n    containerClasses: \"w-full\",\n    children: React.createElement(\"div\", {\n      key: \"School admin coaches course index\",\n      className: \"flex flex-1 h-full overflow-y-scroll bg-gray-100\"\n    }, typeof match$1 === \"number\" ? match$1 !== 0 ? React.createElement(SchoolAdmin__EditorDrawer.make, {\n      closeDrawerCB: function closeDrawerCB(param) {\n        return Curry._1(send,\n        /* UpdateFormVisible */\n        Block.__(0, [\n        /* None */\n        0]));\n      },\n      children: React.createElement(CourseCoaches__EnrollmentForm.make, {\n        schoolCoaches: schoolCoaches,\n        courseCoaches: state.courseCoaches,\n        courseId: courseId,\n        updateCoachesCB: updateCoachesCB\n      })\n    }) : null : React.createElement(SchoolAdmin__EditorDrawer.make, {\n      closeDrawerCB: function closeDrawerCB(param) {\n        return Curry._1(send,\n        /* UpdateFormVisible */\n        Block.__(0, [\n        /* None */\n        0]));\n      },\n      children: React.createElement(CourseCoaches__InfoForm.make, {\n        courseId: courseId,\n        coach: match$1[0]\n      })\n    }), React.createElement(\"div\", {\n      className: \"flex-1 flex flex-col\"\n    }, schoolCoaches.length === state.courseCoaches.length || ArrayUtils.isEmpty(schoolCoaches) ? null : React.createElement(\"div\", {\n      className: \"flex px-6 py-2 items-center justify-between\"\n    }, React.createElement(\"button\", {\n      className: \"max-w-2xl w-full flex mx-auto items-center justify-center relative bg-white text-primary-500 hove:bg-gray-100 hover:text-primary-600 hover:shadow-lg focus:outline-none border-2 border-gray-400 border-dashed hover:border-primary-300 p-6 rounded-lg mt-8 cursor-pointer\",\n      onClick: function onClick(_event) {\n        _event.preventDefault();\n\n        return Curry._1(send,\n        /* UpdateFormVisible */\n        Block.__(0, [\n        /* CoachEnrollmentForm */\n        1]));\n      }\n    }, React.createElement(\"i\", {\n      className: \"fas fa-user-plus text-lg\"\n    }), React.createElement(\"h5\", {\n      className: \"font-semibold ml-2\"\n    }, \"Assign Coaches to Course\"))), ArrayUtils.isEmpty(state.courseCoaches) ? React.createElement(\"div\", {\n      className: \"flex justify-center bg-gray-100 border rounded p-3 italic mx-auto max-w-2xl w-full mt-8\"\n    }, \"The course has no coaches assigned!\") : null, React.createElement(\"div\", {\n      className: \"px-6 pb-4 mt-5 flex flex-1\"\n    }, React.createElement(\"div\", {\n      className: \"max-w-2xl w-full mx-auto relative\"\n    }, React.createElement(\"div\", {\n      \"aria-label\": \"List of course coaches\",\n      className: \"flex mt-4 -mx-3 flex-wrap\"\n    }, $$Array.map(function (coach) {\n      var match = CourseCoaches__CourseCoach.avatarUrl(coach);\n      return React.createElement(\"div\", {\n        key: CourseCoaches__CourseCoach.id(coach),\n        className: \"flex w-1/2 flex-shrink-0 mb-5 px-3\"\n      }, React.createElement(\"div\", {\n        className: \"shadow bg-whzite cursor-pointer rounded-lg flex w-full border border-transparent overflow-hidden hover:border-primary-400 hover:bg-gray-100\",\n        id: CourseCoaches__CourseCoach.name(coach)\n      }, React.createElement(\"div\", {\n        className: \"flex flex-1 justify-between\"\n      }, React.createElement(\"div\", {\n        \"aria-label\": \"coach-card-\" + CourseCoaches__CourseCoach.id(coach),\n        className: \"flex flex-1 py-4 px-4 items-center\",\n        onClick: function onClick(param) {\n          return Curry._1(send,\n          /* UpdateFormVisible */\n          Block.__(0, [\n          /* CoachInfoForm */\n          [coach]]));\n        }\n      }, React.createElement(\"span\", {\n        className: \"mr-4 flex-shrink-0\"\n      }, match !== undefined ? React.createElement(\"img\", {\n        className: \"w-10 h-10 rounded-full object-cover\",\n        src: match\n      }) : React.createElement(Avatar.make, {\n        name: CourseCoaches__CourseCoach.name(coach),\n        className: \"w-10 h-10 rounded-full\"\n      })), React.createElement(\"div\", {\n        className: \"text-sm\"\n      }, React.createElement(\"p\", {\n        className: \"text-black font-semibold mt-1\"\n      }, CourseCoaches__CourseCoach.name(coach)), React.createElement(\"p\", {\n        className: \"text-gray-600 font-semibold text-xs mt-px\"\n      }, CourseCoaches__CourseCoach.title(coach)))), React.createElement(\"div\", {\n        \"aria-label\": \"Delete \" + CourseCoaches__CourseCoach.name(coach),\n        className: \"w-10 text-sm course-faculty__list-item-remove text-gray-700 hover:text-gray-900 cursor-pointer flex items-center justify-center hover:bg-gray-200\",\n        onClick: function onClick(param) {\n          return removeCoach(send, courseId, authenticityToken, coach, param);\n        }\n      }, React.createElement(\"i\", {\n        className: \"fas fa-trash-alt\"\n      })))));\n    }, Belt_SortArray.stableSortBy(state.courseCoaches, function (a, b) {\n      return $$String.compare(CourseCoaches__CourseCoach.name(a), CourseCoaches__CourseCoach.name(b));\n    })))))))\n  });\n}\n\nvar make = CourseCoaches__Root;\nexports.str = str;\nexports.reducer = reducer;\nexports.handleErrorCB = handleErrorCB;\nexports.handleResponseCB = handleResponseCB;\nexports.removeCoach = removeCoach;\nexports.make = make;\n/* Api Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/schools/courses/components/CourseCoaches__Root.bs.js"],"names":["Api","require","$$Array","Block","Curry","React","Avatar","$$String","ArrayUtils","Json_decode","$$Notification","Belt_SortArray","DisablingCover","CourseCoaches__InfoForm","SchoolAdmin__EditorDrawer","CourseCoaches__CourseCoach","CourseCoaches__EnrollmentForm","str","prim","reducer","state","action","courseCoaches","formVisible","saving","tag","append","coachId","filter","courseCoach","id","handleErrorCB","send","param","_1","error","handleResponseCB","json","field","string","__","success","removeCoach","courseId","authenticityToken","coach","$$event","preventDefault","window","confirm","name","url","payload","create","CourseCoaches__Root","Props","schoolCoaches","match","useReducer","updateCoachesCB","match$1","createElement","make","disabled","containerClasses","children","key","className","closeDrawerCB","length","isEmpty","onClick","_event","map","avatarUrl","undefined","src","title","stableSortBy","a","b","compare","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../../../shared/Api.bs.js\");\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\nvar Block = require(\"bs-platform/lib/js/block.js\");\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar Avatar = require(\"../../../shared/Avatar.bs.js\");\nvar $$String = require(\"bs-platform/lib/js/string.js\");\nvar ArrayUtils = require(\"../../../shared/utils/ArrayUtils.bs.js\");\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\nvar $$Notification = require(\"../../../shared/Notification.bs.js\");\nvar Belt_SortArray = require(\"bs-platform/lib/js/belt_SortArray.js\");\nvar DisablingCover = require(\"../../../shared/components/DisablingCover.bs.js\");\nvar CourseCoaches__InfoForm = require(\"./course_coaches/CourseCoaches__InfoForm.bs.js\");\nvar SchoolAdmin__EditorDrawer = require(\"../../components/SchoolAdmin__EditorDrawer.bs.js\");\nvar CourseCoaches__CourseCoach = require(\"../types/course_coaches/CourseCoaches__CourseCoach.bs.js\");\nvar CourseCoaches__EnrollmentForm = require(\"./course_coaches/CourseCoaches__EnrollmentForm.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    return {\n            courseCoaches: state.courseCoaches,\n            formVisible: state.formVisible,\n            saving: !state.saving\n          };\n  } else {\n    switch (action.tag | 0) {\n      case /* UpdateFormVisible */0 :\n          return {\n                  courseCoaches: state.courseCoaches,\n                  formVisible: action[0],\n                  saving: state.saving\n                };\n      case /* AddCourseCoaches */1 :\n          return {\n                  courseCoaches: $$Array.append(action[0], state.courseCoaches),\n                  formVisible: state.formVisible,\n                  saving: state.saving\n                };\n      case /* RemoveCoach */2 :\n          var coachId = action[0];\n          return {\n                  courseCoaches: state.courseCoaches.filter((function (courseCoach) {\n                          return CourseCoaches__CourseCoach.id(courseCoach) !== coachId;\n                        })),\n                  formVisible: state.formVisible,\n                  saving: state.saving\n                };\n      \n    }\n  }\n}\n\nfunction handleErrorCB(send, param) {\n  Curry._1(send, /* UpdateSaving */0);\n  return $$Notification.error(\"Coach enrollment could not be deleted\", \"Please try again\");\n}\n\nfunction handleResponseCB(send, json) {\n  Curry._1(send, /* UpdateSaving */0);\n  var coachId = Json_decode.field(\"coach_id\", Json_decode.string, json);\n  Curry._1(send, /* RemoveCoach */Block.__(2, [coachId]));\n  return $$Notification.success(\"Success\", \"Coach enrollment deleted successfully\");\n}\n\nfunction removeCoach(send, courseId, authenticityToken, coach, $$event) {\n  $$event.preventDefault();\n  if (window.confirm(\"Are you sure you want to remove \" + (CourseCoaches__CourseCoach.name(coach) + \" from this course?\"))) {\n    Curry._1(send, /* UpdateSaving */0);\n    var url = \"/school/courses/\" + (courseId + \"/delete_coach_enrollment\");\n    var payload = { };\n    payload[\"authenticity_token\"] = authenticityToken;\n    payload[\"coach_id\"] = CourseCoaches__CourseCoach.id(coach);\n    return Api.create(url, payload, (function (param) {\n                  return handleResponseCB(send, param);\n                }), (function (param) {\n                  return handleErrorCB(send, param);\n                }));\n  } else {\n    return /* () */0;\n  }\n}\n\nfunction CourseCoaches__Root(Props) {\n  var courseCoaches = Props.courseCoaches;\n  var schoolCoaches = Props.schoolCoaches;\n  var courseId = Props.courseId;\n  var authenticityToken = Props.authenticityToken;\n  var match = React.useReducer(reducer, {\n        courseCoaches: courseCoaches,\n        formVisible: /* None */0,\n        saving: false\n      });\n  var send = match[1];\n  var state = match[0];\n  var updateCoachesCB = function (courseCoaches) {\n    Curry._1(send, /* AddCourseCoaches */Block.__(1, [courseCoaches]));\n    return Curry._1(send, /* UpdateFormVisible */Block.__(0, [/* None */0]));\n  };\n  var match$1 = state.formVisible;\n  return React.createElement(DisablingCover.make, {\n              disabled: state.saving,\n              containerClasses: \"w-full\",\n              children: React.createElement(\"div\", {\n                    key: \"School admin coaches course index\",\n                    className: \"flex flex-1 h-full overflow-y-scroll bg-gray-100\"\n                  }, typeof match$1 === \"number\" ? (\n                      match$1 !== 0 ? React.createElement(SchoolAdmin__EditorDrawer.make, {\n                              closeDrawerCB: (function (param) {\n                                  return Curry._1(send, /* UpdateFormVisible */Block.__(0, [/* None */0]));\n                                }),\n                              children: React.createElement(CourseCoaches__EnrollmentForm.make, {\n                                    schoolCoaches: schoolCoaches,\n                                    courseCoaches: state.courseCoaches,\n                                    courseId: courseId,\n                                    updateCoachesCB: updateCoachesCB\n                                  })\n                            }) : null\n                    ) : React.createElement(SchoolAdmin__EditorDrawer.make, {\n                          closeDrawerCB: (function (param) {\n                              return Curry._1(send, /* UpdateFormVisible */Block.__(0, [/* None */0]));\n                            }),\n                          children: React.createElement(CourseCoaches__InfoForm.make, {\n                                courseId: courseId,\n                                coach: match$1[0]\n                              })\n                        }), React.createElement(\"div\", {\n                        className: \"flex-1 flex flex-col\"\n                      }, schoolCoaches.length === state.courseCoaches.length || ArrayUtils.isEmpty(schoolCoaches) ? null : React.createElement(\"div\", {\n                              className: \"flex px-6 py-2 items-center justify-between\"\n                            }, React.createElement(\"button\", {\n                                  className: \"max-w-2xl w-full flex mx-auto items-center justify-center relative bg-white text-primary-500 hove:bg-gray-100 hover:text-primary-600 hover:shadow-lg focus:outline-none border-2 border-gray-400 border-dashed hover:border-primary-300 p-6 rounded-lg mt-8 cursor-pointer\",\n                                  onClick: (function (_event) {\n                                      _event.preventDefault();\n                                      return Curry._1(send, /* UpdateFormVisible */Block.__(0, [/* CoachEnrollmentForm */1]));\n                                    })\n                                }, React.createElement(\"i\", {\n                                      className: \"fas fa-user-plus text-lg\"\n                                    }), React.createElement(\"h5\", {\n                                      className: \"font-semibold ml-2\"\n                                    }, \"Assign Coaches to Course\"))), ArrayUtils.isEmpty(state.courseCoaches) ? React.createElement(\"div\", {\n                              className: \"flex justify-center bg-gray-100 border rounded p-3 italic mx-auto max-w-2xl w-full mt-8\"\n                            }, \"The course has no coaches assigned!\") : null, React.createElement(\"div\", {\n                            className: \"px-6 pb-4 mt-5 flex flex-1\"\n                          }, React.createElement(\"div\", {\n                                className: \"max-w-2xl w-full mx-auto relative\"\n                              }, React.createElement(\"div\", {\n                                    \"aria-label\": \"List of course coaches\",\n                                    className: \"flex mt-4 -mx-3 flex-wrap\"\n                                  }, $$Array.map((function (coach) {\n                                          var match = CourseCoaches__CourseCoach.avatarUrl(coach);\n                                          return React.createElement(\"div\", {\n                                                      key: CourseCoaches__CourseCoach.id(coach),\n                                                      className: \"flex w-1/2 flex-shrink-0 mb-5 px-3\"\n                                                    }, React.createElement(\"div\", {\n                                                          className: \"shadow bg-whzite cursor-pointer rounded-lg flex w-full border border-transparent overflow-hidden hover:border-primary-400 hover:bg-gray-100\",\n                                                          id: CourseCoaches__CourseCoach.name(coach)\n                                                        }, React.createElement(\"div\", {\n                                                              className: \"flex flex-1 justify-between\"\n                                                            }, React.createElement(\"div\", {\n                                                                  \"aria-label\": \"coach-card-\" + CourseCoaches__CourseCoach.id(coach),\n                                                                  className: \"flex flex-1 py-4 px-4 items-center\",\n                                                                  onClick: (function (param) {\n                                                                      return Curry._1(send, /* UpdateFormVisible */Block.__(0, [/* CoachInfoForm */[coach]]));\n                                                                    })\n                                                                }, React.createElement(\"span\", {\n                                                                      className: \"mr-4 flex-shrink-0\"\n                                                                    }, match !== undefined ? React.createElement(\"img\", {\n                                                                            className: \"w-10 h-10 rounded-full object-cover\",\n                                                                            src: match\n                                                                          }) : React.createElement(Avatar.make, {\n                                                                            name: CourseCoaches__CourseCoach.name(coach),\n                                                                            className: \"w-10 h-10 rounded-full\"\n                                                                          })), React.createElement(\"div\", {\n                                                                      className: \"text-sm\"\n                                                                    }, React.createElement(\"p\", {\n                                                                          className: \"text-black font-semibold mt-1\"\n                                                                        }, CourseCoaches__CourseCoach.name(coach)), React.createElement(\"p\", {\n                                                                          className: \"text-gray-600 font-semibold text-xs mt-px\"\n                                                                        }, CourseCoaches__CourseCoach.title(coach)))), React.createElement(\"div\", {\n                                                                  \"aria-label\": \"Delete \" + CourseCoaches__CourseCoach.name(coach),\n                                                                  className: \"w-10 text-sm course-faculty__list-item-remove text-gray-700 hover:text-gray-900 cursor-pointer flex items-center justify-center hover:bg-gray-200\",\n                                                                  onClick: (function (param) {\n                                                                      return removeCoach(send, courseId, authenticityToken, coach, param);\n                                                                    })\n                                                                }, React.createElement(\"i\", {\n                                                                      className: \"fas fa-trash-alt\"\n                                                                    })))));\n                                        }), Belt_SortArray.stableSortBy(state.courseCoaches, (function (a, b) {\n                                              return $$String.compare(CourseCoaches__CourseCoach.name(a), CourseCoaches__CourseCoach.name(b));\n                                            }))))))))\n            });\n}\n\nvar make = CourseCoaches__Root;\n\nexports.str = str;\nexports.reducer = reducer;\nexports.handleErrorCB = handleErrorCB;\nexports.handleResponseCB = handleResponseCB;\nexports.removeCoach = removeCoach;\nexports.make = make;\n/* Api Not a pure module */\n"]},"metadata":{},"sourceType":"module"}