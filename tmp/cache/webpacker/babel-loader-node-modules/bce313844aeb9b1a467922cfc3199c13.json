{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar FaIcon = require(\"../../../shared/components/FaIcon.bs.js\");\n\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\n\nvar DateFns = require(\"../../../shared/utils/DateFns.bs.js\");\n\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\n\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\n\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar GraphqlQuery = require(\"../../../shared/utils/GraphqlQuery.bs.js\");\n\nvar CoursesCurriculum__Target = require(\"../types/CoursesCurriculum__Target.bs.js\");\n\nvar CoursesCurriculum__Submission = require(\"../types/CoursesCurriculum__Submission.bs.js\");\n\nvar CoursesCurriculum__TargetStatus = require(\"../types/CoursesCurriculum__TargetStatus.bs.js\");\n\nvar CoursesCurriculum__TargetDetails = require(\"../types/CoursesCurriculum__TargetDetails.bs.js\");\n\nvar CoursesCurriculum__CompletionInstructions = require(\"./CoursesCurriculum__CompletionInstructions.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nvar ppx_printed_query = \"mutation AutoVerifySubmissionMutation($targetId: ID!)  {\\nautoVerifySubmission(targetId: $targetId)  {\\nsubmission  {\\nid  \\ncreatedAt  \\n}\\n\\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"autoVerifySubmission\");\n  var tmp;\n\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"submission\");\n    var tmp$1;\n\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeNull(value$3);\n\n      if (match$2 !== undefined) {\n        tmp$1 = undefined;\n      } else {\n        var value$4 = Js_option.getExn(Js_json.decodeObject(value$3));\n        var match$3 = Js_dict.get(value$4, \"id\");\n        var tmp$2;\n\n        if (match$3 !== undefined) {\n          var value$5 = Caml_option.valFromOption(match$3);\n          var match$4 = Js_json.decodeString(value$5);\n          tmp$2 = match$4 !== undefined ? match$4 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$5));\n        } else {\n          tmp$2 = Js_exn.raiseError(\"graphql_ppx: Field id on type Submission is missing\");\n        }\n\n        var match$5 = Js_dict.get(value$4, \"createdAt\");\n        tmp$1 = {\n          id: tmp$2,\n          createdAt: match$5 !== undefined ? Caml_option.valFromOption(match$5) : Js_exn.raiseError(\"graphql_ppx: Field createdAt on type Submission is missing\")\n        };\n      }\n    } else {\n      tmp$1 = undefined;\n    }\n\n    tmp = {\n      submission: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field autoVerifySubmission on type Mutation is missing\");\n  }\n\n  return {\n    autoVerifySubmission: tmp\n  };\n}\n\nfunction make(targetId, param) {\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"targetId\", targetId]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeWithVariables(variables) {\n  var targetId = variables.targetId;\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"targetId\", targetId]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeVariables(targetId, param) {\n  return Js_dict.fromArray([\n  /* tuple */\n  [\"targetId\", targetId]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  }));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, targetId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n  /* tuple */\n  [\"targetId\", targetId]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  })));\n}\n\nvar definition =\n/* tuple */\n[parse, ppx_printed_query, definition_002];\n\nfunction ret_type(f) {\n  return {};\n}\n\nvar MT_Ret = {};\nvar AutoVerifySubmissionQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction redirect(link) {\n  var $$window$1 = window;\n  $$window$1.open(link, \"_blank\", \"\");\n  return (\n    /* () */\n    0\n  );\n}\n\nfunction handleSuccess(submission, linkToComplete, addSubmissionCB) {\n  Curry._1(addSubmissionCB, CoursesCurriculum__Submission.make(submission.id, DateFns.decodeISO(submission.createdAt),\n  /* MarkedAsComplete */\n  0, []));\n\n  if (linkToComplete !== undefined) {\n    return redirect(linkToComplete);\n  } else {\n    return (\n      /* () */\n      0\n    );\n  }\n}\n\nfunction createAutoVerifySubmission(target, linkToComplete, setSaving, addSubmissionCB, $$event) {\n  $$event.preventDefault();\n\n  Curry._1(setSaving, function (param) {\n    return true;\n  });\n\n  (function (eta) {\n    return GraphqlQuery.sendQuery(undefined, eta);\n  })(make(CoursesCurriculum__Target.id(target),\n  /* () */\n  0)).then(function (response) {\n    var match = response.autoVerifySubmission.submission;\n\n    if (match !== undefined) {\n      handleSuccess(Caml_option.valFromOption(match), linkToComplete, addSubmissionCB);\n    } else {\n      Curry._1(setSaving, function (param) {\n        return false;\n      });\n    }\n\n    return Promise.resolve(\n    /* () */\n    0);\n  });\n  return (\n    /* () */\n    0\n  );\n}\n\nfunction completeButtonText(title, iconClasses) {\n  return React.createElement(\"span\", undefined, React.createElement(FaIcon.make, {\n    classes: iconClasses + \" mr-2\"\n  }), title);\n}\n\nfunction previewLinkToComplete(link) {\n  return React.createElement(\"a\", {\n    className: \"block text-primary-500 w-full text-center bg-gray-200 hover:bg-gray-300 hover:text-primary-600 p-4 rounded text-lg font-bold\",\n    href: link,\n    target: \"_blank\"\n  }, React.createElement(\"span\", undefined, React.createElement(FaIcon.make, {\n    classes: \"fas fa-external-link-alt mr-2\"\n  }), \"Visit Link \"));\n}\n\nfunction autoVerify(target, linkToComplete, saving, setSaving, addSubmissionCB, preview) {\n  if (preview && linkToComplete !== undefined) {\n    return previewLinkToComplete(linkToComplete);\n  }\n\n  return React.createElement(\"button\", {\n    className: \"flex rounded btn-success text-lg justify-center w-full font-bold p-4  \",\n    disabled: saving || preview,\n    onClick: function onClick(param) {\n      return createAutoVerifySubmission(target, linkToComplete, setSaving, addSubmissionCB, param);\n    }\n  }, saving ? completeButtonText(\"Saving\", \"fas fa-spinner fa-spin\") : linkToComplete !== undefined ? completeButtonText(\"Visit Link To Complete\", \"fas fa-external-link-alt\") : completeButtonText(\"Mark As Complete\", \"fas fa-check-square\"));\n}\n\nfunction statusBar(string, linkToComplete) {\n  var message = React.createElement(\"div\", {\n    className: \"flex items-center\"\n  }, React.createElement(\"span\", {\n    className: \"fa-stack text-lg mr-1 text-green-500\"\n  }, React.createElement(\"i\", {\n    className: \"fas fa-certificate fa-stack-2x\"\n  }), React.createElement(\"i\", {\n    className: \"fas fa-check fa-stack-1x fa-inverse\"\n  })), React.createElement(\"span\", undefined, string));\n\n  var visitLink = function visitLink(link) {\n    return React.createElement(\"a\", {\n      className: \"text-right w-full\",\n      href: link,\n      target: \"_blank\"\n    }, React.createElement(\"i\", {\n      className: \"fas fa-external-link-alt mr-2\"\n    }), \"Visit Link\");\n  };\n\n  return React.createElement(\"div\", {\n    className: \"font-bold p-4 flex w-full items-center text-green-500 bg-green-100 justify-center\"\n  }, message, linkToComplete !== undefined ? visitLink(linkToComplete) : null);\n}\n\nfunction completionInstructionText(linkToComplete) {\n  if (linkToComplete !== undefined) {\n    return \"Before visiting the link...\";\n  } else {\n    return \"Before marking as complete...\";\n  }\n}\n\nfunction CoursesCurriculum__AutoVerify(Props) {\n  var target = Props.target;\n  var targetDetails = Props.targetDetails;\n  var targetStatus = Props.targetStatus;\n  var addSubmissionCB = Props.addSubmissionCB;\n  var preview = Props.preview;\n  var match = React.useState(function () {\n    return false;\n  });\n  var linkToComplete = CoursesCurriculum__TargetDetails.linkToComplete(targetDetails);\n  var match$1 = CoursesCurriculum__TargetStatus.status(targetStatus);\n  return [React.createElement(CoursesCurriculum__CompletionInstructions.make, {\n    targetDetails: targetDetails,\n    title: completionInstructionText(linkToComplete),\n    key: \"completion-instructions\"\n  }), React.createElement(\"div\", {\n    key: \"completion-button\",\n    className: \"mt-5\",\n    id: \"auto-verify-target\"\n  }, typeof match$1 === \"number\" ? match$1 !== 0 ? statusBar(\"Completed\", linkToComplete) : autoVerify(target, linkToComplete, match[0], match[1], addSubmissionCB, preview) : null)];\n}\n\nvar TargetStatus =\n/* alias */\n0;\nvar make$1 = CoursesCurriculum__AutoVerify;\nexports.str = str;\nexports.TargetStatus = TargetStatus;\nexports.AutoVerifySubmissionQuery = AutoVerifySubmissionQuery;\nexports.redirect = redirect;\nexports.handleSuccess = handleSuccess;\nexports.createAutoVerifySubmission = createAutoVerifySubmission;\nexports.completeButtonText = completeButtonText;\nexports.previewLinkToComplete = previewLinkToComplete;\nexports.autoVerify = autoVerify;\nexports.statusBar = statusBar;\nexports.completionInstructionText = completionInstructionText;\nexports.make = make$1;\n/* react Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/courses/curricula/components/CoursesCurriculum__AutoVerify.bs.js"],"names":["Curry","require","React","FaIcon","Js_exn","DateFns","Js_dict","Js_json","Js_option","Caml_option","GraphqlQuery","CoursesCurriculum__Target","CoursesCurriculum__Submission","CoursesCurriculum__TargetStatus","CoursesCurriculum__TargetDetails","CoursesCurriculum__CompletionInstructions","str","prim","ppx_printed_query","parse","value","value$1","getExn","decodeObject","match","get","tmp","undefined","value$2","valFromOption","match$1","tmp$1","value$3","match$2","decodeNull","value$4","match$3","tmp$2","value$5","match$4","decodeString","raiseError","JSON","stringify","match$5","id","createdAt","submission","autoVerifySubmission","make","targetId","param","query","variables","fromArray","filter","test","makeWithVariables","makeVariables","definition_002","graphql_ppx_use_json_variables_fn","_1","definition","ret_type","f","MT_Ret","AutoVerifySubmissionQuery","redirect","link","$$window$1","window","open","handleSuccess","linkToComplete","addSubmissionCB","decodeISO","createAutoVerifySubmission","target","setSaving","$$event","preventDefault","eta","sendQuery","then","response","Promise","resolve","completeButtonText","title","iconClasses","createElement","classes","previewLinkToComplete","className","href","autoVerify","saving","preview","disabled","onClick","statusBar","string","message","visitLink","completionInstructionText","CoursesCurriculum__AutoVerify","Props","targetDetails","targetStatus","useState","status","key","TargetStatus","make$1","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar FaIcon = require(\"../../../shared/components/FaIcon.bs.js\");\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\nvar DateFns = require(\"../../../shared/utils/DateFns.bs.js\");\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar GraphqlQuery = require(\"../../../shared/utils/GraphqlQuery.bs.js\");\nvar CoursesCurriculum__Target = require(\"../types/CoursesCurriculum__Target.bs.js\");\nvar CoursesCurriculum__Submission = require(\"../types/CoursesCurriculum__Submission.bs.js\");\nvar CoursesCurriculum__TargetStatus = require(\"../types/CoursesCurriculum__TargetStatus.bs.js\");\nvar CoursesCurriculum__TargetDetails = require(\"../types/CoursesCurriculum__TargetDetails.bs.js\");\nvar CoursesCurriculum__CompletionInstructions = require(\"./CoursesCurriculum__CompletionInstructions.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nvar ppx_printed_query = \"mutation AutoVerifySubmissionMutation($targetId: ID!)  {\\nautoVerifySubmission(targetId: $targetId)  {\\nsubmission  {\\nid  \\ncreatedAt  \\n}\\n\\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"autoVerifySubmission\");\n  var tmp;\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"submission\");\n    var tmp$1;\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeNull(value$3);\n      if (match$2 !== undefined) {\n        tmp$1 = undefined;\n      } else {\n        var value$4 = Js_option.getExn(Js_json.decodeObject(value$3));\n        var match$3 = Js_dict.get(value$4, \"id\");\n        var tmp$2;\n        if (match$3 !== undefined) {\n          var value$5 = Caml_option.valFromOption(match$3);\n          var match$4 = Js_json.decodeString(value$5);\n          tmp$2 = match$4 !== undefined ? match$4 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$5));\n        } else {\n          tmp$2 = Js_exn.raiseError(\"graphql_ppx: Field id on type Submission is missing\");\n        }\n        var match$5 = Js_dict.get(value$4, \"createdAt\");\n        tmp$1 = {\n          id: tmp$2,\n          createdAt: match$5 !== undefined ? Caml_option.valFromOption(match$5) : Js_exn.raiseError(\"graphql_ppx: Field createdAt on type Submission is missing\")\n        };\n      }\n    } else {\n      tmp$1 = undefined;\n    }\n    tmp = {\n      submission: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field autoVerifySubmission on type Mutation is missing\");\n  }\n  return {\n          autoVerifySubmission: tmp\n        };\n}\n\nfunction make(targetId, param) {\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([/* tuple */[\n                    \"targetId\",\n                    targetId\n                  ]].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeWithVariables(variables) {\n  var targetId = variables.targetId;\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([/* tuple */[\n                    \"targetId\",\n                    targetId\n                  ]].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeVariables(targetId, param) {\n  return Js_dict.fromArray([/* tuple */[\n                  \"targetId\",\n                  targetId\n                ]].filter((function (param) {\n                    return !Js_json.test(param[1], /* Null */5);\n                  })));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, targetId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([/* tuple */[\n                      \"targetId\",\n                      targetId\n                    ]].filter((function (param) {\n                        return !Js_json.test(param[1], /* Null */5);\n                      }))));\n}\n\nvar definition = /* tuple */[\n  parse,\n  ppx_printed_query,\n  definition_002\n];\n\nfunction ret_type(f) {\n  return { };\n}\n\nvar MT_Ret = { };\n\nvar AutoVerifySubmissionQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction redirect(link) {\n  var $$window$1 = window;\n  $$window$1.open(link, \"_blank\", \"\");\n  return /* () */0;\n}\n\nfunction handleSuccess(submission, linkToComplete, addSubmissionCB) {\n  Curry._1(addSubmissionCB, CoursesCurriculum__Submission.make(submission.id, DateFns.decodeISO(submission.createdAt), /* MarkedAsComplete */0, []));\n  if (linkToComplete !== undefined) {\n    return redirect(linkToComplete);\n  } else {\n    return /* () */0;\n  }\n}\n\nfunction createAutoVerifySubmission(target, linkToComplete, setSaving, addSubmissionCB, $$event) {\n  $$event.preventDefault();\n  Curry._1(setSaving, (function (param) {\n          return true;\n        }));\n  (function (eta) {\n          return GraphqlQuery.sendQuery(undefined, eta);\n        })(make(CoursesCurriculum__Target.id(target), /* () */0)).then((function (response) {\n          var match = response.autoVerifySubmission.submission;\n          if (match !== undefined) {\n            handleSuccess(Caml_option.valFromOption(match), linkToComplete, addSubmissionCB);\n          } else {\n            Curry._1(setSaving, (function (param) {\n                    return false;\n                  }));\n          }\n          return Promise.resolve(/* () */0);\n        }));\n  return /* () */0;\n}\n\nfunction completeButtonText(title, iconClasses) {\n  return React.createElement(\"span\", undefined, React.createElement(FaIcon.make, {\n                  classes: iconClasses + \" mr-2\"\n                }), title);\n}\n\nfunction previewLinkToComplete(link) {\n  return React.createElement(\"a\", {\n              className: \"block text-primary-500 w-full text-center bg-gray-200 hover:bg-gray-300 hover:text-primary-600 p-4 rounded text-lg font-bold\",\n              href: link,\n              target: \"_blank\"\n            }, React.createElement(\"span\", undefined, React.createElement(FaIcon.make, {\n                      classes: \"fas fa-external-link-alt mr-2\"\n                    }), \"Visit Link \"));\n}\n\nfunction autoVerify(target, linkToComplete, saving, setSaving, addSubmissionCB, preview) {\n  if (preview && linkToComplete !== undefined) {\n    return previewLinkToComplete(linkToComplete);\n  }\n  return React.createElement(\"button\", {\n              className: \"flex rounded btn-success text-lg justify-center w-full font-bold p-4  \",\n              disabled: saving || preview,\n              onClick: (function (param) {\n                  return createAutoVerifySubmission(target, linkToComplete, setSaving, addSubmissionCB, param);\n                })\n            }, saving ? completeButtonText(\"Saving\", \"fas fa-spinner fa-spin\") : (\n                linkToComplete !== undefined ? completeButtonText(\"Visit Link To Complete\", \"fas fa-external-link-alt\") : completeButtonText(\"Mark As Complete\", \"fas fa-check-square\")\n              ));\n}\n\nfunction statusBar(string, linkToComplete) {\n  var message = React.createElement(\"div\", {\n        className: \"flex items-center\"\n      }, React.createElement(\"span\", {\n            className: \"fa-stack text-lg mr-1 text-green-500\"\n          }, React.createElement(\"i\", {\n                className: \"fas fa-certificate fa-stack-2x\"\n              }), React.createElement(\"i\", {\n                className: \"fas fa-check fa-stack-1x fa-inverse\"\n              })), React.createElement(\"span\", undefined, string));\n  var visitLink = function (link) {\n    return React.createElement(\"a\", {\n                className: \"text-right w-full\",\n                href: link,\n                target: \"_blank\"\n              }, React.createElement(\"i\", {\n                    className: \"fas fa-external-link-alt mr-2\"\n                  }), \"Visit Link\");\n  };\n  return React.createElement(\"div\", {\n              className: \"font-bold p-4 flex w-full items-center text-green-500 bg-green-100 justify-center\"\n            }, message, linkToComplete !== undefined ? visitLink(linkToComplete) : null);\n}\n\nfunction completionInstructionText(linkToComplete) {\n  if (linkToComplete !== undefined) {\n    return \"Before visiting the link...\";\n  } else {\n    return \"Before marking as complete...\";\n  }\n}\n\nfunction CoursesCurriculum__AutoVerify(Props) {\n  var target = Props.target;\n  var targetDetails = Props.targetDetails;\n  var targetStatus = Props.targetStatus;\n  var addSubmissionCB = Props.addSubmissionCB;\n  var preview = Props.preview;\n  var match = React.useState((function () {\n          return false;\n        }));\n  var linkToComplete = CoursesCurriculum__TargetDetails.linkToComplete(targetDetails);\n  var match$1 = CoursesCurriculum__TargetStatus.status(targetStatus);\n  return [\n          React.createElement(CoursesCurriculum__CompletionInstructions.make, {\n                targetDetails: targetDetails,\n                title: completionInstructionText(linkToComplete),\n                key: \"completion-instructions\"\n              }),\n          React.createElement(\"div\", {\n                key: \"completion-button\",\n                className: \"mt-5\",\n                id: \"auto-verify-target\"\n              }, typeof match$1 === \"number\" ? (\n                  match$1 !== 0 ? statusBar(\"Completed\", linkToComplete) : autoVerify(target, linkToComplete, match[0], match[1], addSubmissionCB, preview)\n                ) : null)\n        ];\n}\n\nvar TargetStatus = /* alias */0;\n\nvar make$1 = CoursesCurriculum__AutoVerify;\n\nexports.str = str;\nexports.TargetStatus = TargetStatus;\nexports.AutoVerifySubmissionQuery = AutoVerifySubmissionQuery;\nexports.redirect = redirect;\nexports.handleSuccess = handleSuccess;\nexports.createAutoVerifySubmission = createAutoVerifySubmission;\nexports.completeButtonText = completeButtonText;\nexports.previewLinkToComplete = previewLinkToComplete;\nexports.autoVerify = autoVerify;\nexports.statusBar = statusBar;\nexports.completionInstructionText = completionInstructionText;\nexports.make = make$1;\n/* react Not a pure module */\n"]},"metadata":{},"sourceType":"module"}