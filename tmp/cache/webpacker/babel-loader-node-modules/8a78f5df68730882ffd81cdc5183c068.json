{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar Fetch = require(\"bs-fetch/src/Fetch.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\n\nvar $$Notification = require(\"./Notification.bs.js\");\n\nvar Caml_exceptions = require(\"bs-platform/lib/js/caml_exceptions.js\");\n\nvar UnexpectedResponse = Caml_exceptions.create(\"Api.UnexpectedResponse\");\n\nfunction handleApiError(match) {\n  if (Caml_exceptions.caml_is_extension(match) && match[0] === UnexpectedResponse) {\n    return match[1];\n  }\n}\n\nfunction acceptOrRejectResponse(response) {\n  if (response.ok || response.status === 422) {\n    return response.json();\n  } else {\n    return Promise.reject([UnexpectedResponse, response.status]);\n  }\n}\n\nfunction handleResponseError(error) {\n  var message = \"Our team has been notified of this error. Please reload the page and try again.\";\n  var match = handleApiError(error);\n\n  if (match !== undefined) {\n    return $$Notification.error(String(match), message);\n  } else {\n    return $$Notification.error(\"An unexpected error occurred\", message);\n  }\n}\n\nfunction handleResponseJSON(json, responseCB, errorCB) {\n  var error = Json_decode.optional(function (param) {\n    return Json_decode.field(\"error\", Json_decode.string, param);\n  }, json);\n\n  if (error !== undefined) {\n    $$Notification.error(\"Something went wrong!\", error);\n    return Curry._1(errorCB,\n    /* () */\n    0);\n  } else {\n    return Curry._1(responseCB, json);\n  }\n}\n\nfunction handleResponse(responseCB, errorCB, promise) {\n  promise.then(acceptOrRejectResponse).then(function (json) {\n    return Promise.resolve(handleResponseJSON(json, responseCB, errorCB));\n  })[\"catch\"](function (error) {\n    Curry._1(errorCB,\n    /* () */\n    0);\n\n    console.log(error);\n    return Promise.resolve(handleResponseError(handleApiError(error)));\n  });\n  return (\n    /* () */\n    0\n  );\n}\n\nfunction sendPayload(url, payload, responseCB, errorCB, method_) {\n  return handleResponse(responseCB, errorCB, fetch(url, Fetch.RequestInit.make(method_, {\n    \"Content-Type\": \"application/json\"\n  }, Caml_option.some(JSON.stringify(payload)), undefined, undefined, undefined,\n  /* SameOrigin */\n  1, undefined, undefined, undefined, undefined, undefined)(\n  /* () */\n  0)));\n}\n\nfunction sendFormData(url, formData, responseCB, errorCB) {\n  return handleResponse(responseCB, errorCB, fetch(url, Fetch.RequestInit.make(\n  /* Post */\n  2, undefined, Caml_option.some(formData), undefined, undefined, undefined,\n  /* SameOrigin */\n  1, undefined, undefined, undefined, undefined, undefined)(\n  /* () */\n  0)));\n}\n\nfunction create(url, payload, responseCB, errorCB) {\n  return sendPayload(url, payload, responseCB, errorCB,\n  /* Post */\n  2);\n}\n\nfunction update(url, payload, responseCB, errorCB) {\n  return sendPayload(url, payload, responseCB, errorCB,\n  /* Patch */\n  8);\n}\n\nexports.UnexpectedResponse = UnexpectedResponse;\nexports.handleApiError = handleApiError;\nexports.acceptOrRejectResponse = acceptOrRejectResponse;\nexports.handleResponseError = handleResponseError;\nexports.handleResponseJSON = handleResponseJSON;\nexports.handleResponse = handleResponse;\nexports.sendPayload = sendPayload;\nexports.sendFormData = sendFormData;\nexports.create = create;\nexports.update = update;\n/* Notification Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/shared/Api.bs.js"],"names":["Curry","require","Fetch","Caml_option","Json_decode","$$Notification","Caml_exceptions","UnexpectedResponse","create","handleApiError","match","caml_is_extension","acceptOrRejectResponse","response","ok","status","json","Promise","reject","handleResponseError","error","message","undefined","String","handleResponseJSON","responseCB","errorCB","optional","param","field","string","_1","handleResponse","promise","then","resolve","console","log","sendPayload","url","payload","method_","fetch","RequestInit","make","some","JSON","stringify","sendFormData","formData","update","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar Fetch = require(\"bs-fetch/src/Fetch.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\nvar $$Notification = require(\"./Notification.bs.js\");\nvar Caml_exceptions = require(\"bs-platform/lib/js/caml_exceptions.js\");\n\nvar UnexpectedResponse = Caml_exceptions.create(\"Api.UnexpectedResponse\");\n\nfunction handleApiError(match) {\n  if (Caml_exceptions.caml_is_extension(match) && match[0] === UnexpectedResponse) {\n    return match[1];\n  }\n  \n}\n\nfunction acceptOrRejectResponse(response) {\n  if (response.ok || response.status === 422) {\n    return response.json();\n  } else {\n    return Promise.reject([\n                UnexpectedResponse,\n                response.status\n              ]);\n  }\n}\n\nfunction handleResponseError(error) {\n  var message = \"Our team has been notified of this error. Please reload the page and try again.\";\n  var match = handleApiError(error);\n  if (match !== undefined) {\n    return $$Notification.error(String(match), message);\n  } else {\n    return $$Notification.error(\"An unexpected error occurred\", message);\n  }\n}\n\nfunction handleResponseJSON(json, responseCB, errorCB) {\n  var error = Json_decode.optional((function (param) {\n          return Json_decode.field(\"error\", Json_decode.string, param);\n        }), json);\n  if (error !== undefined) {\n    $$Notification.error(\"Something went wrong!\", error);\n    return Curry._1(errorCB, /* () */0);\n  } else {\n    return Curry._1(responseCB, json);\n  }\n}\n\nfunction handleResponse(responseCB, errorCB, promise) {\n  promise.then(acceptOrRejectResponse).then((function (json) {\n            return Promise.resolve(handleResponseJSON(json, responseCB, errorCB));\n          })).catch((function (error) {\n          Curry._1(errorCB, /* () */0);\n          console.log(error);\n          return Promise.resolve(handleResponseError(handleApiError(error)));\n        }));\n  return /* () */0;\n}\n\nfunction sendPayload(url, payload, responseCB, errorCB, method_) {\n  return handleResponse(responseCB, errorCB, fetch(url, Fetch.RequestInit.make(method_, {\n                        \"Content-Type\": \"application/json\"\n                      }, Caml_option.some(JSON.stringify(payload)), undefined, undefined, undefined, /* SameOrigin */1, undefined, undefined, undefined, undefined, undefined)(/* () */0)));\n}\n\nfunction sendFormData(url, formData, responseCB, errorCB) {\n  return handleResponse(responseCB, errorCB, fetch(url, Fetch.RequestInit.make(/* Post */2, undefined, Caml_option.some(formData), undefined, undefined, undefined, /* SameOrigin */1, undefined, undefined, undefined, undefined, undefined)(/* () */0)));\n}\n\nfunction create(url, payload, responseCB, errorCB) {\n  return sendPayload(url, payload, responseCB, errorCB, /* Post */2);\n}\n\nfunction update(url, payload, responseCB, errorCB) {\n  return sendPayload(url, payload, responseCB, errorCB, /* Patch */8);\n}\n\nexports.UnexpectedResponse = UnexpectedResponse;\nexports.handleApiError = handleApiError;\nexports.acceptOrRejectResponse = acceptOrRejectResponse;\nexports.handleResponseError = handleResponseError;\nexports.handleResponseJSON = handleResponseJSON;\nexports.handleResponse = handleResponse;\nexports.sendPayload = sendPayload;\nexports.sendFormData = sendFormData;\nexports.create = create;\nexports.update = update;\n/* Notification Not a pure module */\n"]},"metadata":{},"sourceType":"module"}