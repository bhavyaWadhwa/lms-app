{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../../../../shared/Api.bs.js\");\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\n\nvar Block = require(\"bs-platform/lib/js/block.js\");\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar FaIcon = require(\"../../../../shared/components/FaIcon.bs.js\");\n\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\n\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\n\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\n\nvar HelpIcon = require(\"../../../../shared/components/HelpIcon.bs.js\");\n\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\n\nvar Belt_Array = require(\"bs-platform/lib/js/belt_Array.js\");\n\nvar Caml_array = require(\"bs-platform/lib/js/caml_array.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar OptionUtils = require(\"../../../../shared/utils/OptionUtils.bs.js\");\n\nvar ContentBlock = require(\"../../../../shared/types/ContentBlock.bs.js\");\n\nvar GraphqlQuery = require(\"../../../../shared/utils/GraphqlQuery.bs.js\");\n\nvar $$Notification = require(\"../../../../shared/Notification.bs.js\");\n\nvar DisablingCover = require(\"../../../../shared/components/DisablingCover.bs.js\");\n\nvar Caml_exceptions = require(\"bs-platform/lib/js/caml_exceptions.js\");\n\nvar AuthenticityToken = require(\"../../../../shared/utils/AuthenticityToken.bs.js\");\n\nvar School__InputGroupError = require(\"../../../shared/components/School__InputGroupError.bs.js\");\n\nvar CurriculumEditor__Target = require(\"../../types/curriculum_editor/CurriculumEditor__Target.bs.js\");\n\nvar FormNotFound = Caml_exceptions.create(\"CurriculumEditor__ContentBlockCreator.FormNotFound\");\n\nrequire(\"./CurriculumEditor__ContentBlockCreator.css\");\n\nfunction str(prim) {\n  return prim;\n}\n\nvar ppx_printed_query = \"mutation CreateMarkdownContentBlockMutation($targetId: ID!, $aboveContentBlockId: ID)  {\\ncreateMarkdownContentBlock(targetId: $targetId, aboveContentBlockId: $aboveContentBlockId)  {\\ncontentBlock  {\\n...\" + ContentBlock.Fragments.AllFields.name + \"   \\n}\\n\\n}\\n\\n}\\n\" + ContentBlock.Fragments.AllFields.query;\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"createMarkdownContentBlock\");\n  var tmp;\n\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"contentBlock\");\n    var tmp$1;\n\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeNull(value$3);\n      tmp$1 = match$2 !== undefined ? undefined : Caml_option.some(Curry._1(ContentBlock.Fragments.AllFields.parse, value$3));\n    } else {\n      tmp$1 = undefined;\n    }\n\n    tmp = {\n      contentBlock: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field createMarkdownContentBlock on type Mutation is missing\");\n  }\n\n  return {\n    createMarkdownContentBlock: tmp\n  };\n}\n\nfunction make(targetId, aboveContentBlockId, param) {\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"targetId\", targetId],\n    /* tuple */\n    [\"aboveContentBlockId\", aboveContentBlockId !== undefined ? aboveContentBlockId : null]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeWithVariables(variables) {\n  var targetId = variables.targetId;\n  var aboveContentBlockId = variables.aboveContentBlockId;\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"targetId\", targetId],\n    /* tuple */\n    [\"aboveContentBlockId\", aboveContentBlockId !== undefined ? aboveContentBlockId : null]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeVariables(targetId, aboveContentBlockId, param) {\n  return Js_dict.fromArray([\n  /* tuple */\n  [\"targetId\", targetId],\n  /* tuple */\n  [\"aboveContentBlockId\", aboveContentBlockId !== undefined ? aboveContentBlockId : null]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  }));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, targetId, aboveContentBlockId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n  /* tuple */\n  [\"targetId\", targetId],\n  /* tuple */\n  [\"aboveContentBlockId\", aboveContentBlockId !== undefined ? aboveContentBlockId : null]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  })));\n}\n\nvar definition =\n/* tuple */\n[parse, ppx_printed_query, definition_002];\n\nfunction ret_type(f) {\n  return {};\n}\n\nvar MT_Ret = {};\nvar CreateMarkdownContentBlock = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\nvar ppx_printed_query$1 = \"mutation CreateEmbedContentBlockMutation($targetId: ID!, $aboveContentBlockId: ID, $url: String!)  {\\ncreateEmbedContentBlock(targetId: $targetId, aboveContentBlockId: $aboveContentBlockId, url: $url)  {\\ncontentBlock  {\\n...\" + ContentBlock.Fragments.AllFields.name + \"   \\n}\\n\\n}\\n\\n}\\n\" + ContentBlock.Fragments.AllFields.query;\n\nfunction parse$1(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"createEmbedContentBlock\");\n  var tmp;\n\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"contentBlock\");\n    var tmp$1;\n\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeNull(value$3);\n      tmp$1 = match$2 !== undefined ? undefined : Caml_option.some(Curry._1(ContentBlock.Fragments.AllFields.parse, value$3));\n    } else {\n      tmp$1 = undefined;\n    }\n\n    tmp = {\n      contentBlock: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field createEmbedContentBlock on type Mutation is missing\");\n  }\n\n  return {\n    createEmbedContentBlock: tmp\n  };\n}\n\nfunction make$1(targetId, aboveContentBlockId, url, param) {\n  return {\n    query: ppx_printed_query$1,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"targetId\", targetId],\n    /* tuple */\n    [\"aboveContentBlockId\", aboveContentBlockId !== undefined ? aboveContentBlockId : null],\n    /* tuple */\n    [\"url\", url]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse$1\n  };\n}\n\nfunction makeWithVariables$1(variables) {\n  var targetId = variables.targetId;\n  var aboveContentBlockId = variables.aboveContentBlockId;\n  var url = variables.url;\n  return {\n    query: ppx_printed_query$1,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"targetId\", targetId],\n    /* tuple */\n    [\"aboveContentBlockId\", aboveContentBlockId !== undefined ? aboveContentBlockId : null],\n    /* tuple */\n    [\"url\", url]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse$1\n  };\n}\n\nfunction makeVariables$1(targetId, aboveContentBlockId, url, param) {\n  return Js_dict.fromArray([\n  /* tuple */\n  [\"targetId\", targetId],\n  /* tuple */\n  [\"aboveContentBlockId\", aboveContentBlockId !== undefined ? aboveContentBlockId : null],\n  /* tuple */\n  [\"url\", url]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  }));\n}\n\nfunction definition_002$1(graphql_ppx_use_json_variables_fn, targetId, aboveContentBlockId, url, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n  /* tuple */\n  [\"targetId\", targetId],\n  /* tuple */\n  [\"aboveContentBlockId\", aboveContentBlockId !== undefined ? aboveContentBlockId : null],\n  /* tuple */\n  [\"url\", url]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  })));\n}\n\nvar definition$1 =\n/* tuple */\n[parse$1, ppx_printed_query$1, definition_002$1];\n\nfunction ret_type$1(f) {\n  return {};\n}\n\nvar MT_Ret$1 = {};\nvar CreateEmbedContentBlock = {\n  ppx_printed_query: ppx_printed_query$1,\n  query: ppx_printed_query$1,\n  parse: parse$1,\n  make: make$1,\n  makeWithVariables: makeWithVariables$1,\n  makeVariables: makeVariables$1,\n  definition: definition$1,\n  ret_type: ret_type$1,\n  MT_Ret: MT_Ret$1\n};\n\nfunction computeInitialState(isAboveTarget) {\n  return {\n    ui: isAboveTarget ?\n    /* Hidden */\n    0 :\n    /* BlockSelector */\n    1,\n    saving: false,\n    error: undefined\n  };\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    switch (action) {\n      case\n      /* ToggleVisibility */\n      0:\n        var match = state.ui;\n        var ui = typeof match === \"number\" && match === 0 ?\n        /* BlockSelector */\n        1 :\n        /* Hidden */\n        0;\n        return {\n          ui: ui,\n          saving: state.saving,\n          error: state.error\n        };\n\n      case\n      /* ToggleSaving */\n      1:\n        return {\n          ui: state.ui,\n          saving: !state.saving,\n          error: undefined\n        };\n\n      case\n      /* FailedToCreate */\n      2:\n        return {\n          ui: state.ui,\n          saving: false,\n          error: \"An unexpected error occured. Please reload the page and try again.\"\n        };\n\n      case\n      /* FailToUpload */\n      3:\n        return {\n          ui: state.ui,\n          saving: false,\n          error: \"Failed to upload file. Please check message in notification, and try again.\"\n        };\n\n      case\n      /* ShowEmbedForm */\n      4:\n        return {\n          ui:\n          /* EmbedForm */\n          [\"\"],\n          saving: state.saving,\n          error: state.error\n        };\n\n      case\n      /* HideEmbedForm */\n      5:\n        return {\n          ui:\n          /* BlockSelector */\n          1,\n          saving: state.saving,\n          error: state.error\n        };\n    }\n  } else {\n    switch (action.tag | 0) {\n      case\n      /* FinishSaving */\n      0:\n        return computeInitialState(action[0]);\n\n      case\n      /* SetError */\n      1:\n        return {\n          ui: state.ui,\n          saving: state.saving,\n          error: action[0]\n        };\n\n      case\n      /* UpdateEmbedUrl */\n      2:\n        return {\n          ui:\n          /* EmbedForm */\n          [action[0]],\n          saving: state.saving,\n          error: state.error\n        };\n    }\n  }\n}\n\nfunction containerClasses(visible, isAboveTarget) {\n  return \"content-block-creator py-3\" + (visible || !isAboveTarget ? \" content-block-creator--open\" : \"\");\n}\n\nfunction handleGraphqlCreateResponse(aboveContentBlock, send, addContentBlockCB, contentBlock) {\n  if (contentBlock !== undefined) {\n    Curry._1(addContentBlockCB, ContentBlock.makeFromJs(Caml_option.valFromOption(contentBlock)));\n\n    Curry._1(send,\n    /* FinishSaving */\n    Block.__(0, [aboveContentBlock !== undefined]));\n  } else {\n    Curry._1(send,\n    /* ToggleSaving */\n    1);\n  }\n\n  return Promise.resolve(\n  /* () */\n  0);\n}\n\nfunction createMarkdownContentBlock(target, aboveContentBlock, send, addContentBlockCB) {\n  Curry._1(send,\n  /* ToggleSaving */\n  1);\n\n  var aboveContentBlockId = OptionUtils.map(ContentBlock.id, aboveContentBlock);\n  var targetId = CurriculumEditor__Target.id(target);\n  (function (eta) {\n    return GraphqlQuery.sendQuery(undefined, eta);\n  })(make(targetId, aboveContentBlockId,\n  /* () */\n  0)).then(function (result) {\n    return handleGraphqlCreateResponse(aboveContentBlock, send, addContentBlockCB, result.createMarkdownContentBlock.contentBlock);\n  })[\"catch\"](function (param) {\n    Curry._1(send,\n    /* FailedToCreate */\n    2);\n\n    return Promise.resolve(\n    /* () */\n    0);\n  });\n  return (\n    /* () */\n    0\n  );\n}\n\nfunction elementId(prefix, aboveContentBlock) {\n  return prefix + (aboveContentBlock !== undefined ? ContentBlock.id(aboveContentBlock) : \"bottom\");\n}\n\nfunction fileInputId(aboveContentBlock) {\n  return elementId(\"markdown-block-file-input-\", aboveContentBlock);\n}\n\nfunction imageInputId(aboveContentBlock) {\n  return elementId(\"markdown-block-image-input-\", aboveContentBlock);\n}\n\nfunction fileFormId(aboveContentBlock) {\n  return elementId(\"markdown-block-file-form-\", aboveContentBlock);\n}\n\nfunction imageFormId(aboveContentBlock) {\n  return elementId(\"markdown-block-image-form-\", aboveContentBlock);\n}\n\nfunction onBlockTypeSelect(target, aboveContentBlock, send, addContentBlockCB, blockType, _event) {\n  if (blockType !== -389316849) {\n    if (blockType !== 50134457) {\n      return (\n        /* () */\n        0\n      );\n    } else {\n      return Curry._1(send,\n      /* ShowEmbedForm */\n      4);\n    }\n  } else {\n    return createMarkdownContentBlock(target, aboveContentBlock, send, addContentBlockCB);\n  }\n}\n\nfunction button(target, aboveContentBlock, send, addContentBlockCB, blockType) {\n  var fileId = elementId(\"markdown-block-file-input-\", aboveContentBlock);\n  var imageId = elementId(\"markdown-block-image-input-\", aboveContentBlock);\n  var match = blockType >= 50134457 ? blockType >= 781515420 ?\n  /* tuple */\n  [\"far fa-file-alt\", \"File\", fileId] :\n  /* tuple */\n  [\"fas fa-code\", \"Embed\", undefined] : blockType >= -389316849 ?\n  /* tuple */\n  [\"fab fa-markdown\", \"Markdown\", undefined] :\n  /* tuple */\n  [\"far fa-image\", \"Image\", imageId];\n  var buttonText = match[1];\n  var tmp = {\n    key: buttonText,\n    className: \"content-block-creator__block-content-type-picker px-3 pt-4 pb-3 flex-1 text-center text-primary-200\",\n    onClick: function onClick(param) {\n      return onBlockTypeSelect(target, aboveContentBlock, send, addContentBlockCB, blockType, param);\n    }\n  };\n  var tmp$1 = match[2];\n\n  if (tmp$1 !== undefined) {\n    tmp.htmlFor = Caml_option.valFromOption(tmp$1);\n  }\n\n  return React.createElement(\"label\", tmp, React.createElement(\"i\", {\n    className: match[0] + \" text-2xl\"\n  }), React.createElement(\"p\", {\n    className: \"font-semibold\"\n  }, buttonText));\n}\n\nfunction isInvalidFile(file) {\n  return file.size > 5242880;\n}\n\nfunction isInvalidImageFile(image) {\n  var match = image.type;\n  var tmp;\n\n  switch (match) {\n    case \"image/gif\":\n    case \"image/jpeg\":\n    case \"image/png\":\n      tmp = false;\n      break;\n\n    default:\n      tmp = true;\n  }\n\n  if (tmp) {\n    return true;\n  } else {\n    return image.size > 5242880;\n  }\n}\n\nfunction uploadFile(target, send, addContentBlockCB, isAboveContentBlock, formData) {\n  return Api.sendFormData(\"/school/targets/\" + (CurriculumEditor__Target.id(target) + \"/content_block\"), formData, function (json) {\n    $$Notification.success(\"Done!\", \"File uploaded successfully.\");\n    var contentBlock = ContentBlock.decode(json);\n\n    Curry._1(addContentBlockCB, contentBlock);\n\n    return Curry._1(send,\n    /* FinishSaving */\n    Block.__(0, [isAboveContentBlock]));\n  }, function (param) {\n    return Curry._1(send,\n    /* FailToUpload */\n    3);\n  });\n}\n\nfunction submitForm(target, aboveContentBlock, send, addContentBlockCB, blockType) {\n  var formId = blockType >= 781515420 ? elementId(\"markdown-block-file-form-\", aboveContentBlock) : elementId(\"markdown-block-image-form-\", aboveContentBlock);\n  var element = document.getElementById(formId);\n\n  if (element == null) {\n    Rollbar.error(\"Could not find form to upload file for content block: \" + formId);\n    throw [FormNotFound, formId];\n  } else {\n    return uploadFile(target, send, addContentBlockCB, aboveContentBlock !== undefined, new FormData(element));\n  }\n}\n\nfunction handleFileInputChange(target, aboveContentBlock, send, addContentBlockCB, blockType, $$event) {\n  $$event.preventDefault();\n  var files = $$event.target.files;\n\n  if (files.length !== 0) {\n    var file = Caml_array.caml_array_get(files, 0);\n    var error = blockType >= 781515420 ? file.size > 5242880 ? \"Please select a file with a size less than 5 MB.\" : undefined : isInvalidImageFile(file) ? \"Please select an image (PNG, JPEG, GIF) with a size less than 5 MB, and less than 4096px wide or high.\" : undefined;\n\n    if (error !== undefined) {\n      return Curry._1(send,\n      /* SetError */\n      Block.__(1, [error]));\n    } else {\n      Curry._1(send,\n      /* ToggleSaving */\n      1);\n\n      return submitForm(target, aboveContentBlock, send, addContentBlockCB, blockType);\n    }\n  } else {\n    return (\n      /* () */\n      0\n    );\n  }\n}\n\nfunction uploadForm(target, aboveContentBlock, send, addContentBlockCB, blockType) {\n  var fileSelectionHandler = function fileSelectionHandler(param, param$1) {\n    return handleFileInputChange(target, aboveContentBlock, send, addContentBlockCB, param, param$1);\n  };\n\n  var match = blockType >= 781515420 ?\n  /* tuple */\n  [elementId(\"markdown-block-file-input-\", aboveContentBlock), elementId(\"markdown-block-file-form-\", aboveContentBlock), function (param) {\n    return fileSelectionHandler(\n    /* File */\n    781515420, param);\n  }, \"file\"] :\n  /* tuple */\n  [elementId(\"markdown-block-image-input-\", aboveContentBlock), elementId(\"markdown-block-image-form-\", aboveContentBlock), function (param) {\n    return fileSelectionHandler(\n    /* Image */\n    -795439301, param);\n  }, \"image\"];\n  return React.createElement(\"form\", {\n    className: \"hidden\",\n    id: match[1]\n  }, React.createElement(\"input\", {\n    name: \"authenticity_token\",\n    type: \"hidden\",\n    value: AuthenticityToken.fromHead(\n    /* () */\n    0)\n  }), React.createElement(\"input\", {\n    name: \"block_type\",\n    type: \"hidden\",\n    value: match[3]\n  }), React.createElement(\"input\", {\n    id: match[0],\n    multiple: false,\n    name: \"file\",\n    required: true,\n    type: \"file\",\n    onChange: match[2]\n  }), aboveContentBlock !== undefined ? React.createElement(\"input\", {\n    name: \"above_content_block_id\",\n    type: \"hidden\",\n    value: ContentBlock.id(aboveContentBlock)\n  }) : null);\n}\n\nfunction visible(state) {\n  var match = state.ui;\n\n  if (typeof match === \"number\") {\n    return match !== 0;\n  } else {\n    return true;\n  }\n}\n\nfunction updateEmbedUrl(send, $$event) {\n  var value = $$event.target.value;\n  return Curry._1(send,\n  /* UpdateEmbedUrl */\n  Block.__(2, [value]));\n}\n\nvar embedUrlRegexes = [/https:\\/\\/.*slideshare\\.net/, /https:\\/\\/.*vimeo\\.com/, /https:\\/\\/.*youtube\\.com/, /https:\\/\\/.*youtu\\.be/];\n\nfunction validEmbedUrl(url) {\n  return Belt_Array.some(embedUrlRegexes, function (regex) {\n    return regex.test(url);\n  });\n}\n\nfunction onEmbedFormSave(target, aboveContentBlock, url, send, addContentBlockCB, $$event) {\n  $$event.preventDefault();\n\n  if (validEmbedUrl(url)) {\n    Curry._1(send,\n    /* ToggleSaving */\n    1);\n\n    var aboveContentBlockId = OptionUtils.map(ContentBlock.id, aboveContentBlock);\n    var targetId = CurriculumEditor__Target.id(target);\n    (function (eta) {\n      return GraphqlQuery.sendQuery(undefined, eta);\n    })(make$1(targetId, aboveContentBlockId, url,\n    /* () */\n    0)).then(function (result) {\n      return handleGraphqlCreateResponse(aboveContentBlock, send, addContentBlockCB, result.createEmbedContentBlock.contentBlock);\n    })[\"catch\"](function (param) {\n      Curry._1(send,\n      /* FailedToCreate */\n      2);\n\n      return Promise.resolve(\n      /* () */\n      0);\n    });\n    return (\n      /* () */\n      0\n    );\n  } else {\n    return Curry._1(send,\n    /* SetError */\n    Block.__(1, [\"The URL doesn't look valid. Please make sure that it starts with 'https://' and that it's one of the accepted websites.\"]));\n  }\n}\n\nfunction topButton(handler, id, title, icon) {\n  return React.createElement(\"div\", {\n    className: \"content-block-creator__top-button-container relative cursor-pointer\",\n    onClick: handler\n  }, React.createElement(\"div\", {\n    className: \"content-block-creator__top-button bg-gray-200 hover:bg-gray-300 relative rounded-lg border border-gray-500 w-10 h-10 flex justify-center items-center mx-auto z-20\",\n    id: \"top-button-\" + id,\n    title: title\n  }, React.createElement(FaIcon.make, {\n    classes: \"text-base fas \" + icon\n  })));\n}\n\nfunction closeEmbedFormButton(send, aboveContentBlock) {\n  var id = OptionUtils.$$default(\"bottom\", OptionUtils.map(ContentBlock.id, aboveContentBlock));\n  return topButton(function (_e) {\n    return Curry._1(send,\n    /* HideEmbedForm */\n    5);\n  }, id, \"Close Embed Form\", \"fa-level-up-alt\");\n}\n\nfunction toggleVisibilityButton(send, contentBlock) {\n  return topButton(function (_e) {\n    return Curry._1(send,\n    /* ToggleVisibility */\n    0);\n  }, ContentBlock.id(contentBlock), \"Toggle Content Block Form\", \"fa-plus content-block-creator__plus-button-icon\");\n}\n\nfunction buttonAboveContentBlock(state, send, aboveContentBlock) {\n  var match = state.ui;\n\n  if (typeof match === \"number\") {\n    if (match !== 0) {\n      if (aboveContentBlock !== undefined) {\n        return toggleVisibilityButton(send, aboveContentBlock);\n      }\n    } else if (aboveContentBlock !== undefined) {\n      return toggleVisibilityButton(send, aboveContentBlock);\n    }\n  } else {\n    return closeEmbedFormButton(send, aboveContentBlock);\n  }\n\n  return React.createElement(\"div\", {\n    className: \"h-10\"\n  });\n}\n\nfunction CurriculumEditor__ContentBlockCreator(Props) {\n  var target = Props.target;\n  var aboveContentBlock = Props.aboveContentBlock;\n  var addContentBlockCB = Props.addContentBlockCB;\n  var match;\n\n  if (aboveContentBlock !== undefined) {\n    var id = \"embed-\" + ContentBlock.id(aboveContentBlock);\n    match =\n    /* tuple */\n    [id, true];\n  } else {\n    match =\n    /* tuple */\n    [\"embed-bottom\", false];\n  }\n\n  var isAboveContentBlock = match[1];\n  var embedInputId = match[0];\n  var match$1 = React.useReducer(reducer, isAboveContentBlock, computeInitialState);\n  var send = match$1[1];\n  var state = match$1[0];\n  var match$2 = state.ui;\n  var tmp;\n\n  if (typeof match$2 === \"number\") {\n    tmp = match$2 !== 0 ? React.createElement(\"div\", {\n      className: \"content-block-creator__block-content-type text-sm hidden shadow-lg mx-auto relative bg-primary-900 rounded-lg -mt-4 z-10\"\n    }, $$Array.map(function (param) {\n      return button(target, aboveContentBlock, send, addContentBlockCB, param);\n    }, [\n    /* Markdown */\n    -389316849,\n    /* Image */\n    -795439301,\n    /* Embed */\n    50134457,\n    /* File */\n    781515420])) : null;\n  } else {\n    var url = match$2[0];\n    tmp = React.createElement(\"div\", {\n      className: \"clearfix border-2 border-gray-400 bg-gray-200 border-dashed rounded-lg px-3 pb-3 pt-2 -mt-4 z-10\"\n    }, React.createElement(\"label\", {\n      className: \"text-xs font-semibold\",\n      htmlFor: embedInputId\n    }, \"URL to Embed\"), React.createElement(HelpIcon.make, {\n      className: \"ml-2 text-xs\",\n      link: \"https://docs.pupilfirst.com/#/curriculum_editor?id=content-block-types\",\n      children: \"We support YouTube, Vimeo, and Slideshare URLs. Just copy & paste the full URL to the page that contains the resource that you'd like to embed.\"\n    }), React.createElement(\"div\", {\n      className: \"flex mt-1\"\n    }, React.createElement(\"input\", {\n      className: \"w-full py-1 px-2 border rounded\",\n      id: embedInputId,\n      placeholder: \"https://www.youtube.com/watch?v=\",\n      type: \"text\",\n      value: url,\n      onChange: function onChange(param) {\n        return updateEmbedUrl(send, param);\n      }\n    }), React.createElement(\"button\", {\n      className: \"ml-2 btn btn-success\",\n      onClick: function onClick(param) {\n        return onEmbedFormSave(target, aboveContentBlock, url, send, addContentBlockCB, param);\n      }\n    }, \"Save\")));\n  }\n\n  var match$3 = state.error;\n  return React.createElement(DisablingCover.make, {\n    disabled: state.saving,\n    message: \"Creating...\",\n    children: null\n  }, uploadForm(target, aboveContentBlock, send, addContentBlockCB,\n  /* File */\n  781515420), uploadForm(target, aboveContentBlock, send, addContentBlockCB,\n  /* Image */\n  -795439301), React.createElement(\"div\", {\n    className: containerClasses(visible(state), isAboveContentBlock)\n  }, buttonAboveContentBlock(state, send, aboveContentBlock), React.createElement(\"div\", {\n    className: \"content-block-creator__inner-container\"\n  }, tmp), match$3 !== undefined ? React.createElement(School__InputGroupError.make, {\n    message: match$3,\n    active: visible(state)\n  }) : null));\n}\n\nvar maxAllowedFileSize = 5242880;\nvar make$2 = CurriculumEditor__ContentBlockCreator;\nexports.FormNotFound = FormNotFound;\nexports.str = str;\nexports.CreateMarkdownContentBlock = CreateMarkdownContentBlock;\nexports.CreateEmbedContentBlock = CreateEmbedContentBlock;\nexports.computeInitialState = computeInitialState;\nexports.reducer = reducer;\nexports.containerClasses = containerClasses;\nexports.handleGraphqlCreateResponse = handleGraphqlCreateResponse;\nexports.createMarkdownContentBlock = createMarkdownContentBlock;\nexports.elementId = elementId;\nexports.fileInputId = fileInputId;\nexports.imageInputId = imageInputId;\nexports.fileFormId = fileFormId;\nexports.imageFormId = imageFormId;\nexports.onBlockTypeSelect = onBlockTypeSelect;\nexports.button = button;\nexports.maxAllowedFileSize = maxAllowedFileSize;\nexports.isInvalidFile = isInvalidFile;\nexports.isInvalidImageFile = isInvalidImageFile;\nexports.uploadFile = uploadFile;\nexports.submitForm = submitForm;\nexports.handleFileInputChange = handleFileInputChange;\nexports.uploadForm = uploadForm;\nexports.visible = visible;\nexports.updateEmbedUrl = updateEmbedUrl;\nexports.embedUrlRegexes = embedUrlRegexes;\nexports.validEmbedUrl = validEmbedUrl;\nexports.onEmbedFormSave = onEmbedFormSave;\nexports.topButton = topButton;\nexports.closeEmbedFormButton = closeEmbedFormButton;\nexports.toggleVisibilityButton = toggleVisibilityButton;\nexports.buttonAboveContentBlock = buttonAboveContentBlock;\nexports.make = make$2;\n/*  Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/schools/courses/components/curriculum_editor/CurriculumEditor__ContentBlockCreator.bs.js"],"names":["Api","require","$$Array","Block","Curry","React","FaIcon","Js_exn","Js_dict","Js_json","HelpIcon","Js_option","Belt_Array","Caml_array","Caml_option","OptionUtils","ContentBlock","GraphqlQuery","$$Notification","DisablingCover","Caml_exceptions","AuthenticityToken","School__InputGroupError","CurriculumEditor__Target","FormNotFound","create","str","prim","ppx_printed_query","Fragments","AllFields","name","query","parse","value","value$1","getExn","decodeObject","match","get","tmp","undefined","value$2","valFromOption","match$1","tmp$1","value$3","match$2","decodeNull","some","_1","contentBlock","raiseError","createMarkdownContentBlock","make","targetId","aboveContentBlockId","param","variables","fromArray","filter","test","makeWithVariables","makeVariables","definition_002","graphql_ppx_use_json_variables_fn","definition","ret_type","f","MT_Ret","CreateMarkdownContentBlock","ppx_printed_query$1","parse$1","createEmbedContentBlock","make$1","url","makeWithVariables$1","makeVariables$1","definition_002$1","definition$1","ret_type$1","MT_Ret$1","CreateEmbedContentBlock","computeInitialState","isAboveTarget","ui","saving","error","reducer","state","action","tag","containerClasses","visible","handleGraphqlCreateResponse","aboveContentBlock","send","addContentBlockCB","makeFromJs","__","Promise","resolve","target","map","id","eta","sendQuery","then","result","elementId","prefix","fileInputId","imageInputId","fileFormId","imageFormId","onBlockTypeSelect","blockType","_event","button","fileId","imageId","buttonText","key","className","onClick","htmlFor","createElement","isInvalidFile","file","size","isInvalidImageFile","image","type","uploadFile","isAboveContentBlock","formData","sendFormData","json","success","decode","submitForm","formId","element","document","getElementById","Rollbar","FormData","handleFileInputChange","$$event","preventDefault","files","length","caml_array_get","uploadForm","fileSelectionHandler","param$1","fromHead","multiple","required","onChange","updateEmbedUrl","embedUrlRegexes","validEmbedUrl","regex","onEmbedFormSave","topButton","handler","title","icon","classes","closeEmbedFormButton","$$default","_e","toggleVisibilityButton","buttonAboveContentBlock","CurriculumEditor__ContentBlockCreator","Props","embedInputId","useReducer","link","children","placeholder","match$3","disabled","message","active","maxAllowedFileSize","make$2","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../../../../shared/Api.bs.js\");\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\nvar Block = require(\"bs-platform/lib/js/block.js\");\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar FaIcon = require(\"../../../../shared/components/FaIcon.bs.js\");\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\nvar HelpIcon = require(\"../../../../shared/components/HelpIcon.bs.js\");\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\nvar Belt_Array = require(\"bs-platform/lib/js/belt_Array.js\");\nvar Caml_array = require(\"bs-platform/lib/js/caml_array.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar OptionUtils = require(\"../../../../shared/utils/OptionUtils.bs.js\");\nvar ContentBlock = require(\"../../../../shared/types/ContentBlock.bs.js\");\nvar GraphqlQuery = require(\"../../../../shared/utils/GraphqlQuery.bs.js\");\nvar $$Notification = require(\"../../../../shared/Notification.bs.js\");\nvar DisablingCover = require(\"../../../../shared/components/DisablingCover.bs.js\");\nvar Caml_exceptions = require(\"bs-platform/lib/js/caml_exceptions.js\");\nvar AuthenticityToken = require(\"../../../../shared/utils/AuthenticityToken.bs.js\");\nvar School__InputGroupError = require(\"../../../shared/components/School__InputGroupError.bs.js\");\nvar CurriculumEditor__Target = require(\"../../types/curriculum_editor/CurriculumEditor__Target.bs.js\");\n\nvar FormNotFound = Caml_exceptions.create(\"CurriculumEditor__ContentBlockCreator.FormNotFound\");\n\n((require(\"./CurriculumEditor__ContentBlockCreator.css\")));\n\nfunction str(prim) {\n  return prim;\n}\n\nvar ppx_printed_query = \"mutation CreateMarkdownContentBlockMutation($targetId: ID!, $aboveContentBlockId: ID)  {\\ncreateMarkdownContentBlock(targetId: $targetId, aboveContentBlockId: $aboveContentBlockId)  {\\ncontentBlock  {\\n...\" + ContentBlock.Fragments.AllFields.name + \"   \\n}\\n\\n}\\n\\n}\\n\" + ContentBlock.Fragments.AllFields.query;\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"createMarkdownContentBlock\");\n  var tmp;\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"contentBlock\");\n    var tmp$1;\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeNull(value$3);\n      tmp$1 = match$2 !== undefined ? undefined : Caml_option.some(Curry._1(ContentBlock.Fragments.AllFields.parse, value$3));\n    } else {\n      tmp$1 = undefined;\n    }\n    tmp = {\n      contentBlock: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field createMarkdownContentBlock on type Mutation is missing\");\n  }\n  return {\n          createMarkdownContentBlock: tmp\n        };\n}\n\nfunction make(targetId, aboveContentBlockId, param) {\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"targetId\",\n                    targetId\n                  ],\n                  /* tuple */[\n                    \"aboveContentBlockId\",\n                    aboveContentBlockId !== undefined ? aboveContentBlockId : null\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeWithVariables(variables) {\n  var targetId = variables.targetId;\n  var aboveContentBlockId = variables.aboveContentBlockId;\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"targetId\",\n                    targetId\n                  ],\n                  /* tuple */[\n                    \"aboveContentBlockId\",\n                    aboveContentBlockId !== undefined ? aboveContentBlockId : null\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeVariables(targetId, aboveContentBlockId, param) {\n  return Js_dict.fromArray([\n                /* tuple */[\n                  \"targetId\",\n                  targetId\n                ],\n                /* tuple */[\n                  \"aboveContentBlockId\",\n                  aboveContentBlockId !== undefined ? aboveContentBlockId : null\n                ]\n              ].filter((function (param) {\n                    return !Js_json.test(param[1], /* Null */5);\n                  })));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, targetId, aboveContentBlockId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n                    /* tuple */[\n                      \"targetId\",\n                      targetId\n                    ],\n                    /* tuple */[\n                      \"aboveContentBlockId\",\n                      aboveContentBlockId !== undefined ? aboveContentBlockId : null\n                    ]\n                  ].filter((function (param) {\n                        return !Js_json.test(param[1], /* Null */5);\n                      }))));\n}\n\nvar definition = /* tuple */[\n  parse,\n  ppx_printed_query,\n  definition_002\n];\n\nfunction ret_type(f) {\n  return { };\n}\n\nvar MT_Ret = { };\n\nvar CreateMarkdownContentBlock = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nvar ppx_printed_query$1 = \"mutation CreateEmbedContentBlockMutation($targetId: ID!, $aboveContentBlockId: ID, $url: String!)  {\\ncreateEmbedContentBlock(targetId: $targetId, aboveContentBlockId: $aboveContentBlockId, url: $url)  {\\ncontentBlock  {\\n...\" + ContentBlock.Fragments.AllFields.name + \"   \\n}\\n\\n}\\n\\n}\\n\" + ContentBlock.Fragments.AllFields.query;\n\nfunction parse$1(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"createEmbedContentBlock\");\n  var tmp;\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"contentBlock\");\n    var tmp$1;\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeNull(value$3);\n      tmp$1 = match$2 !== undefined ? undefined : Caml_option.some(Curry._1(ContentBlock.Fragments.AllFields.parse, value$3));\n    } else {\n      tmp$1 = undefined;\n    }\n    tmp = {\n      contentBlock: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field createEmbedContentBlock on type Mutation is missing\");\n  }\n  return {\n          createEmbedContentBlock: tmp\n        };\n}\n\nfunction make$1(targetId, aboveContentBlockId, url, param) {\n  return {\n          query: ppx_printed_query$1,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"targetId\",\n                    targetId\n                  ],\n                  /* tuple */[\n                    \"aboveContentBlockId\",\n                    aboveContentBlockId !== undefined ? aboveContentBlockId : null\n                  ],\n                  /* tuple */[\n                    \"url\",\n                    url\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse$1\n        };\n}\n\nfunction makeWithVariables$1(variables) {\n  var targetId = variables.targetId;\n  var aboveContentBlockId = variables.aboveContentBlockId;\n  var url = variables.url;\n  return {\n          query: ppx_printed_query$1,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"targetId\",\n                    targetId\n                  ],\n                  /* tuple */[\n                    \"aboveContentBlockId\",\n                    aboveContentBlockId !== undefined ? aboveContentBlockId : null\n                  ],\n                  /* tuple */[\n                    \"url\",\n                    url\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse$1\n        };\n}\n\nfunction makeVariables$1(targetId, aboveContentBlockId, url, param) {\n  return Js_dict.fromArray([\n                /* tuple */[\n                  \"targetId\",\n                  targetId\n                ],\n                /* tuple */[\n                  \"aboveContentBlockId\",\n                  aboveContentBlockId !== undefined ? aboveContentBlockId : null\n                ],\n                /* tuple */[\n                  \"url\",\n                  url\n                ]\n              ].filter((function (param) {\n                    return !Js_json.test(param[1], /* Null */5);\n                  })));\n}\n\nfunction definition_002$1(graphql_ppx_use_json_variables_fn, targetId, aboveContentBlockId, url, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n                    /* tuple */[\n                      \"targetId\",\n                      targetId\n                    ],\n                    /* tuple */[\n                      \"aboveContentBlockId\",\n                      aboveContentBlockId !== undefined ? aboveContentBlockId : null\n                    ],\n                    /* tuple */[\n                      \"url\",\n                      url\n                    ]\n                  ].filter((function (param) {\n                        return !Js_json.test(param[1], /* Null */5);\n                      }))));\n}\n\nvar definition$1 = /* tuple */[\n  parse$1,\n  ppx_printed_query$1,\n  definition_002$1\n];\n\nfunction ret_type$1(f) {\n  return { };\n}\n\nvar MT_Ret$1 = { };\n\nvar CreateEmbedContentBlock = {\n  ppx_printed_query: ppx_printed_query$1,\n  query: ppx_printed_query$1,\n  parse: parse$1,\n  make: make$1,\n  makeWithVariables: makeWithVariables$1,\n  makeVariables: makeVariables$1,\n  definition: definition$1,\n  ret_type: ret_type$1,\n  MT_Ret: MT_Ret$1\n};\n\nfunction computeInitialState(isAboveTarget) {\n  return {\n          ui: isAboveTarget ? /* Hidden */0 : /* BlockSelector */1,\n          saving: false,\n          error: undefined\n        };\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    switch (action) {\n      case /* ToggleVisibility */0 :\n          var match = state.ui;\n          var ui = typeof match === \"number\" && match === 0 ? /* BlockSelector */1 : /* Hidden */0;\n          return {\n                  ui: ui,\n                  saving: state.saving,\n                  error: state.error\n                };\n      case /* ToggleSaving */1 :\n          return {\n                  ui: state.ui,\n                  saving: !state.saving,\n                  error: undefined\n                };\n      case /* FailedToCreate */2 :\n          return {\n                  ui: state.ui,\n                  saving: false,\n                  error: \"An unexpected error occured. Please reload the page and try again.\"\n                };\n      case /* FailToUpload */3 :\n          return {\n                  ui: state.ui,\n                  saving: false,\n                  error: \"Failed to upload file. Please check message in notification, and try again.\"\n                };\n      case /* ShowEmbedForm */4 :\n          return {\n                  ui: /* EmbedForm */[\"\"],\n                  saving: state.saving,\n                  error: state.error\n                };\n      case /* HideEmbedForm */5 :\n          return {\n                  ui: /* BlockSelector */1,\n                  saving: state.saving,\n                  error: state.error\n                };\n      \n    }\n  } else {\n    switch (action.tag | 0) {\n      case /* FinishSaving */0 :\n          return computeInitialState(action[0]);\n      case /* SetError */1 :\n          return {\n                  ui: state.ui,\n                  saving: state.saving,\n                  error: action[0]\n                };\n      case /* UpdateEmbedUrl */2 :\n          return {\n                  ui: /* EmbedForm */[action[0]],\n                  saving: state.saving,\n                  error: state.error\n                };\n      \n    }\n  }\n}\n\nfunction containerClasses(visible, isAboveTarget) {\n  return \"content-block-creator py-3\" + (\n          visible || !isAboveTarget ? \" content-block-creator--open\" : \"\"\n        );\n}\n\nfunction handleGraphqlCreateResponse(aboveContentBlock, send, addContentBlockCB, contentBlock) {\n  if (contentBlock !== undefined) {\n    Curry._1(addContentBlockCB, ContentBlock.makeFromJs(Caml_option.valFromOption(contentBlock)));\n    Curry._1(send, /* FinishSaving */Block.__(0, [aboveContentBlock !== undefined]));\n  } else {\n    Curry._1(send, /* ToggleSaving */1);\n  }\n  return Promise.resolve(/* () */0);\n}\n\nfunction createMarkdownContentBlock(target, aboveContentBlock, send, addContentBlockCB) {\n  Curry._1(send, /* ToggleSaving */1);\n  var aboveContentBlockId = OptionUtils.map(ContentBlock.id, aboveContentBlock);\n  var targetId = CurriculumEditor__Target.id(target);\n  (function (eta) {\n            return GraphqlQuery.sendQuery(undefined, eta);\n          })(make(targetId, aboveContentBlockId, /* () */0)).then((function (result) {\n            return handleGraphqlCreateResponse(aboveContentBlock, send, addContentBlockCB, result.createMarkdownContentBlock.contentBlock);\n          })).catch((function (param) {\n          Curry._1(send, /* FailedToCreate */2);\n          return Promise.resolve(/* () */0);\n        }));\n  return /* () */0;\n}\n\nfunction elementId(prefix, aboveContentBlock) {\n  return prefix + (\n          aboveContentBlock !== undefined ? ContentBlock.id(aboveContentBlock) : \"bottom\"\n        );\n}\n\nfunction fileInputId(aboveContentBlock) {\n  return elementId(\"markdown-block-file-input-\", aboveContentBlock);\n}\n\nfunction imageInputId(aboveContentBlock) {\n  return elementId(\"markdown-block-image-input-\", aboveContentBlock);\n}\n\nfunction fileFormId(aboveContentBlock) {\n  return elementId(\"markdown-block-file-form-\", aboveContentBlock);\n}\n\nfunction imageFormId(aboveContentBlock) {\n  return elementId(\"markdown-block-image-form-\", aboveContentBlock);\n}\n\nfunction onBlockTypeSelect(target, aboveContentBlock, send, addContentBlockCB, blockType, _event) {\n  if (blockType !== -389316849) {\n    if (blockType !== 50134457) {\n      return /* () */0;\n    } else {\n      return Curry._1(send, /* ShowEmbedForm */4);\n    }\n  } else {\n    return createMarkdownContentBlock(target, aboveContentBlock, send, addContentBlockCB);\n  }\n}\n\nfunction button(target, aboveContentBlock, send, addContentBlockCB, blockType) {\n  var fileId = elementId(\"markdown-block-file-input-\", aboveContentBlock);\n  var imageId = elementId(\"markdown-block-image-input-\", aboveContentBlock);\n  var match = blockType >= 50134457 ? (\n      blockType >= 781515420 ? /* tuple */[\n          \"far fa-file-alt\",\n          \"File\",\n          fileId\n        ] : /* tuple */[\n          \"fas fa-code\",\n          \"Embed\",\n          undefined\n        ]\n    ) : (\n      blockType >= -389316849 ? /* tuple */[\n          \"fab fa-markdown\",\n          \"Markdown\",\n          undefined\n        ] : /* tuple */[\n          \"far fa-image\",\n          \"Image\",\n          imageId\n        ]\n    );\n  var buttonText = match[1];\n  var tmp = {\n    key: buttonText,\n    className: \"content-block-creator__block-content-type-picker px-3 pt-4 pb-3 flex-1 text-center text-primary-200\",\n    onClick: (function (param) {\n        return onBlockTypeSelect(target, aboveContentBlock, send, addContentBlockCB, blockType, param);\n      })\n  };\n  var tmp$1 = match[2];\n  if (tmp$1 !== undefined) {\n    tmp.htmlFor = Caml_option.valFromOption(tmp$1);\n  }\n  return React.createElement(\"label\", tmp, React.createElement(\"i\", {\n                  className: match[0] + \" text-2xl\"\n                }), React.createElement(\"p\", {\n                  className: \"font-semibold\"\n                }, buttonText));\n}\n\nfunction isInvalidFile(file) {\n  return file.size > 5242880;\n}\n\nfunction isInvalidImageFile(image) {\n  var match = image.type;\n  var tmp;\n  switch (match) {\n    case \"image/gif\" :\n    case \"image/jpeg\" :\n    case \"image/png\" :\n        tmp = false;\n        break;\n    default:\n      tmp = true;\n  }\n  if (tmp) {\n    return true;\n  } else {\n    return image.size > 5242880;\n  }\n}\n\nfunction uploadFile(target, send, addContentBlockCB, isAboveContentBlock, formData) {\n  return Api.sendFormData(\"/school/targets/\" + (CurriculumEditor__Target.id(target) + \"/content_block\"), formData, (function (json) {\n                $$Notification.success(\"Done!\", \"File uploaded successfully.\");\n                var contentBlock = ContentBlock.decode(json);\n                Curry._1(addContentBlockCB, contentBlock);\n                return Curry._1(send, /* FinishSaving */Block.__(0, [isAboveContentBlock]));\n              }), (function (param) {\n                return Curry._1(send, /* FailToUpload */3);\n              }));\n}\n\nfunction submitForm(target, aboveContentBlock, send, addContentBlockCB, blockType) {\n  var formId = blockType >= 781515420 ? elementId(\"markdown-block-file-form-\", aboveContentBlock) : elementId(\"markdown-block-image-form-\", aboveContentBlock);\n  var element = document.getElementById(formId);\n  if (element == null) {\n    Rollbar.error(\"Could not find form to upload file for content block: \" + formId);\n    throw [\n          FormNotFound,\n          formId\n        ];\n  } else {\n    return uploadFile(target, send, addContentBlockCB, aboveContentBlock !== undefined, new FormData(element));\n  }\n}\n\nfunction handleFileInputChange(target, aboveContentBlock, send, addContentBlockCB, blockType, $$event) {\n  $$event.preventDefault();\n  var files = $$event.target.files;\n  if (files.length !== 0) {\n    var file = Caml_array.caml_array_get(files, 0);\n    var error = blockType >= 781515420 ? (\n        file.size > 5242880 ? \"Please select a file with a size less than 5 MB.\" : undefined\n      ) : (\n        isInvalidImageFile(file) ? \"Please select an image (PNG, JPEG, GIF) with a size less than 5 MB, and less than 4096px wide or high.\" : undefined\n      );\n    if (error !== undefined) {\n      return Curry._1(send, /* SetError */Block.__(1, [error]));\n    } else {\n      Curry._1(send, /* ToggleSaving */1);\n      return submitForm(target, aboveContentBlock, send, addContentBlockCB, blockType);\n    }\n  } else {\n    return /* () */0;\n  }\n}\n\nfunction uploadForm(target, aboveContentBlock, send, addContentBlockCB, blockType) {\n  var fileSelectionHandler = function (param, param$1) {\n    return handleFileInputChange(target, aboveContentBlock, send, addContentBlockCB, param, param$1);\n  };\n  var match = blockType >= 781515420 ? /* tuple */[\n      elementId(\"markdown-block-file-input-\", aboveContentBlock),\n      elementId(\"markdown-block-file-form-\", aboveContentBlock),\n      (function (param) {\n          return fileSelectionHandler(/* File */781515420, param);\n        }),\n      \"file\"\n    ] : /* tuple */[\n      elementId(\"markdown-block-image-input-\", aboveContentBlock),\n      elementId(\"markdown-block-image-form-\", aboveContentBlock),\n      (function (param) {\n          return fileSelectionHandler(/* Image */-795439301, param);\n        }),\n      \"image\"\n    ];\n  return React.createElement(\"form\", {\n              className: \"hidden\",\n              id: match[1]\n            }, React.createElement(\"input\", {\n                  name: \"authenticity_token\",\n                  type: \"hidden\",\n                  value: AuthenticityToken.fromHead(/* () */0)\n                }), React.createElement(\"input\", {\n                  name: \"block_type\",\n                  type: \"hidden\",\n                  value: match[3]\n                }), React.createElement(\"input\", {\n                  id: match[0],\n                  multiple: false,\n                  name: \"file\",\n                  required: true,\n                  type: \"file\",\n                  onChange: match[2]\n                }), aboveContentBlock !== undefined ? React.createElement(\"input\", {\n                    name: \"above_content_block_id\",\n                    type: \"hidden\",\n                    value: ContentBlock.id(aboveContentBlock)\n                  }) : null);\n}\n\nfunction visible(state) {\n  var match = state.ui;\n  if (typeof match === \"number\") {\n    return match !== 0;\n  } else {\n    return true;\n  }\n}\n\nfunction updateEmbedUrl(send, $$event) {\n  var value = $$event.target.value;\n  return Curry._1(send, /* UpdateEmbedUrl */Block.__(2, [value]));\n}\n\nvar embedUrlRegexes = [\n  /https:\\/\\/.*slideshare\\.net/,\n  /https:\\/\\/.*vimeo\\.com/,\n  /https:\\/\\/.*youtube\\.com/,\n  /https:\\/\\/.*youtu\\.be/\n];\n\nfunction validEmbedUrl(url) {\n  return Belt_Array.some(embedUrlRegexes, (function (regex) {\n                return regex.test(url);\n              }));\n}\n\nfunction onEmbedFormSave(target, aboveContentBlock, url, send, addContentBlockCB, $$event) {\n  $$event.preventDefault();\n  if (validEmbedUrl(url)) {\n    Curry._1(send, /* ToggleSaving */1);\n    var aboveContentBlockId = OptionUtils.map(ContentBlock.id, aboveContentBlock);\n    var targetId = CurriculumEditor__Target.id(target);\n    (function (eta) {\n              return GraphqlQuery.sendQuery(undefined, eta);\n            })(make$1(targetId, aboveContentBlockId, url, /* () */0)).then((function (result) {\n              return handleGraphqlCreateResponse(aboveContentBlock, send, addContentBlockCB, result.createEmbedContentBlock.contentBlock);\n            })).catch((function (param) {\n            Curry._1(send, /* FailedToCreate */2);\n            return Promise.resolve(/* () */0);\n          }));\n    return /* () */0;\n  } else {\n    return Curry._1(send, /* SetError */Block.__(1, [\"The URL doesn't look valid. Please make sure that it starts with 'https://' and that it's one of the accepted websites.\"]));\n  }\n}\n\nfunction topButton(handler, id, title, icon) {\n  return React.createElement(\"div\", {\n              className: \"content-block-creator__top-button-container relative cursor-pointer\",\n              onClick: handler\n            }, React.createElement(\"div\", {\n                  className: \"content-block-creator__top-button bg-gray-200 hover:bg-gray-300 relative rounded-lg border border-gray-500 w-10 h-10 flex justify-center items-center mx-auto z-20\",\n                  id: \"top-button-\" + id,\n                  title: title\n                }, React.createElement(FaIcon.make, {\n                      classes: \"text-base fas \" + icon\n                    })));\n}\n\nfunction closeEmbedFormButton(send, aboveContentBlock) {\n  var id = OptionUtils.$$default(\"bottom\", OptionUtils.map(ContentBlock.id, aboveContentBlock));\n  return topButton((function (_e) {\n                return Curry._1(send, /* HideEmbedForm */5);\n              }), id, \"Close Embed Form\", \"fa-level-up-alt\");\n}\n\nfunction toggleVisibilityButton(send, contentBlock) {\n  return topButton((function (_e) {\n                return Curry._1(send, /* ToggleVisibility */0);\n              }), ContentBlock.id(contentBlock), \"Toggle Content Block Form\", \"fa-plus content-block-creator__plus-button-icon\");\n}\n\nfunction buttonAboveContentBlock(state, send, aboveContentBlock) {\n  var match = state.ui;\n  if (typeof match === \"number\") {\n    if (match !== 0) {\n      if (aboveContentBlock !== undefined) {\n        return toggleVisibilityButton(send, aboveContentBlock);\n      }\n      \n    } else if (aboveContentBlock !== undefined) {\n      return toggleVisibilityButton(send, aboveContentBlock);\n    }\n    \n  } else {\n    return closeEmbedFormButton(send, aboveContentBlock);\n  }\n  return React.createElement(\"div\", {\n              className: \"h-10\"\n            });\n}\n\nfunction CurriculumEditor__ContentBlockCreator(Props) {\n  var target = Props.target;\n  var aboveContentBlock = Props.aboveContentBlock;\n  var addContentBlockCB = Props.addContentBlockCB;\n  var match;\n  if (aboveContentBlock !== undefined) {\n    var id = \"embed-\" + ContentBlock.id(aboveContentBlock);\n    match = /* tuple */[\n      id,\n      true\n    ];\n  } else {\n    match = /* tuple */[\n      \"embed-bottom\",\n      false\n    ];\n  }\n  var isAboveContentBlock = match[1];\n  var embedInputId = match[0];\n  var match$1 = React.useReducer(reducer, isAboveContentBlock, computeInitialState);\n  var send = match$1[1];\n  var state = match$1[0];\n  var match$2 = state.ui;\n  var tmp;\n  if (typeof match$2 === \"number\") {\n    tmp = match$2 !== 0 ? React.createElement(\"div\", {\n            className: \"content-block-creator__block-content-type text-sm hidden shadow-lg mx-auto relative bg-primary-900 rounded-lg -mt-4 z-10\"\n          }, $$Array.map((function (param) {\n                  return button(target, aboveContentBlock, send, addContentBlockCB, param);\n                }), [\n                /* Markdown */-389316849,\n                /* Image */-795439301,\n                /* Embed */50134457,\n                /* File */781515420\n              ])) : null;\n  } else {\n    var url = match$2[0];\n    tmp = React.createElement(\"div\", {\n          className: \"clearfix border-2 border-gray-400 bg-gray-200 border-dashed rounded-lg px-3 pb-3 pt-2 -mt-4 z-10\"\n        }, React.createElement(\"label\", {\n              className: \"text-xs font-semibold\",\n              htmlFor: embedInputId\n            }, \"URL to Embed\"), React.createElement(HelpIcon.make, {\n              className: \"ml-2 text-xs\",\n              link: \"https://docs.pupilfirst.com/#/curriculum_editor?id=content-block-types\",\n              children: \"We support YouTube, Vimeo, and Slideshare URLs. Just copy & paste the full URL to the page that contains the resource that you'd like to embed.\"\n            }), React.createElement(\"div\", {\n              className: \"flex mt-1\"\n            }, React.createElement(\"input\", {\n                  className: \"w-full py-1 px-2 border rounded\",\n                  id: embedInputId,\n                  placeholder: \"https://www.youtube.com/watch?v=\",\n                  type: \"text\",\n                  value: url,\n                  onChange: (function (param) {\n                      return updateEmbedUrl(send, param);\n                    })\n                }), React.createElement(\"button\", {\n                  className: \"ml-2 btn btn-success\",\n                  onClick: (function (param) {\n                      return onEmbedFormSave(target, aboveContentBlock, url, send, addContentBlockCB, param);\n                    })\n                }, \"Save\")));\n  }\n  var match$3 = state.error;\n  return React.createElement(DisablingCover.make, {\n              disabled: state.saving,\n              message: \"Creating...\",\n              children: null\n            }, uploadForm(target, aboveContentBlock, send, addContentBlockCB, /* File */781515420), uploadForm(target, aboveContentBlock, send, addContentBlockCB, /* Image */-795439301), React.createElement(\"div\", {\n                  className: containerClasses(visible(state), isAboveContentBlock)\n                }, buttonAboveContentBlock(state, send, aboveContentBlock), React.createElement(\"div\", {\n                      className: \"content-block-creator__inner-container\"\n                    }, tmp), match$3 !== undefined ? React.createElement(School__InputGroupError.make, {\n                        message: match$3,\n                        active: visible(state)\n                      }) : null));\n}\n\nvar maxAllowedFileSize = 5242880;\n\nvar make$2 = CurriculumEditor__ContentBlockCreator;\n\nexports.FormNotFound = FormNotFound;\nexports.str = str;\nexports.CreateMarkdownContentBlock = CreateMarkdownContentBlock;\nexports.CreateEmbedContentBlock = CreateEmbedContentBlock;\nexports.computeInitialState = computeInitialState;\nexports.reducer = reducer;\nexports.containerClasses = containerClasses;\nexports.handleGraphqlCreateResponse = handleGraphqlCreateResponse;\nexports.createMarkdownContentBlock = createMarkdownContentBlock;\nexports.elementId = elementId;\nexports.fileInputId = fileInputId;\nexports.imageInputId = imageInputId;\nexports.fileFormId = fileFormId;\nexports.imageFormId = imageFormId;\nexports.onBlockTypeSelect = onBlockTypeSelect;\nexports.button = button;\nexports.maxAllowedFileSize = maxAllowedFileSize;\nexports.isInvalidFile = isInvalidFile;\nexports.isInvalidImageFile = isInvalidImageFile;\nexports.uploadFile = uploadFile;\nexports.submitForm = submitForm;\nexports.handleFileInputChange = handleFileInputChange;\nexports.uploadForm = uploadForm;\nexports.visible = visible;\nexports.updateEmbedUrl = updateEmbedUrl;\nexports.embedUrlRegexes = embedUrlRegexes;\nexports.validEmbedUrl = validEmbedUrl;\nexports.onEmbedFormSave = onEmbedFormSave;\nexports.topButton = topButton;\nexports.closeEmbedFormButton = closeEmbedFormButton;\nexports.toggleVisibilityButton = toggleVisibilityButton;\nexports.buttonAboveContentBlock = buttonAboveContentBlock;\nexports.make = make$2;\n/*  Not a pure module */\n"]},"metadata":{},"sourceType":"module"}