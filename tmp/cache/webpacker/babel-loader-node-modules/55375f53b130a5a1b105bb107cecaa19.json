{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\n\nvar Block = require(\"bs-platform/lib/js/block.js\");\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\n\nvar $$String = require(\"bs-platform/lib/js/string.js\");\n\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\n\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\n\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\n\nvar UserProxy = require(\"../../../shared/types/UserProxy.bs.js\");\n\nvar ArrayUtils = require(\"../../../shared/utils/ArrayUtils.bs.js\");\n\nvar Belt_Array = require(\"bs-platform/lib/js/belt_Array.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar OptionUtils = require(\"../../../shared/utils/OptionUtils.bs.js\");\n\nvar GraphqlQuery = require(\"../../../shared/utils/GraphqlQuery.bs.js\");\n\nvar LoadingSpinner = require(\"../../../shared/components/LoadingSpinner.bs.js\");\n\nvar SkeletonLoading = require(\"../../../shared/components/SkeletonLoading.bs.js\");\n\nvar ReasonReactRouter = require(\"reason-react/src/ReasonReactRouter.js\");\n\nvar MultiselectDropdown = require(\"../../../packages/multiselect-dropdown/src/components/MultiselectDropdown.bs.js\");\n\nvar CoursesStudents__Level = require(\"../types/CoursesStudents__Level.bs.js\");\n\nvar CoursesStudents__Teams = require(\"../types/CoursesStudents__Teams.bs.js\");\n\nvar CoursesStudents__Course = require(\"../types/CoursesStudents__Course.bs.js\");\n\nvar CoursesStudents__TeamInfo = require(\"../types/CoursesStudents__TeamInfo.bs.js\");\n\nvar CoursesStudents__TeamsList = require(\"./CoursesStudents__TeamsList.bs.js\");\n\nvar CoursesStudents__StudentOverlay = require(\"./CoursesStudents__StudentOverlay.bs.js\");\n\nvar CoursesStudents__StudentDistribution = require(\"./CoursesStudents__StudentDistribution.bs.js\");\n\nrequire(\"./CoursesStudents__Root.css\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    switch (action) {\n      case\n      /* DeselectLevel */\n      0:\n        var init = state.filter;\n        return {\n          loading: state.loading,\n          teams: state.teams,\n          filterString: state.filterString,\n          filter: {\n            nameOrEmail: init.nameOrEmail,\n            level: undefined,\n            coach: init.coach\n          }\n        };\n\n      case\n      /* DeselectCoach */\n      1:\n        var init$1 = state.filter;\n        return {\n          loading: state.loading,\n          teams: state.teams,\n          filterString: state.filterString,\n          filter: {\n            nameOrEmail: init$1.nameOrEmail,\n            level: init$1.level,\n            coach: undefined\n          }\n        };\n\n      case\n      /* UnsetNameOrEmail */\n      2:\n        var init$2 = state.filter;\n        return {\n          loading: state.loading,\n          teams: state.teams,\n          filterString: state.filterString,\n          filter: {\n            nameOrEmail: undefined,\n            level: init$2.level,\n            coach: init$2.coach\n          }\n        };\n\n      case\n      /* BeginLoadingMore */\n      3:\n        return {\n          loading:\n          /* LoadingMore */\n          2,\n          teams: state.teams,\n          filterString: state.filterString,\n          filter: state.filter\n        };\n\n      case\n      /* BeginReloading */\n      4:\n        return {\n          loading:\n          /* Reloading */\n          1,\n          teams: state.teams,\n          filterString: state.filterString,\n          filter: state.filter\n        };\n    }\n  } else {\n    switch (action.tag | 0) {\n      case\n      /* SelectLevel */\n      0:\n        var init$3 = state.filter;\n        return {\n          loading: state.loading,\n          teams: state.teams,\n          filterString: \"\",\n          filter: {\n            nameOrEmail: init$3.nameOrEmail,\n            level: action[0],\n            coach: init$3.coach\n          }\n        };\n\n      case\n      /* SelectCoach */\n      1:\n        var init$4 = state.filter;\n        return {\n          loading: state.loading,\n          teams: state.teams,\n          filterString: \"\",\n          filter: {\n            nameOrEmail: init$4.nameOrEmail,\n            level: init$4.level,\n            coach: action[0]\n          }\n        };\n\n      case\n      /* SetNameOrEmail */\n      2:\n        var init$5 = state.filter;\n        return {\n          loading: state.loading,\n          teams: state.teams,\n          filterString: \"\",\n          filter: {\n            nameOrEmail: action[0],\n            level: init$5.level,\n            coach: init$5.coach\n          }\n        };\n\n      case\n      /* UpdateFilterString */\n      3:\n        return {\n          loading: state.loading,\n          teams: state.teams,\n          filterString: action[0],\n          filter: state.filter\n        };\n\n      case\n      /* LoadTeams */\n      4:\n        var newTeams = action[2];\n        var endCursor = action[0];\n        var match = state.loading;\n        var updatedTeams = match >= 2 ? $$Array.append(CoursesStudents__Teams.toArray(state.teams), newTeams) : newTeams;\n        return {\n          loading:\n          /* NotLoading */\n          0,\n          teams: action[1] && endCursor !== undefined ?\n          /* PartiallyLoaded */\n          Block.__(0, [updatedTeams, endCursor]) :\n          /* FullyLoaded */\n          Block.__(1, [updatedTeams]),\n          filterString: state.filterString,\n          filter: state.filter\n        };\n    }\n  }\n}\n\nvar ppx_printed_query = \"query TeamsFromCoursesStudentsRootQuery($courseId: ID!, $levelId: ID, $coachId: ID, $search: String, $after: String)  {\\nteams(courseId: $courseId, levelId: $levelId, coachId: $coachId, search: $search, first: 10, after: $after)  {\\nnodes  {\\nid  \\nname  \\nlevelId  \\nstudents  {\\nid  \\nname  \\ntitle  \\navatarUrl  \\n}\\n\\ncoachUserIds  \\naccessEndsAt  \\ndroppedOutAt  \\n}\\n\\npageInfo  {\\nendCursor  \\nhasNextPage  \\n}\\n\\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"teams\");\n  var tmp;\n\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"nodes\");\n    var tmp$1;\n\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeNull(value$3);\n      tmp$1 = match$2 !== undefined ? undefined : Js_option.getExn(Js_json.decodeArray(value$3)).map(function (value) {\n        var match = Js_json.decodeNull(value);\n\n        if (match !== undefined) {\n          return;\n        } else {\n          var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n          var match$1 = Js_dict.get(value$1, \"id\");\n          var tmp;\n\n          if (match$1 !== undefined) {\n            var value$2 = Caml_option.valFromOption(match$1);\n            var match$2 = Js_json.decodeString(value$2);\n            tmp = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$2));\n          } else {\n            tmp = Js_exn.raiseError(\"graphql_ppx: Field id on type Team is missing\");\n          }\n\n          var match$3 = Js_dict.get(value$1, \"name\");\n          var tmp$1;\n\n          if (match$3 !== undefined) {\n            var value$3 = Caml_option.valFromOption(match$3);\n            var match$4 = Js_json.decodeString(value$3);\n            tmp$1 = match$4 !== undefined ? match$4 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$3));\n          } else {\n            tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field name on type Team is missing\");\n          }\n\n          var match$5 = Js_dict.get(value$1, \"levelId\");\n          var tmp$2;\n\n          if (match$5 !== undefined) {\n            var value$4 = Caml_option.valFromOption(match$5);\n            var match$6 = Js_json.decodeString(value$4);\n            tmp$2 = match$6 !== undefined ? match$6 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$4));\n          } else {\n            tmp$2 = Js_exn.raiseError(\"graphql_ppx: Field levelId on type Team is missing\");\n          }\n\n          var match$7 = Js_dict.get(value$1, \"students\");\n          var match$8 = Js_dict.get(value$1, \"coachUserIds\");\n          var match$9 = Js_dict.get(value$1, \"accessEndsAt\");\n          var tmp$3;\n\n          if (match$9 !== undefined) {\n            var value$5 = Caml_option.valFromOption(match$9);\n            var match$10 = Js_json.decodeNull(value$5);\n            tmp$3 = match$10 !== undefined ? undefined : Caml_option.some(value$5);\n          } else {\n            tmp$3 = undefined;\n          }\n\n          var match$11 = Js_dict.get(value$1, \"droppedOutAt\");\n          var tmp$4;\n\n          if (match$11 !== undefined) {\n            var value$6 = Caml_option.valFromOption(match$11);\n            var match$12 = Js_json.decodeNull(value$6);\n            tmp$4 = match$12 !== undefined ? undefined : Caml_option.some(value$6);\n          } else {\n            tmp$4 = undefined;\n          }\n\n          return {\n            id: tmp,\n            name: tmp$1,\n            levelId: tmp$2,\n            students: match$7 !== undefined ? Js_option.getExn(Js_json.decodeArray(Caml_option.valFromOption(match$7))).map(function (value) {\n              var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n              var match = Js_dict.get(value$1, \"id\");\n              var tmp;\n\n              if (match !== undefined) {\n                var value$2 = Caml_option.valFromOption(match);\n                var match$1 = Js_json.decodeString(value$2);\n                tmp = match$1 !== undefined ? match$1 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$2));\n              } else {\n                tmp = Js_exn.raiseError(\"graphql_ppx: Field id on type Student is missing\");\n              }\n\n              var match$2 = Js_dict.get(value$1, \"name\");\n              var tmp$1;\n\n              if (match$2 !== undefined) {\n                var value$3 = Caml_option.valFromOption(match$2);\n                var match$3 = Js_json.decodeString(value$3);\n                tmp$1 = match$3 !== undefined ? match$3 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$3));\n              } else {\n                tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field name on type Student is missing\");\n              }\n\n              var match$4 = Js_dict.get(value$1, \"title\");\n              var tmp$2;\n\n              if (match$4 !== undefined) {\n                var value$4 = Caml_option.valFromOption(match$4);\n                var match$5 = Js_json.decodeString(value$4);\n                tmp$2 = match$5 !== undefined ? match$5 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$4));\n              } else {\n                tmp$2 = Js_exn.raiseError(\"graphql_ppx: Field title on type Student is missing\");\n              }\n\n              var match$6 = Js_dict.get(value$1, \"avatarUrl\");\n              var tmp$3;\n\n              if (match$6 !== undefined) {\n                var value$5 = Caml_option.valFromOption(match$6);\n                var match$7 = Js_json.decodeNull(value$5);\n\n                if (match$7 !== undefined) {\n                  tmp$3 = undefined;\n                } else {\n                  var match$8 = Js_json.decodeString(value$5);\n                  tmp$3 = match$8 !== undefined ? match$8 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$5));\n                }\n              } else {\n                tmp$3 = undefined;\n              }\n\n              return {\n                id: tmp,\n                name: tmp$1,\n                title: tmp$2,\n                avatarUrl: tmp$3\n              };\n            }) : Js_exn.raiseError(\"graphql_ppx: Field students on type Team is missing\"),\n            coachUserIds: match$8 !== undefined ? Js_option.getExn(Js_json.decodeArray(Caml_option.valFromOption(match$8))).map(function (value) {\n              var match = Js_json.decodeString(value);\n\n              if (match !== undefined) {\n                return match;\n              } else {\n                return Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value));\n              }\n            }) : Js_exn.raiseError(\"graphql_ppx: Field coachUserIds on type Team is missing\"),\n            accessEndsAt: tmp$3,\n            droppedOutAt: tmp$4\n          };\n        }\n      });\n    } else {\n      tmp$1 = undefined;\n    }\n\n    var match$3 = Js_dict.get(value$2, \"pageInfo\");\n    var tmp$2;\n\n    if (match$3 !== undefined) {\n      var value$4 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match$3)));\n      var match$4 = Js_dict.get(value$4, \"endCursor\");\n      var tmp$3;\n\n      if (match$4 !== undefined) {\n        var value$5 = Caml_option.valFromOption(match$4);\n        var match$5 = Js_json.decodeNull(value$5);\n\n        if (match$5 !== undefined) {\n          tmp$3 = undefined;\n        } else {\n          var match$6 = Js_json.decodeString(value$5);\n          tmp$3 = match$6 !== undefined ? match$6 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$5));\n        }\n      } else {\n        tmp$3 = undefined;\n      }\n\n      var match$7 = Js_dict.get(value$4, \"hasNextPage\");\n      var tmp$4;\n\n      if (match$7 !== undefined) {\n        var value$6 = Caml_option.valFromOption(match$7);\n        var match$8 = Js_json.decodeBoolean(value$6);\n        tmp$4 = match$8 !== undefined ? match$8 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$6));\n      } else {\n        tmp$4 = Js_exn.raiseError(\"graphql_ppx: Field hasNextPage on type PageInfo is missing\");\n      }\n\n      tmp$2 = {\n        endCursor: tmp$3,\n        hasNextPage: tmp$4\n      };\n    } else {\n      tmp$2 = Js_exn.raiseError(\"graphql_ppx: Field pageInfo on type TeamConnection is missing\");\n    }\n\n    tmp = {\n      nodes: tmp$1,\n      pageInfo: tmp$2\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field teams on type Query is missing\");\n  }\n\n  return {\n    teams: tmp\n  };\n}\n\nfunction make(courseId, levelId, coachId, search, after, param) {\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"courseId\", courseId],\n    /* tuple */\n    [\"levelId\", levelId !== undefined ? levelId : null],\n    /* tuple */\n    [\"coachId\", coachId !== undefined ? coachId : null],\n    /* tuple */\n    [\"search\", search !== undefined ? search : null],\n    /* tuple */\n    [\"after\", after !== undefined ? after : null]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeWithVariables(variables) {\n  var courseId = variables.courseId;\n  var levelId = variables.levelId;\n  var coachId = variables.coachId;\n  var search = variables.search;\n  var after = variables.after;\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"courseId\", courseId],\n    /* tuple */\n    [\"levelId\", levelId !== undefined ? levelId : null],\n    /* tuple */\n    [\"coachId\", coachId !== undefined ? coachId : null],\n    /* tuple */\n    [\"search\", search !== undefined ? search : null],\n    /* tuple */\n    [\"after\", after !== undefined ? after : null]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeVariables(courseId, levelId, coachId, search, after, param) {\n  return Js_dict.fromArray([\n  /* tuple */\n  [\"courseId\", courseId],\n  /* tuple */\n  [\"levelId\", levelId !== undefined ? levelId : null],\n  /* tuple */\n  [\"coachId\", coachId !== undefined ? coachId : null],\n  /* tuple */\n  [\"search\", search !== undefined ? search : null],\n  /* tuple */\n  [\"after\", after !== undefined ? after : null]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  }));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, courseId, levelId, coachId, search, after, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n  /* tuple */\n  [\"courseId\", courseId],\n  /* tuple */\n  [\"levelId\", levelId !== undefined ? levelId : null],\n  /* tuple */\n  [\"coachId\", coachId !== undefined ? coachId : null],\n  /* tuple */\n  [\"search\", search !== undefined ? search : null],\n  /* tuple */\n  [\"after\", after !== undefined ? after : null]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  })));\n}\n\nvar definition =\n/* tuple */\n[parse, ppx_printed_query, definition_002];\n\nfunction ret_type(f) {\n  return {};\n}\n\nvar MT_Ret = {};\nvar TeamsQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction getTeams(send, courseId, cursor, filter) {\n  var levelId = OptionUtils.map(CoursesStudents__Level.id, filter.level);\n  var coachId = OptionUtils.map(UserProxy.id, filter.coach);\n  (function (eta) {\n    return GraphqlQuery.sendQuery(undefined, eta);\n  })(make(courseId, levelId, coachId, filter.nameOrEmail, cursor,\n  /* () */\n  0)).then(function (response) {\n    var match = response.teams.nodes;\n    var newTeams = match !== undefined ? CoursesStudents__TeamInfo.makeArrayFromJs(match) : [];\n\n    Curry._1(send,\n    /* LoadTeams */\n    Block.__(4, [response.teams.pageInfo.endCursor, response.teams.pageInfo.hasNextPage, newTeams]));\n\n    return Promise.resolve(\n    /* () */\n    0);\n  });\n  return (\n    /* () */\n    0\n  );\n}\n\nfunction applicableLevels(levels) {\n  return levels.filter(function (level) {\n    return CoursesStudents__Level.number(level) !== 0;\n  });\n}\n\nfunction label(t) {\n  switch (t.tag | 0) {\n    case\n    /* Level */\n    0:\n      return \"Level \" + String(CoursesStudents__Level.number(t[0]));\n\n    case\n    /* AssignedToCoach */\n    1:\n      return \"Assigned to\";\n\n    case\n    /* NameOrEmail */\n    2:\n      return \"Name or Email\";\n  }\n}\n\nfunction value(t) {\n  switch (t.tag | 0) {\n    case\n    /* Level */\n    0:\n      return CoursesStudents__Level.name(t[0]);\n\n    case\n    /* AssignedToCoach */\n    1:\n      var coach = t[0];\n\n      if (UserProxy.id(coach) === t[1]) {\n        return \"Me\";\n      } else {\n        return UserProxy.name(coach);\n      }\n\n    case\n    /* NameOrEmail */\n    2:\n      return t[0];\n  }\n}\n\nfunction searchString(t) {\n  switch (t.tag | 0) {\n    case\n    /* Level */\n    0:\n      var level = t[0];\n      return \"level \" + (String(CoursesStudents__Level.number(level)) + (\" \" + CoursesStudents__Level.name(level)));\n\n    case\n    /* AssignedToCoach */\n    1:\n      var coach = t[0];\n\n      if (UserProxy.id(coach) === t[1]) {\n        return UserProxy.name(coach) + \" assigned to me\";\n      } else {\n        return \"assigned to \" + UserProxy.name(coach);\n      }\n\n    case\n    /* NameOrEmail */\n    2:\n      return t[0];\n  }\n}\n\nfunction color(_t) {\n  return \"gray\";\n}\n\nfunction level(level$1) {\n  return (\n    /* Level */\n    Block.__(0, [level$1])\n  );\n}\n\nfunction assignedToCoach(coach, currentCoachId) {\n  return (\n    /* AssignedToCoach */\n    Block.__(1, [coach, currentCoachId])\n  );\n}\n\nfunction nameOrEmail(search) {\n  return (\n    /* NameOrEmail */\n    Block.__(2, [search])\n  );\n}\n\nvar Selectable = {\n  label: label,\n  value: value,\n  searchString: searchString,\n  color: color,\n  level: level,\n  assignedToCoach: assignedToCoach,\n  nameOrEmail: nameOrEmail\n};\nvar Multiselect = MultiselectDropdown.Make(Selectable);\n\nfunction unselected(levels, coaches, currentCoachId, state) {\n  var unselectedLevels = $$Array.map(level, levels.filter(function (level) {\n    return OptionUtils.mapWithDefault(function (selectedLevel) {\n      return CoursesStudents__Level.id(level) !== CoursesStudents__Level.id(selectedLevel);\n    }, true, state.filter.level);\n  }));\n  var unselectedCoaches = $$Array.map(function (coach) {\n    return (\n      /* AssignedToCoach */\n      Block.__(1, [coach, currentCoachId])\n    );\n  }, coaches.filter(function (coach) {\n    return OptionUtils.mapWithDefault(function (selectedCoach) {\n      return UserProxy.id(coach) !== UserProxy.id(selectedCoach);\n    }, true, state.filter.coach);\n  }));\n  var trimmedFilterString = $$String.trim(state.filterString);\n  var nameOrEmail = trimmedFilterString === \"\" ? [] : [\n  /* NameOrEmail */\n  Block.__(2, [trimmedFilterString])];\n  return $$Array.append(nameOrEmail, $$Array.append(unselectedCoaches, unselectedLevels));\n}\n\nfunction selected(state, currentCoachId) {\n  var selectedLevel = OptionUtils.mapWithDefault(function (selectedLevel) {\n    return [\n    /* Level */\n    Block.__(0, [selectedLevel])];\n  }, [], state.filter.level);\n  var selectedCoach = OptionUtils.mapWithDefault(function (selectedCoach) {\n    return [\n    /* AssignedToCoach */\n    Block.__(1, [selectedCoach, currentCoachId])];\n  }, [], state.filter.coach);\n  var selectedSearchString = OptionUtils.mapWithDefault(function (nameOrEmail) {\n    return [\n    /* NameOrEmail */\n    Block.__(2, [nameOrEmail])];\n  }, [], state.filter.nameOrEmail);\n  return $$Array.append(selectedSearchString, $$Array.append(selectedCoach, selectedLevel));\n}\n\nfunction onSelectFilter(send, selectable) {\n  switch (selectable.tag | 0) {\n    case\n    /* Level */\n    0:\n      return Curry._1(send,\n      /* SelectLevel */\n      Block.__(0, [selectable[0]]));\n\n    case\n    /* AssignedToCoach */\n    1:\n      return Curry._1(send,\n      /* SelectCoach */\n      Block.__(1, [selectable[0]]));\n\n    case\n    /* NameOrEmail */\n    2:\n      return Curry._1(send,\n      /* SetNameOrEmail */\n      Block.__(2, [selectable[0]]));\n  }\n}\n\nfunction onDeselectFilter(send, selectable) {\n  switch (selectable.tag | 0) {\n    case\n    /* Level */\n    0:\n      return Curry._1(send,\n      /* DeselectLevel */\n      0);\n\n    case\n    /* AssignedToCoach */\n    1:\n      return Curry._1(send,\n      /* DeselectCoach */\n      1);\n\n    case\n    /* NameOrEmail */\n    2:\n      return Curry._1(send,\n      /* UnsetNameOrEmail */\n      2);\n  }\n}\n\nfunction filterPlaceholder(state) {\n  var match = state.filter.level;\n  var match$1 = state.filter.coach;\n  var match$2 = state.filter.nameOrEmail;\n\n  if (match !== undefined || match$1 !== undefined || match$2 !== undefined) {\n    return \"\";\n  } else {\n    return \"Filter by level, assigned coach, or search by name or email address\";\n  }\n}\n\nfunction restoreFilterNotice(send, currentCoach, message) {\n  return React.createElement(\"div\", {\n    className: \"mt-2 text-sm italic flex flex-col md:flex-row items-center justify-between p-3 border border-gray-300 bg-white rounded-lg\"\n  }, React.createElement(\"span\", undefined, message), React.createElement(\"button\", {\n    className: \"px-2 py-1 rounded text-xs overflow-hidden border border-gray-300 bg-gray-200 text-gray-800 border-gray-300 bg-gray-200 hover:bg-gray-300 mt-1 md:mt-0\",\n    onClick: function onClick(param) {\n      return Curry._1(send,\n      /* SelectCoach */\n      Block.__(1, [currentCoach]));\n    }\n  }, \"Assigned to: Me\", React.createElement(\"i\", {\n    className: \"fas fa-level-up-alt ml-2\"\n  })));\n}\n\nfunction restoreAssignedToMeFilter(state, send, currentTeamCoach) {\n  return OptionUtils.mapWithDefault(function (currentCoach) {\n    var match = state.filter.coach;\n\n    if (match !== undefined) {\n      var selectedCoach = match;\n\n      if (UserProxy.id(selectedCoach) === UserProxy.id(currentCoach)) {\n        return null;\n      } else {\n        return restoreFilterNotice(send, currentCoach, \"Now showing students assigned to \" + (UserProxy.name(selectedCoach) + \".\"));\n      }\n    } else {\n      return restoreFilterNotice(send, currentCoach, \"Now showing all students in this course.\");\n    }\n  }, null, currentTeamCoach);\n}\n\nfunction computeInitialState(currentTeamCoach) {\n  return {\n    loading:\n    /* NotLoading */\n    0,\n    teams:\n    /* Unloaded */\n    0,\n    filterString: \"\",\n    filter: {\n      nameOrEmail: undefined,\n      level: undefined,\n      coach: currentTeamCoach\n    }\n  };\n}\n\nfunction selectLevel(levels, send, levelId) {\n  var level = ArrayUtils.unsafeFind(function (level) {\n    return CoursesStudents__Level.id(level) === levelId;\n  }, \"Could not find level selected from distribution bar, with ID \" + levelId, levels);\n  return Curry._1(send,\n  /* SelectLevel */\n  Block.__(0, [level]));\n}\n\nfunction CoursesStudents__Root(Props) {\n  var levels = Props.levels;\n  var course = Props.course;\n  var userId = Props.userId;\n  var teamCoaches = Props.teamCoaches;\n  var currentCoach = Props.currentCoach;\n  var match = React.useState(function () {\n    if (Belt_Array.some(teamCoaches, function (coach) {\n      return UserProxy.id(coach) === UserProxy.id(currentCoach);\n    })) {\n      return currentCoach;\n    }\n  });\n  var currentTeamCoach = match[0];\n  var match$1 = React.useReducer(reducer, currentTeamCoach, computeInitialState);\n  var send = match$1[1];\n  var state = match$1[0];\n  var courseId = CoursesStudents__Course.id(course);\n  var url = ReasonReactRouter.useUrl(undefined,\n  /* () */\n  0);\n  React.useEffect(function () {\n    Curry._1(send,\n    /* BeginReloading */\n    4);\n\n    getTeams(send, courseId, undefined, state.filter);\n    return;\n  }, [state.filter]);\n  var match$2 = url.path;\n  var tmp;\n\n  if (match$2 && match$2[0] === \"students\") {\n    var match$3 = match$2[1];\n\n    if (match$3) {\n      var match$4 = match$3[1];\n      tmp = match$4 && match$4[0] === \"report\" && !match$4[1] ? React.createElement(CoursesStudents__StudentOverlay.make, {\n        courseId: courseId,\n        studentId: match$3[0],\n        levels: levels,\n        userId: userId,\n        teamCoaches: teamCoaches\n      }) : null;\n    } else {\n      tmp = null;\n    }\n  } else {\n    tmp = null;\n  }\n\n  var match$5 = state.teams;\n  var tmp$1;\n\n  if (typeof match$5 === \"number\") {\n    tmp$1 = SkeletonLoading.multiple(10, SkeletonLoading.userCard(\n    /* () */\n    0));\n  } else if (match$5.tag) {\n    tmp$1 = React.createElement(CoursesStudents__TeamsList.make, {\n      levels: levels,\n      teams: match$5[0],\n      teamCoaches: teamCoaches\n    });\n  } else {\n    var cursor = match$5[1];\n    var match$6 = state.loading;\n    var tmp$2;\n\n    switch (match$6) {\n      case\n      /* NotLoading */\n      0:\n        tmp$2 = React.createElement(\"button\", {\n          className: \"btn btn-primary-ghost cursor-pointer w-full mt-4\",\n          onClick: function onClick(param) {\n            Curry._1(send,\n            /* BeginLoadingMore */\n            3);\n\n            return getTeams(send, courseId, cursor, state.filter);\n          }\n        }, \"Load More...\");\n        break;\n\n      case\n      /* Reloading */\n      1:\n        tmp$2 = null;\n        break;\n\n      case\n      /* LoadingMore */\n      2:\n        tmp$2 = SkeletonLoading.multiple(3, SkeletonLoading.card(undefined,\n        /* () */\n        0));\n        break;\n    }\n\n    tmp$1 = React.createElement(\"div\", undefined, React.createElement(CoursesStudents__TeamsList.make, {\n      levels: levels,\n      teams: match$5[0],\n      teamCoaches: teamCoaches\n    }), tmp$2);\n  }\n\n  var match$7 = state.teams;\n  var tmp$3;\n\n  if (typeof match$7 === \"number\") {\n    tmp$3 = null;\n  } else {\n    var match$8 = state.loading;\n    var loading = match$8 === 1;\n    tmp$3 = React.createElement(LoadingSpinner.make, {\n      loading: loading\n    });\n  }\n\n  return React.createElement(\"div\", undefined, tmp, React.createElement(\"div\", {\n    className: \"bg-gray-100 pt-8 pb-8 px-3 -mt-7\"\n  }, React.createElement(CoursesStudents__StudentDistribution.make, {\n    selectLevelCB: function selectLevelCB(param) {\n      return selectLevel(levels, send, param);\n    },\n    courseId: courseId,\n    filterCoach: state.filter.coach\n  }), React.createElement(\"div\", {\n    className: \"w-full py-4 bg-gray-100 relative md:sticky md:top-0 z-10\"\n  }, React.createElement(\"div\", {\n    className: \"max-w-3xl mx-auto bg-gray-100 sticky md:static md:top-0\"\n  }, React.createElement(Multiselect.make, {\n    id: \"filter\",\n    placeholder: filterPlaceholder(state),\n    onChange: function onChange(filterString) {\n      return Curry._1(send,\n      /* UpdateFilterString */\n      Block.__(3, [filterString]));\n    },\n    value: state.filterString,\n    unselected: unselected(levels, teamCoaches, UserProxy.id(currentCoach), state),\n    selected: selected(state, UserProxy.id(currentCoach)),\n    onSelect: function onSelect(param) {\n      return onSelectFilter(send, param);\n    },\n    onDeselect: function onDeselect(param) {\n      return onDeselectFilter(send, param);\n    }\n  }), restoreAssignedToMeFilter(state, send, currentTeamCoach))), React.createElement(\"div\", {\n    className: \" max-w-3xl mx-auto\"\n  }, tmp$1)), tmp$3);\n}\n\nvar make$1 = CoursesStudents__Root;\nexports.str = str;\nexports.reducer = reducer;\nexports.TeamsQuery = TeamsQuery;\nexports.getTeams = getTeams;\nexports.applicableLevels = applicableLevels;\nexports.Selectable = Selectable;\nexports.Multiselect = Multiselect;\nexports.unselected = unselected;\nexports.selected = selected;\nexports.onSelectFilter = onSelectFilter;\nexports.onDeselectFilter = onDeselectFilter;\nexports.filterPlaceholder = filterPlaceholder;\nexports.restoreFilterNotice = restoreFilterNotice;\nexports.restoreAssignedToMeFilter = restoreAssignedToMeFilter;\nexports.computeInitialState = computeInitialState;\nexports.selectLevel = selectLevel;\nexports.make = make$1;\n/*  Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/courses/students/components/CoursesStudents__Root.bs.js"],"names":["$$Array","require","Block","Curry","React","Js_exn","$$String","Js_dict","Js_json","Js_option","UserProxy","ArrayUtils","Belt_Array","Caml_option","OptionUtils","GraphqlQuery","LoadingSpinner","SkeletonLoading","ReasonReactRouter","MultiselectDropdown","CoursesStudents__Level","CoursesStudents__Teams","CoursesStudents__Course","CoursesStudents__TeamInfo","CoursesStudents__TeamsList","CoursesStudents__StudentOverlay","CoursesStudents__StudentDistribution","str","prim","reducer","state","action","init","filter","loading","teams","filterString","nameOrEmail","level","undefined","coach","init$1","init$2","tag","init$3","init$4","init$5","newTeams","endCursor","match","updatedTeams","append","toArray","__","ppx_printed_query","parse","value","value$1","getExn","decodeObject","get","tmp","value$2","valFromOption","match$1","tmp$1","value$3","match$2","decodeNull","decodeArray","map","decodeString","raiseError","JSON","stringify","match$3","match$4","match$5","tmp$2","value$4","match$6","match$7","match$8","match$9","tmp$3","value$5","match$10","some","match$11","tmp$4","value$6","match$12","id","name","levelId","students","title","avatarUrl","coachUserIds","accessEndsAt","droppedOutAt","decodeBoolean","hasNextPage","nodes","pageInfo","make","courseId","coachId","search","after","param","query","variables","fromArray","test","makeWithVariables","makeVariables","definition_002","graphql_ppx_use_json_variables_fn","_1","definition","ret_type","f","MT_Ret","TeamsQuery","getTeams","send","cursor","eta","sendQuery","then","response","makeArrayFromJs","Promise","resolve","applicableLevels","levels","number","label","t","String","searchString","color","_t","level$1","assignedToCoach","currentCoachId","Selectable","Multiselect","Make","unselected","coaches","unselectedLevels","mapWithDefault","selectedLevel","unselectedCoaches","selectedCoach","trimmedFilterString","trim","selected","selectedSearchString","onSelectFilter","selectable","onDeselectFilter","filterPlaceholder","restoreFilterNotice","currentCoach","message","createElement","className","onClick","restoreAssignedToMeFilter","currentTeamCoach","computeInitialState","selectLevel","unsafeFind","CoursesStudents__Root","Props","course","userId","teamCoaches","useState","useReducer","url","useUrl","useEffect","path","studentId","multiple","userCard","card","selectLevelCB","filterCoach","placeholder","onChange","onSelect","onDeselect","make$1","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\nvar Block = require(\"bs-platform/lib/js/block.js\");\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\nvar $$String = require(\"bs-platform/lib/js/string.js\");\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\nvar UserProxy = require(\"../../../shared/types/UserProxy.bs.js\");\nvar ArrayUtils = require(\"../../../shared/utils/ArrayUtils.bs.js\");\nvar Belt_Array = require(\"bs-platform/lib/js/belt_Array.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar OptionUtils = require(\"../../../shared/utils/OptionUtils.bs.js\");\nvar GraphqlQuery = require(\"../../../shared/utils/GraphqlQuery.bs.js\");\nvar LoadingSpinner = require(\"../../../shared/components/LoadingSpinner.bs.js\");\nvar SkeletonLoading = require(\"../../../shared/components/SkeletonLoading.bs.js\");\nvar ReasonReactRouter = require(\"reason-react/src/ReasonReactRouter.js\");\nvar MultiselectDropdown = require(\"../../../packages/multiselect-dropdown/src/components/MultiselectDropdown.bs.js\");\nvar CoursesStudents__Level = require(\"../types/CoursesStudents__Level.bs.js\");\nvar CoursesStudents__Teams = require(\"../types/CoursesStudents__Teams.bs.js\");\nvar CoursesStudents__Course = require(\"../types/CoursesStudents__Course.bs.js\");\nvar CoursesStudents__TeamInfo = require(\"../types/CoursesStudents__TeamInfo.bs.js\");\nvar CoursesStudents__TeamsList = require(\"./CoursesStudents__TeamsList.bs.js\");\nvar CoursesStudents__StudentOverlay = require(\"./CoursesStudents__StudentOverlay.bs.js\");\nvar CoursesStudents__StudentDistribution = require(\"./CoursesStudents__StudentDistribution.bs.js\");\n\n((require(\"./CoursesStudents__Root.css\")));\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    switch (action) {\n      case /* DeselectLevel */0 :\n          var init = state.filter;\n          return {\n                  loading: state.loading,\n                  teams: state.teams,\n                  filterString: state.filterString,\n                  filter: {\n                    nameOrEmail: init.nameOrEmail,\n                    level: undefined,\n                    coach: init.coach\n                  }\n                };\n      case /* DeselectCoach */1 :\n          var init$1 = state.filter;\n          return {\n                  loading: state.loading,\n                  teams: state.teams,\n                  filterString: state.filterString,\n                  filter: {\n                    nameOrEmail: init$1.nameOrEmail,\n                    level: init$1.level,\n                    coach: undefined\n                  }\n                };\n      case /* UnsetNameOrEmail */2 :\n          var init$2 = state.filter;\n          return {\n                  loading: state.loading,\n                  teams: state.teams,\n                  filterString: state.filterString,\n                  filter: {\n                    nameOrEmail: undefined,\n                    level: init$2.level,\n                    coach: init$2.coach\n                  }\n                };\n      case /* BeginLoadingMore */3 :\n          return {\n                  loading: /* LoadingMore */2,\n                  teams: state.teams,\n                  filterString: state.filterString,\n                  filter: state.filter\n                };\n      case /* BeginReloading */4 :\n          return {\n                  loading: /* Reloading */1,\n                  teams: state.teams,\n                  filterString: state.filterString,\n                  filter: state.filter\n                };\n      \n    }\n  } else {\n    switch (action.tag | 0) {\n      case /* SelectLevel */0 :\n          var init$3 = state.filter;\n          return {\n                  loading: state.loading,\n                  teams: state.teams,\n                  filterString: \"\",\n                  filter: {\n                    nameOrEmail: init$3.nameOrEmail,\n                    level: action[0],\n                    coach: init$3.coach\n                  }\n                };\n      case /* SelectCoach */1 :\n          var init$4 = state.filter;\n          return {\n                  loading: state.loading,\n                  teams: state.teams,\n                  filterString: \"\",\n                  filter: {\n                    nameOrEmail: init$4.nameOrEmail,\n                    level: init$4.level,\n                    coach: action[0]\n                  }\n                };\n      case /* SetNameOrEmail */2 :\n          var init$5 = state.filter;\n          return {\n                  loading: state.loading,\n                  teams: state.teams,\n                  filterString: \"\",\n                  filter: {\n                    nameOrEmail: action[0],\n                    level: init$5.level,\n                    coach: init$5.coach\n                  }\n                };\n      case /* UpdateFilterString */3 :\n          return {\n                  loading: state.loading,\n                  teams: state.teams,\n                  filterString: action[0],\n                  filter: state.filter\n                };\n      case /* LoadTeams */4 :\n          var newTeams = action[2];\n          var endCursor = action[0];\n          var match = state.loading;\n          var updatedTeams = match >= 2 ? $$Array.append(CoursesStudents__Teams.toArray(state.teams), newTeams) : newTeams;\n          return {\n                  loading: /* NotLoading */0,\n                  teams: action[1] && endCursor !== undefined ? /* PartiallyLoaded */Block.__(0, [\n                        updatedTeams,\n                        endCursor\n                      ]) : /* FullyLoaded */Block.__(1, [updatedTeams]),\n                  filterString: state.filterString,\n                  filter: state.filter\n                };\n      \n    }\n  }\n}\n\nvar ppx_printed_query = \"query TeamsFromCoursesStudentsRootQuery($courseId: ID!, $levelId: ID, $coachId: ID, $search: String, $after: String)  {\\nteams(courseId: $courseId, levelId: $levelId, coachId: $coachId, search: $search, first: 10, after: $after)  {\\nnodes  {\\nid  \\nname  \\nlevelId  \\nstudents  {\\nid  \\nname  \\ntitle  \\navatarUrl  \\n}\\n\\ncoachUserIds  \\naccessEndsAt  \\ndroppedOutAt  \\n}\\n\\npageInfo  {\\nendCursor  \\nhasNextPage  \\n}\\n\\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"teams\");\n  var tmp;\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"nodes\");\n    var tmp$1;\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeNull(value$3);\n      tmp$1 = match$2 !== undefined ? undefined : Js_option.getExn(Js_json.decodeArray(value$3)).map((function (value) {\n                var match = Js_json.decodeNull(value);\n                if (match !== undefined) {\n                  return ;\n                } else {\n                  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n                  var match$1 = Js_dict.get(value$1, \"id\");\n                  var tmp;\n                  if (match$1 !== undefined) {\n                    var value$2 = Caml_option.valFromOption(match$1);\n                    var match$2 = Js_json.decodeString(value$2);\n                    tmp = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$2));\n                  } else {\n                    tmp = Js_exn.raiseError(\"graphql_ppx: Field id on type Team is missing\");\n                  }\n                  var match$3 = Js_dict.get(value$1, \"name\");\n                  var tmp$1;\n                  if (match$3 !== undefined) {\n                    var value$3 = Caml_option.valFromOption(match$3);\n                    var match$4 = Js_json.decodeString(value$3);\n                    tmp$1 = match$4 !== undefined ? match$4 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$3));\n                  } else {\n                    tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field name on type Team is missing\");\n                  }\n                  var match$5 = Js_dict.get(value$1, \"levelId\");\n                  var tmp$2;\n                  if (match$5 !== undefined) {\n                    var value$4 = Caml_option.valFromOption(match$5);\n                    var match$6 = Js_json.decodeString(value$4);\n                    tmp$2 = match$6 !== undefined ? match$6 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$4));\n                  } else {\n                    tmp$2 = Js_exn.raiseError(\"graphql_ppx: Field levelId on type Team is missing\");\n                  }\n                  var match$7 = Js_dict.get(value$1, \"students\");\n                  var match$8 = Js_dict.get(value$1, \"coachUserIds\");\n                  var match$9 = Js_dict.get(value$1, \"accessEndsAt\");\n                  var tmp$3;\n                  if (match$9 !== undefined) {\n                    var value$5 = Caml_option.valFromOption(match$9);\n                    var match$10 = Js_json.decodeNull(value$5);\n                    tmp$3 = match$10 !== undefined ? undefined : Caml_option.some(value$5);\n                  } else {\n                    tmp$3 = undefined;\n                  }\n                  var match$11 = Js_dict.get(value$1, \"droppedOutAt\");\n                  var tmp$4;\n                  if (match$11 !== undefined) {\n                    var value$6 = Caml_option.valFromOption(match$11);\n                    var match$12 = Js_json.decodeNull(value$6);\n                    tmp$4 = match$12 !== undefined ? undefined : Caml_option.some(value$6);\n                  } else {\n                    tmp$4 = undefined;\n                  }\n                  return {\n                          id: tmp,\n                          name: tmp$1,\n                          levelId: tmp$2,\n                          students: match$7 !== undefined ? Js_option.getExn(Js_json.decodeArray(Caml_option.valFromOption(match$7))).map((function (value) {\n                                    var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n                                    var match = Js_dict.get(value$1, \"id\");\n                                    var tmp;\n                                    if (match !== undefined) {\n                                      var value$2 = Caml_option.valFromOption(match);\n                                      var match$1 = Js_json.decodeString(value$2);\n                                      tmp = match$1 !== undefined ? match$1 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$2));\n                                    } else {\n                                      tmp = Js_exn.raiseError(\"graphql_ppx: Field id on type Student is missing\");\n                                    }\n                                    var match$2 = Js_dict.get(value$1, \"name\");\n                                    var tmp$1;\n                                    if (match$2 !== undefined) {\n                                      var value$3 = Caml_option.valFromOption(match$2);\n                                      var match$3 = Js_json.decodeString(value$3);\n                                      tmp$1 = match$3 !== undefined ? match$3 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$3));\n                                    } else {\n                                      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field name on type Student is missing\");\n                                    }\n                                    var match$4 = Js_dict.get(value$1, \"title\");\n                                    var tmp$2;\n                                    if (match$4 !== undefined) {\n                                      var value$4 = Caml_option.valFromOption(match$4);\n                                      var match$5 = Js_json.decodeString(value$4);\n                                      tmp$2 = match$5 !== undefined ? match$5 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$4));\n                                    } else {\n                                      tmp$2 = Js_exn.raiseError(\"graphql_ppx: Field title on type Student is missing\");\n                                    }\n                                    var match$6 = Js_dict.get(value$1, \"avatarUrl\");\n                                    var tmp$3;\n                                    if (match$6 !== undefined) {\n                                      var value$5 = Caml_option.valFromOption(match$6);\n                                      var match$7 = Js_json.decodeNull(value$5);\n                                      if (match$7 !== undefined) {\n                                        tmp$3 = undefined;\n                                      } else {\n                                        var match$8 = Js_json.decodeString(value$5);\n                                        tmp$3 = match$8 !== undefined ? match$8 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$5));\n                                      }\n                                    } else {\n                                      tmp$3 = undefined;\n                                    }\n                                    return {\n                                            id: tmp,\n                                            name: tmp$1,\n                                            title: tmp$2,\n                                            avatarUrl: tmp$3\n                                          };\n                                  })) : Js_exn.raiseError(\"graphql_ppx: Field students on type Team is missing\"),\n                          coachUserIds: match$8 !== undefined ? Js_option.getExn(Js_json.decodeArray(Caml_option.valFromOption(match$8))).map((function (value) {\n                                    var match = Js_json.decodeString(value);\n                                    if (match !== undefined) {\n                                      return match;\n                                    } else {\n                                      return Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value));\n                                    }\n                                  })) : Js_exn.raiseError(\"graphql_ppx: Field coachUserIds on type Team is missing\"),\n                          accessEndsAt: tmp$3,\n                          droppedOutAt: tmp$4\n                        };\n                }\n              }));\n    } else {\n      tmp$1 = undefined;\n    }\n    var match$3 = Js_dict.get(value$2, \"pageInfo\");\n    var tmp$2;\n    if (match$3 !== undefined) {\n      var value$4 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match$3)));\n      var match$4 = Js_dict.get(value$4, \"endCursor\");\n      var tmp$3;\n      if (match$4 !== undefined) {\n        var value$5 = Caml_option.valFromOption(match$4);\n        var match$5 = Js_json.decodeNull(value$5);\n        if (match$5 !== undefined) {\n          tmp$3 = undefined;\n        } else {\n          var match$6 = Js_json.decodeString(value$5);\n          tmp$3 = match$6 !== undefined ? match$6 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$5));\n        }\n      } else {\n        tmp$3 = undefined;\n      }\n      var match$7 = Js_dict.get(value$4, \"hasNextPage\");\n      var tmp$4;\n      if (match$7 !== undefined) {\n        var value$6 = Caml_option.valFromOption(match$7);\n        var match$8 = Js_json.decodeBoolean(value$6);\n        tmp$4 = match$8 !== undefined ? match$8 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$6));\n      } else {\n        tmp$4 = Js_exn.raiseError(\"graphql_ppx: Field hasNextPage on type PageInfo is missing\");\n      }\n      tmp$2 = {\n        endCursor: tmp$3,\n        hasNextPage: tmp$4\n      };\n    } else {\n      tmp$2 = Js_exn.raiseError(\"graphql_ppx: Field pageInfo on type TeamConnection is missing\");\n    }\n    tmp = {\n      nodes: tmp$1,\n      pageInfo: tmp$2\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field teams on type Query is missing\");\n  }\n  return {\n          teams: tmp\n        };\n}\n\nfunction make(courseId, levelId, coachId, search, after, param) {\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"courseId\",\n                    courseId\n                  ],\n                  /* tuple */[\n                    \"levelId\",\n                    levelId !== undefined ? levelId : null\n                  ],\n                  /* tuple */[\n                    \"coachId\",\n                    coachId !== undefined ? coachId : null\n                  ],\n                  /* tuple */[\n                    \"search\",\n                    search !== undefined ? search : null\n                  ],\n                  /* tuple */[\n                    \"after\",\n                    after !== undefined ? after : null\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeWithVariables(variables) {\n  var courseId = variables.courseId;\n  var levelId = variables.levelId;\n  var coachId = variables.coachId;\n  var search = variables.search;\n  var after = variables.after;\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"courseId\",\n                    courseId\n                  ],\n                  /* tuple */[\n                    \"levelId\",\n                    levelId !== undefined ? levelId : null\n                  ],\n                  /* tuple */[\n                    \"coachId\",\n                    coachId !== undefined ? coachId : null\n                  ],\n                  /* tuple */[\n                    \"search\",\n                    search !== undefined ? search : null\n                  ],\n                  /* tuple */[\n                    \"after\",\n                    after !== undefined ? after : null\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeVariables(courseId, levelId, coachId, search, after, param) {\n  return Js_dict.fromArray([\n                /* tuple */[\n                  \"courseId\",\n                  courseId\n                ],\n                /* tuple */[\n                  \"levelId\",\n                  levelId !== undefined ? levelId : null\n                ],\n                /* tuple */[\n                  \"coachId\",\n                  coachId !== undefined ? coachId : null\n                ],\n                /* tuple */[\n                  \"search\",\n                  search !== undefined ? search : null\n                ],\n                /* tuple */[\n                  \"after\",\n                  after !== undefined ? after : null\n                ]\n              ].filter((function (param) {\n                    return !Js_json.test(param[1], /* Null */5);\n                  })));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, courseId, levelId, coachId, search, after, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n                    /* tuple */[\n                      \"courseId\",\n                      courseId\n                    ],\n                    /* tuple */[\n                      \"levelId\",\n                      levelId !== undefined ? levelId : null\n                    ],\n                    /* tuple */[\n                      \"coachId\",\n                      coachId !== undefined ? coachId : null\n                    ],\n                    /* tuple */[\n                      \"search\",\n                      search !== undefined ? search : null\n                    ],\n                    /* tuple */[\n                      \"after\",\n                      after !== undefined ? after : null\n                    ]\n                  ].filter((function (param) {\n                        return !Js_json.test(param[1], /* Null */5);\n                      }))));\n}\n\nvar definition = /* tuple */[\n  parse,\n  ppx_printed_query,\n  definition_002\n];\n\nfunction ret_type(f) {\n  return { };\n}\n\nvar MT_Ret = { };\n\nvar TeamsQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction getTeams(send, courseId, cursor, filter) {\n  var levelId = OptionUtils.map(CoursesStudents__Level.id, filter.level);\n  var coachId = OptionUtils.map(UserProxy.id, filter.coach);\n  (function (eta) {\n          return GraphqlQuery.sendQuery(undefined, eta);\n        })(make(courseId, levelId, coachId, filter.nameOrEmail, cursor, /* () */0)).then((function (response) {\n          var match = response.teams.nodes;\n          var newTeams = match !== undefined ? CoursesStudents__TeamInfo.makeArrayFromJs(match) : [];\n          Curry._1(send, /* LoadTeams */Block.__(4, [\n                  response.teams.pageInfo.endCursor,\n                  response.teams.pageInfo.hasNextPage,\n                  newTeams\n                ]));\n          return Promise.resolve(/* () */0);\n        }));\n  return /* () */0;\n}\n\nfunction applicableLevels(levels) {\n  return levels.filter((function (level) {\n                return CoursesStudents__Level.number(level) !== 0;\n              }));\n}\n\nfunction label(t) {\n  switch (t.tag | 0) {\n    case /* Level */0 :\n        return \"Level \" + String(CoursesStudents__Level.number(t[0]));\n    case /* AssignedToCoach */1 :\n        return \"Assigned to\";\n    case /* NameOrEmail */2 :\n        return \"Name or Email\";\n    \n  }\n}\n\nfunction value(t) {\n  switch (t.tag | 0) {\n    case /* Level */0 :\n        return CoursesStudents__Level.name(t[0]);\n    case /* AssignedToCoach */1 :\n        var coach = t[0];\n        if (UserProxy.id(coach) === t[1]) {\n          return \"Me\";\n        } else {\n          return UserProxy.name(coach);\n        }\n    case /* NameOrEmail */2 :\n        return t[0];\n    \n  }\n}\n\nfunction searchString(t) {\n  switch (t.tag | 0) {\n    case /* Level */0 :\n        var level = t[0];\n        return \"level \" + (String(CoursesStudents__Level.number(level)) + (\" \" + CoursesStudents__Level.name(level)));\n    case /* AssignedToCoach */1 :\n        var coach = t[0];\n        if (UserProxy.id(coach) === t[1]) {\n          return UserProxy.name(coach) + \" assigned to me\";\n        } else {\n          return \"assigned to \" + UserProxy.name(coach);\n        }\n    case /* NameOrEmail */2 :\n        return t[0];\n    \n  }\n}\n\nfunction color(_t) {\n  return \"gray\";\n}\n\nfunction level(level$1) {\n  return /* Level */Block.__(0, [level$1]);\n}\n\nfunction assignedToCoach(coach, currentCoachId) {\n  return /* AssignedToCoach */Block.__(1, [\n            coach,\n            currentCoachId\n          ]);\n}\n\nfunction nameOrEmail(search) {\n  return /* NameOrEmail */Block.__(2, [search]);\n}\n\nvar Selectable = {\n  label: label,\n  value: value,\n  searchString: searchString,\n  color: color,\n  level: level,\n  assignedToCoach: assignedToCoach,\n  nameOrEmail: nameOrEmail\n};\n\nvar Multiselect = MultiselectDropdown.Make(Selectable);\n\nfunction unselected(levels, coaches, currentCoachId, state) {\n  var unselectedLevels = $$Array.map(level, levels.filter((function (level) {\n              return OptionUtils.mapWithDefault((function (selectedLevel) {\n                            return CoursesStudents__Level.id(level) !== CoursesStudents__Level.id(selectedLevel);\n                          }), true, state.filter.level);\n            })));\n  var unselectedCoaches = $$Array.map((function (coach) {\n          return /* AssignedToCoach */Block.__(1, [\n                    coach,\n                    currentCoachId\n                  ]);\n        }), coaches.filter((function (coach) {\n              return OptionUtils.mapWithDefault((function (selectedCoach) {\n                            return UserProxy.id(coach) !== UserProxy.id(selectedCoach);\n                          }), true, state.filter.coach);\n            })));\n  var trimmedFilterString = $$String.trim(state.filterString);\n  var nameOrEmail = trimmedFilterString === \"\" ? [] : [/* NameOrEmail */Block.__(2, [trimmedFilterString])];\n  return $$Array.append(nameOrEmail, $$Array.append(unselectedCoaches, unselectedLevels));\n}\n\nfunction selected(state, currentCoachId) {\n  var selectedLevel = OptionUtils.mapWithDefault((function (selectedLevel) {\n          return [/* Level */Block.__(0, [selectedLevel])];\n        }), [], state.filter.level);\n  var selectedCoach = OptionUtils.mapWithDefault((function (selectedCoach) {\n          return [/* AssignedToCoach */Block.__(1, [\n                      selectedCoach,\n                      currentCoachId\n                    ])];\n        }), [], state.filter.coach);\n  var selectedSearchString = OptionUtils.mapWithDefault((function (nameOrEmail) {\n          return [/* NameOrEmail */Block.__(2, [nameOrEmail])];\n        }), [], state.filter.nameOrEmail);\n  return $$Array.append(selectedSearchString, $$Array.append(selectedCoach, selectedLevel));\n}\n\nfunction onSelectFilter(send, selectable) {\n  switch (selectable.tag | 0) {\n    case /* Level */0 :\n        return Curry._1(send, /* SelectLevel */Block.__(0, [selectable[0]]));\n    case /* AssignedToCoach */1 :\n        return Curry._1(send, /* SelectCoach */Block.__(1, [selectable[0]]));\n    case /* NameOrEmail */2 :\n        return Curry._1(send, /* SetNameOrEmail */Block.__(2, [selectable[0]]));\n    \n  }\n}\n\nfunction onDeselectFilter(send, selectable) {\n  switch (selectable.tag | 0) {\n    case /* Level */0 :\n        return Curry._1(send, /* DeselectLevel */0);\n    case /* AssignedToCoach */1 :\n        return Curry._1(send, /* DeselectCoach */1);\n    case /* NameOrEmail */2 :\n        return Curry._1(send, /* UnsetNameOrEmail */2);\n    \n  }\n}\n\nfunction filterPlaceholder(state) {\n  var match = state.filter.level;\n  var match$1 = state.filter.coach;\n  var match$2 = state.filter.nameOrEmail;\n  if (match !== undefined || match$1 !== undefined || match$2 !== undefined) {\n    return \"\";\n  } else {\n    return \"Filter by level, assigned coach, or search by name or email address\";\n  }\n}\n\nfunction restoreFilterNotice(send, currentCoach, message) {\n  return React.createElement(\"div\", {\n              className: \"mt-2 text-sm italic flex flex-col md:flex-row items-center justify-between p-3 border border-gray-300 bg-white rounded-lg\"\n            }, React.createElement(\"span\", undefined, message), React.createElement(\"button\", {\n                  className: \"px-2 py-1 rounded text-xs overflow-hidden border border-gray-300 bg-gray-200 text-gray-800 border-gray-300 bg-gray-200 hover:bg-gray-300 mt-1 md:mt-0\",\n                  onClick: (function (param) {\n                      return Curry._1(send, /* SelectCoach */Block.__(1, [currentCoach]));\n                    })\n                }, \"Assigned to: Me\", React.createElement(\"i\", {\n                      className: \"fas fa-level-up-alt ml-2\"\n                    })));\n}\n\nfunction restoreAssignedToMeFilter(state, send, currentTeamCoach) {\n  return OptionUtils.mapWithDefault((function (currentCoach) {\n                var match = state.filter.coach;\n                if (match !== undefined) {\n                  var selectedCoach = match;\n                  if (UserProxy.id(selectedCoach) === UserProxy.id(currentCoach)) {\n                    return null;\n                  } else {\n                    return restoreFilterNotice(send, currentCoach, \"Now showing students assigned to \" + (UserProxy.name(selectedCoach) + \".\"));\n                  }\n                } else {\n                  return restoreFilterNotice(send, currentCoach, \"Now showing all students in this course.\");\n                }\n              }), null, currentTeamCoach);\n}\n\nfunction computeInitialState(currentTeamCoach) {\n  return {\n          loading: /* NotLoading */0,\n          teams: /* Unloaded */0,\n          filterString: \"\",\n          filter: {\n            nameOrEmail: undefined,\n            level: undefined,\n            coach: currentTeamCoach\n          }\n        };\n}\n\nfunction selectLevel(levels, send, levelId) {\n  var level = ArrayUtils.unsafeFind((function (level) {\n          return CoursesStudents__Level.id(level) === levelId;\n        }), \"Could not find level selected from distribution bar, with ID \" + levelId, levels);\n  return Curry._1(send, /* SelectLevel */Block.__(0, [level]));\n}\n\nfunction CoursesStudents__Root(Props) {\n  var levels = Props.levels;\n  var course = Props.course;\n  var userId = Props.userId;\n  var teamCoaches = Props.teamCoaches;\n  var currentCoach = Props.currentCoach;\n  var match = React.useState((function () {\n          if (Belt_Array.some(teamCoaches, (function (coach) {\n                    return UserProxy.id(coach) === UserProxy.id(currentCoach);\n                  }))) {\n            return currentCoach;\n          }\n          \n        }));\n  var currentTeamCoach = match[0];\n  var match$1 = React.useReducer(reducer, currentTeamCoach, computeInitialState);\n  var send = match$1[1];\n  var state = match$1[0];\n  var courseId = CoursesStudents__Course.id(course);\n  var url = ReasonReactRouter.useUrl(undefined, /* () */0);\n  React.useEffect((function () {\n          Curry._1(send, /* BeginReloading */4);\n          getTeams(send, courseId, undefined, state.filter);\n          return ;\n        }), [state.filter]);\n  var match$2 = url.path;\n  var tmp;\n  if (match$2 && match$2[0] === \"students\") {\n    var match$3 = match$2[1];\n    if (match$3) {\n      var match$4 = match$3[1];\n      tmp = match$4 && match$4[0] === \"report\" && !match$4[1] ? React.createElement(CoursesStudents__StudentOverlay.make, {\n              courseId: courseId,\n              studentId: match$3[0],\n              levels: levels,\n              userId: userId,\n              teamCoaches: teamCoaches\n            }) : null;\n    } else {\n      tmp = null;\n    }\n  } else {\n    tmp = null;\n  }\n  var match$5 = state.teams;\n  var tmp$1;\n  if (typeof match$5 === \"number\") {\n    tmp$1 = SkeletonLoading.multiple(10, SkeletonLoading.userCard(/* () */0));\n  } else if (match$5.tag) {\n    tmp$1 = React.createElement(CoursesStudents__TeamsList.make, {\n          levels: levels,\n          teams: match$5[0],\n          teamCoaches: teamCoaches\n        });\n  } else {\n    var cursor = match$5[1];\n    var match$6 = state.loading;\n    var tmp$2;\n    switch (match$6) {\n      case /* NotLoading */0 :\n          tmp$2 = React.createElement(\"button\", {\n                className: \"btn btn-primary-ghost cursor-pointer w-full mt-4\",\n                onClick: (function (param) {\n                    Curry._1(send, /* BeginLoadingMore */3);\n                    return getTeams(send, courseId, cursor, state.filter);\n                  })\n              }, \"Load More...\");\n          break;\n      case /* Reloading */1 :\n          tmp$2 = null;\n          break;\n      case /* LoadingMore */2 :\n          tmp$2 = SkeletonLoading.multiple(3, SkeletonLoading.card(undefined, /* () */0));\n          break;\n      \n    }\n    tmp$1 = React.createElement(\"div\", undefined, React.createElement(CoursesStudents__TeamsList.make, {\n              levels: levels,\n              teams: match$5[0],\n              teamCoaches: teamCoaches\n            }), tmp$2);\n  }\n  var match$7 = state.teams;\n  var tmp$3;\n  if (typeof match$7 === \"number\") {\n    tmp$3 = null;\n  } else {\n    var match$8 = state.loading;\n    var loading = match$8 === 1;\n    tmp$3 = React.createElement(LoadingSpinner.make, {\n          loading: loading\n        });\n  }\n  return React.createElement(\"div\", undefined, tmp, React.createElement(\"div\", {\n                  className: \"bg-gray-100 pt-8 pb-8 px-3 -mt-7\"\n                }, React.createElement(CoursesStudents__StudentDistribution.make, {\n                      selectLevelCB: (function (param) {\n                          return selectLevel(levels, send, param);\n                        }),\n                      courseId: courseId,\n                      filterCoach: state.filter.coach\n                    }), React.createElement(\"div\", {\n                      className: \"w-full py-4 bg-gray-100 relative md:sticky md:top-0 z-10\"\n                    }, React.createElement(\"div\", {\n                          className: \"max-w-3xl mx-auto bg-gray-100 sticky md:static md:top-0\"\n                        }, React.createElement(Multiselect.make, {\n                              id: \"filter\",\n                              placeholder: filterPlaceholder(state),\n                              onChange: (function (filterString) {\n                                  return Curry._1(send, /* UpdateFilterString */Block.__(3, [filterString]));\n                                }),\n                              value: state.filterString,\n                              unselected: unselected(levels, teamCoaches, UserProxy.id(currentCoach), state),\n                              selected: selected(state, UserProxy.id(currentCoach)),\n                              onSelect: (function (param) {\n                                  return onSelectFilter(send, param);\n                                }),\n                              onDeselect: (function (param) {\n                                  return onDeselectFilter(send, param);\n                                })\n                            }), restoreAssignedToMeFilter(state, send, currentTeamCoach))), React.createElement(\"div\", {\n                      className: \" max-w-3xl mx-auto\"\n                    }, tmp$1)), tmp$3);\n}\n\nvar make$1 = CoursesStudents__Root;\n\nexports.str = str;\nexports.reducer = reducer;\nexports.TeamsQuery = TeamsQuery;\nexports.getTeams = getTeams;\nexports.applicableLevels = applicableLevels;\nexports.Selectable = Selectable;\nexports.Multiselect = Multiselect;\nexports.unselected = unselected;\nexports.selected = selected;\nexports.onSelectFilter = onSelectFilter;\nexports.onDeselectFilter = onDeselectFilter;\nexports.filterPlaceholder = filterPlaceholder;\nexports.restoreFilterNotice = restoreFilterNotice;\nexports.restoreAssignedToMeFilter = restoreAssignedToMeFilter;\nexports.computeInitialState = computeInitialState;\nexports.selectLevel = selectLevel;\nexports.make = make$1;\n/*  Not a pure module */\n"]},"metadata":{},"sourceType":"module"}