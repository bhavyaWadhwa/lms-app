{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../Api.bs.js\");\n\nvar Block = require(\"bs-platform/lib/js/block.js\");\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar FaIcon = require(\"./FaIcon.bs.js\");\n\nvar $$String = require(\"bs-platform/lib/js/string.js\");\n\nvar Caml_obj = require(\"bs-platform/lib/js/caml_obj.js\");\n\nvar DateTime = require(\"../utils/DateTime.bs.js\");\n\nvar Caml_array = require(\"bs-platform/lib/js/caml_array.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\n\nvar OptionUtils = require(\"../utils/OptionUtils.bs.js\");\n\nvar MarkdownBlock = require(\"./MarkdownBlock.bs.js\");\n\nvar DisablingCover = require(\"./DisablingCover.bs.js\");\n\nvar Caml_exceptions = require(\"bs-platform/lib/js/caml_exceptions.js\");\n\nvar TextareaAutosize = require(\"../utils/TextareaAutosize.bs.js\");\n\nvar AuthenticityToken = require(\"../utils/AuthenticityToken.bs.js\");\n\nvar Webapi__Dom__HtmlElement = require(\"bs-webapi/src/Webapi/Webapi__Dom/Webapi__Dom__HtmlElement.js\");\n\nvar InvalidModeForPreview = Caml_exceptions.create(\"MarkdownEditor.InvalidModeForPreview\");\n\nrequire(\"./MarkdownEditor.css\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    switch (action) {\n      case\n      /* ClickPreview */\n      0:\n        var match = state.mode;\n        var mode;\n        mode = match.tag ? match[0] >= 153880552 ?\n        /* Windowed */\n        Block.__(1, [\n        /* Editor */\n        -260983347]) :\n        /* Windowed */\n        Block.__(1, [\n        /* Preview */\n        153880552]) : match[0] !== 153880552 ?\n        /* Fullscreen */\n        Block.__(0, [\n        /* Preview */\n        153880552]) :\n        /* Fullscreen */\n        Block.__(0, [\n        /* Editor */\n        -260983347]);\n        return {\n          id: state.id,\n          mode: mode,\n          selection: state.selection,\n          uploadState: state.uploadState\n        };\n\n      case\n      /* ClickSplit */\n      1:\n        var match$1 = state.mode;\n        var mode$1;\n        mode$1 = match$1.tag || match$1[0] < 345791162 ?\n        /* Fullscreen */\n        Block.__(0, [\n        /* Split */\n        345791162]) :\n        /* Fullscreen */\n        Block.__(0, [\n        /* Editor */\n        -260983347]);\n        return {\n          id: state.id,\n          mode: mode$1,\n          selection: state.selection,\n          uploadState: state.uploadState\n        };\n\n      case\n      /* ClickFullscreen */\n      2:\n        var match$2 = state.mode;\n        var mode$2;\n        mode$2 = match$2.tag ? match$2[0] >= 153880552 ?\n        /* Fullscreen */\n        Block.__(0, [\n        /* Preview */\n        153880552]) :\n        /* Fullscreen */\n        Block.__(0, [\n        /* Editor */\n        -260983347]) : match$2[0] !== 153880552 ?\n        /* Windowed */\n        Block.__(1, [\n        /* Editor */\n        -260983347]) :\n        /* Windowed */\n        Block.__(1, [\n        /* Preview */\n        153880552]);\n        return {\n          id: state.id,\n          mode: mode$2,\n          selection: state.selection,\n          uploadState: state.uploadState\n        };\n\n      case\n      /* PressEscapeKey */\n      3:\n        var match$3 = state.mode;\n        var mode$3;\n\n        if (match$3.tag) {\n          mode$3 = match$3[0] >= 153880552 ?\n          /* Windowed */\n          Block.__(1, [\n          /* Preview */\n          153880552]) :\n          /* Windowed */\n          Block.__(1, [\n          /* Editor */\n          -260983347]);\n        } else {\n          var match$4 = match$3[0];\n          mode$3 = match$4 !== 153880552 ?\n          /* Windowed */\n          Block.__(1, [\n          /* Editor */\n          -260983347]) :\n          /* Windowed */\n          Block.__(1, [\n          /* Preview */\n          153880552]);\n        }\n\n        return {\n          id: state.id,\n          mode: mode$3,\n          selection: state.selection,\n          uploadState: state.uploadState\n        };\n\n      case\n      /* SetUploading */\n      4:\n        return {\n          id: state.id,\n          mode: state.mode,\n          selection: state.selection,\n          uploadState:\n          /* Uploading */\n          0\n        };\n\n      case\n      /* FinishUploading */\n      5:\n        return {\n          id: state.id,\n          mode: state.mode,\n          selection: state.selection,\n          uploadState:\n          /* ReadyToUpload */\n          [undefined]\n        };\n    }\n  } else {\n    switch (action.tag | 0) {\n      case\n      /* SetSelection */\n      0:\n        return {\n          id: state.id,\n          mode: state.mode,\n          selection: action[0],\n          uploadState: state.uploadState\n        };\n\n      case\n      /* BumpSelection */\n      1:\n        var offset = action[0];\n        var match$5 = state.selection;\n        return {\n          id: state.id,\n          mode: state.mode,\n          selection:\n          /* tuple */\n          [match$5[0] + offset | 0, match$5[1] + offset | 0],\n          uploadState: state.uploadState\n        };\n\n      case\n      /* SetUploadError */\n      2:\n        return {\n          id: state.id,\n          mode: state.mode,\n          selection: state.selection,\n          uploadState:\n          /* ReadyToUpload */\n          [action[0]]\n        };\n    }\n  }\n}\n\nfunction computeInitialState(param) {\n  var textareaId = param[1];\n  var id = textareaId !== undefined ? textareaId : DateTime.randomId(\n  /* () */\n  0);\n  var length = param[0].length;\n  return {\n    id: id,\n    mode: param[2],\n    selection:\n    /* tuple */\n    [length, length],\n    uploadState:\n    /* ReadyToUpload */\n    [undefined]\n  };\n}\n\nfunction containerClasses(mode) {\n  if (mode.tag) {\n    return \"relative bg-white\";\n  } else {\n    return \"bg-white fixed z-50 top-0 left-0 h-screen w-screen flex flex-col\";\n  }\n}\n\nfunction modeIcon(desiredMode, currentMode) {\n  var icon = desiredMode !== 153880552 ? desiredMode >= 345791162 ? currentMode.tag || currentMode[0] < 345791162 ? \"fas fa-columns\" : \"far fa-window-maximize\" : currentMode.tag ? \"fas fa-expand\" : \"fas fa-compress\" : currentMode.tag ? currentMode[0] >= 153880552 ? \"fas fa-pen-nib\" : \"fas fa-eye\" : currentMode[0] !== 153880552 ? \"fas fa-eye\" : \"fas fa-pen-nib\";\n  return React.createElement(FaIcon.make, {\n    classes: \"fa-fw \" + icon\n  });\n}\n\nfunction onClickFullscreen(state, send, _event) {\n  var match = state.mode;\n\n  if (match.tag) {\n    TextareaAutosize.destroy(state.id);\n  }\n\n  return Curry._1(send,\n  /* ClickFullscreen */\n  2);\n}\n\nfunction onClickPreview(state, send, _event) {\n  var match = state.mode;\n\n  if (match.tag && match[0] < 153880552) {\n    TextareaAutosize.destroy(state.id);\n  }\n\n  return Curry._1(send,\n  /* ClickPreview */\n  0);\n}\n\nfunction onClickSplit(state, send, _event) {\n  var match = state.mode;\n\n  if (match.tag) {\n    TextareaAutosize.destroy(state.id);\n  }\n\n  return Curry._1(send,\n  /* ClickSplit */\n  1);\n}\n\nfunction insertAt(textToInsert, position, sourceText) {\n  var head = $$String.sub(sourceText, 0, position);\n  var tail = $$String.sub(sourceText, position, sourceText.length - position | 0);\n  return head + (textToInsert + tail);\n}\n\nfunction wrapWith(wrapper, selectionStart, selectionEnd, sourceText) {\n  var head = $$String.sub(sourceText, 0, selectionStart);\n  var selection = $$String.sub(sourceText, selectionStart, selectionEnd - selectionStart | 0);\n  var tail = $$String.sub(sourceText, selectionEnd, sourceText.length - selectionEnd | 0);\n  return head + (wrapper + (selection + (wrapper + tail)));\n}\n\nfunction updateTextareaAfterDelay(state, cursorPosition) {\n  var match = state.mode;\n\n  if (match.tag) {\n    setTimeout(function (param) {\n      return TextareaAutosize.update(state.id);\n    }, 25);\n  }\n\n  var match$1 = document.getElementById(state.id);\n\n  if (match$1 == null) {\n    return (\n      /* () */\n      0\n    );\n  } else {\n    setTimeout(function (param) {\n      match$1.setSelectionRange(cursorPosition, cursorPosition);\n      return (\n        /* () */\n        0\n      );\n    }, 25);\n    return (\n      /* () */\n      0\n    );\n  }\n}\n\nfunction finalizeChange(oldValue, newValue, state, send, onChange) {\n  var offset = newValue.length - oldValue.length | 0;\n  var match = state.selection;\n\n  Curry._1(send,\n  /* BumpSelection */\n  Block.__(1, [offset / 2 | 0]));\n\n  Curry._1(onChange, newValue);\n\n  return updateTextareaAfterDelay(state, match[1] + offset | 0);\n}\n\nfunction insertAndWrapper(phraseModifer) {\n  switch (phraseModifer) {\n    case\n    /* Bold */\n    0:\n      return (\n        /* tuple */\n        [\"**bold**\", \"**\"]\n      );\n\n    case\n    /* Italic */\n    1:\n      return (\n        /* tuple */\n        [\"*italics*\", \"*\"]\n      );\n\n    case\n    /* Strikethrough */\n    2:\n      return (\n        /* tuple */\n        [\"~~strikethrough~~\", \"~~\"]\n      );\n  }\n}\n\nfunction modifyPhrase(oldValue, state, send, onChange, phraseModifer) {\n  var match = state.selection;\n  var selectionEnd = match[1];\n  var selectionStart = match[0];\n  var match$1 = insertAndWrapper(phraseModifer);\n  var newValue = selectionStart === selectionEnd ? insertAt(match$1[0], selectionStart, oldValue) : wrapWith(match$1[1], selectionStart, selectionEnd, oldValue);\n  return finalizeChange(oldValue, newValue, state, send, onChange);\n}\n\nfunction controlsContainerClasses(mode) {\n  var tmp;\n  tmp = mode.tag ? \"rounded-t border-gray-400 sticky top-0 z-20\" : \"border-gray-400 \";\n  return \"border bg-gray-100 text-sm px-2 flex justify-between items-end \" + tmp;\n}\n\nfunction controls(value, state, send, onChange) {\n  var buttonClasses = \"px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none \";\n  var mode = state.mode;\n\n  var curriedModifyPhrase = function curriedModifyPhrase(param) {\n    return modifyPhrase(value, state, send, onChange, param);\n  };\n\n  var tmp;\n  var exit = 0;\n\n  if (mode.tag) {\n    if (mode[0] >= 153880552) {\n      tmp = React.createElement(\"div\", undefined);\n    } else {\n      exit = 1;\n    }\n  } else if (mode[0] !== 153880552) {\n    exit = 1;\n  } else {\n    tmp = React.createElement(\"div\", undefined);\n  }\n\n  if (exit === 1) {\n    tmp = React.createElement(\"div\", {\n      className: \"bg-white border border-gray-400 rounded-t border-b-0\"\n    }, React.createElement(\"button\", {\n      className: buttonClasses,\n      onClick: function onClick(param) {\n        return curriedModifyPhrase(\n        /* Bold */\n        0);\n      }\n    }, React.createElement(\"i\", {\n      className: \"fas fa-bold fa-fw\"\n    })), React.createElement(\"button\", {\n      className: \"px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none border-l border-gray-400\",\n      onClick: function onClick(param) {\n        return curriedModifyPhrase(\n        /* Italic */\n        1);\n      }\n    }, React.createElement(\"i\", {\n      className: \"fas fa-italic fa-fw\"\n    })), React.createElement(\"button\", {\n      className: \"px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none border-l border-gray-400\",\n      onClick: function onClick(param) {\n        return curriedModifyPhrase(\n        /* Strikethrough */\n        2);\n      }\n    }, React.createElement(\"i\", {\n      className: \"fas fa-strikethrough fa-fw\"\n    })));\n  }\n\n  var tmp$1;\n  tmp$1 = mode.tag ? null : React.createElement(\"span\", {\n    className: \"ml-2 text-xs font-semibold\"\n  }, \"Exit full-screen\");\n  return React.createElement(\"div\", {\n    className: controlsContainerClasses(state.mode)\n  }, tmp, React.createElement(\"div\", {\n    className: \"py-1\"\n  }, React.createElement(\"button\", {\n    className: \"rounded px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none \",\n    onClick: function onClick(param) {\n      return onClickPreview(state, send, param);\n    }\n  }, modeIcon(\n  /* Preview */\n  153880552, mode)), React.createElement(\"button\", {\n    className: \"px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none rounded ml-1 hidden md:inline\",\n    onClick: function onClick(param) {\n      return onClickSplit(state, send, param);\n    }\n  }, modeIcon(\n  /* Split */\n  345791162, mode)), React.createElement(\"button\", {\n    className: \"px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none rounded  ml-1 hidden md:inline\",\n    onClick: function onClick(param) {\n      return onClickFullscreen(state, send, param);\n    }\n  }, modeIcon(\n  /* Fullscreen */\n  -261800357, mode), tmp$1)));\n}\n\nfunction modeClasses(mode) {\n  if (mode.tag) {\n    return \"\";\n  } else {\n    return \"flex flex-grow\";\n  }\n}\n\nfunction editorContainerClasses(mode) {\n  var tmp;\n\n  if (mode.tag) {\n    tmp = mode[0] >= 153880552 ? \"hidden\" : \"border-l\";\n  } else {\n    var match = mode[0];\n    tmp = match !== 153880552 ? match >= 345791162 ? \"w-1/2\" : \"w-full\" : \"hidden\";\n  }\n\n  return \"border-r border-gray-400 \" + tmp;\n}\n\nfunction previewType(mode) {\n  if (mode.tag) {\n    if (mode[0] >= 153880552) {\n      return (\n        /* WindowedPreview */\n        -12288167\n      );\n    } else {\n      throw InvalidModeForPreview;\n    }\n  } else {\n    var match = mode[0];\n\n    if (match !== 153880552) {\n      if (match >= 345791162) {\n        return (\n          /* FullscreenSplit */\n          418394751\n        );\n      } else {\n        throw InvalidModeForPreview;\n      }\n    } else {\n      return (\n        /* FullscreenPreview */\n        737745645\n      );\n    }\n  }\n}\n\nfunction previewContainerClasses(mode) {\n  var match = previewType(mode);\n  return \"border-gray-400 bg-gray-100 \" + (match !== 418394751 ? match >= 737745645 ? \"w-screen mx-auto\" : \"markdown-editor__windowed-preview-container border-l border-r border-b rounded-b px-2 md:px-3\" : \"w-1/2 relative\");\n}\n\nfunction previewClasses(mode) {\n  if (mode.tag || mode[0] < 153880552) {\n    return \"\";\n  } else {\n    return \"absolute max-h-full overflow-auto w-full px-4 pb-8\";\n  }\n}\n\nfunction focusOnEditor(id) {\n  return OptionUtils.mapWithDefault(function (element) {\n    element.focus();\n    return (\n      /* () */\n      0\n    );\n  },\n  /* () */\n  0, OptionUtils.flatMap(Webapi__Dom__HtmlElement.ofElement, Caml_option.nullable_to_opt(document.getElementById(id))));\n}\n\nfunction handleUploadFileResponse(oldValue, state, send, onChange, json) {\n  var errors = Json_decode.field(\"errors\", function (param) {\n    return Json_decode.array(Json_decode.string, param);\n  }, json);\n\n  if (Caml_obj.caml_equal(errors, [])) {\n    var markdownEmbedCode = Json_decode.field(\"markdownEmbedCode\", Json_decode.string, json);\n    var insert = \"\\n\" + (markdownEmbedCode + \"\\n\");\n    var match = state.selection;\n    var newValue = insertAt(insert, match[1], oldValue);\n    finalizeChange(oldValue, newValue, state, send, onChange);\n    return Curry._1(send,\n    /* FinishUploading */\n    5);\n  } else {\n    return Curry._1(send,\n    /* SetUploadError */\n    Block.__(2, [\"Failed to attach file! \" + errors.join(\", \")]));\n  }\n}\n\nfunction submitForm(formId, oldValue, state, send, onChange) {\n  return OptionUtils.mapWithDefault(function (element) {\n    var formData = new FormData(element);\n    return Api.sendFormData(\"/markdown_attachments/\", formData, function (param) {\n      return handleUploadFileResponse(oldValue, state, send, onChange, param);\n    }, function (param) {\n      return Curry._1(send,\n      /* SetUploadError */\n      Block.__(2, [\"An unexpected error occured! Please reload the page before trying again.\"]));\n    });\n  },\n  /* () */\n  0, Caml_option.nullable_to_opt(document.getElementById(formId)));\n}\n\nfunction attachFile(fileFormId, oldValue, state, send, onChange, $$event) {\n  var files = $$event.target.files;\n\n  if (files.length !== 0) {\n    var file = Caml_array.caml_array_get(files, 0);\n    var error = file.size > 5242880 ? \"The maximum file size is 5 MB. Please select another file.\" : undefined;\n\n    if (error !== undefined) {\n      return Curry._1(send,\n      /* SetUploadError */\n      Block.__(2, [error]));\n    } else {\n      Curry._1(send,\n      /* SetUploading */\n      4);\n\n      return submitForm(fileFormId, oldValue, state, send, onChange);\n    }\n  } else {\n    return (\n      /* () */\n      0\n    );\n  }\n}\n\nfunction footerContainerClasses(mode) {\n  var tmp;\n  tmp = mode.tag ? \"rounded-b border-gray-400\" : \"border-gray-400\";\n  return \"markdown-editor__footer-container border bg-gray-100 flex justify-between items-center \" + tmp;\n}\n\nfunction footer(oldValue, state, send, _onChange) {\n  var id = state.id;\n  var fileFormId = id + \"-file-form\";\n  var fileInputId = id + \"-file-input\";\n  var match = state.mode;\n\n  if (match.tag) {\n    if (match[0] >= 153880552) {\n      return null;\n    }\n  } else if (match[0] === 153880552) {\n    return null;\n  }\n\n  var match$1 = state.uploadState;\n  var tmp;\n\n  if (match$1) {\n    var error = match$1[0];\n    tmp = React.createElement(\"label\", {\n      className: \"text-xs px-3 py-2 flex-grow cursor-pointer\",\n      htmlFor: fileInputId\n    }, error !== undefined ? React.createElement(\"span\", {\n      className: \"text-red-500\"\n    }, React.createElement(\"i\", {\n      className: \"fas fa-exclamation-triangle mr-2\"\n    }), error) : React.createElement(\"span\", undefined, React.createElement(\"i\", {\n      className: \"far fa-file-image mr-2\"\n    }), \"Click here to attach a file.\"));\n  } else {\n    tmp = React.createElement(\"span\", {\n      className: \"text-xs px-3 py-2 flex-grow cursor-wait\"\n    }, React.createElement(\"i\", {\n      className: \"fas fa-spinner fa-pulse mr-2\"\n    }), \"Please wait for the file to upload...\");\n  }\n\n  return React.createElement(\"div\", {\n    className: footerContainerClasses(state.mode)\n  }, React.createElement(\"form\", {\n    className: \"flex items-center flex-wrap flex-1 text-sm font-semibold hover:bg-gray-300 hover:text-primary-500\",\n    id: fileFormId\n  }, React.createElement(\"input\", {\n    name: \"authenticity_token\",\n    type: \"hidden\",\n    value: AuthenticityToken.fromHead(\n    /* () */\n    0)\n  }), React.createElement(\"input\", {\n    className: \"hidden\",\n    id: fileInputId,\n    multiple: false,\n    name: \"markdown_attachment[file]\",\n    type: \"file\",\n    onChange: function onChange(param) {\n      return attachFile(fileFormId, oldValue, state, send, _onChange, param);\n    }\n  }), tmp), React.createElement(\"a\", {\n    className: \"flex items-center px-3 py-2 hover:bg-gray-300 hover:text-secondary-500 cursor-pointer\",\n    href: \"/help/markdown_editor\",\n    target: \"_blank\"\n  }, React.createElement(\"i\", {\n    className: \"fab fa-markdown text-sm\"\n  }), React.createElement(\"span\", {\n    className: \"text-xs ml-1 font-semibold hidden sm:inline\"\n  }, \"Need help?\")));\n}\n\nfunction textareaClasses(mode) {\n  var tmp;\n  tmp = mode.tag ? \"p-3\" : \"px-3 pt-4 pb-8 h-full resize-none\";\n  return \"w-full outline-none font-mono \" + tmp;\n}\n\nfunction onChangeWrapper(onChange, $$event) {\n  return Curry._1(onChange, $$event.target.value);\n}\n\nfunction _onSelect(send, $$event) {\n  var htmlInputElement = $$event.target;\n  var selection_000 = htmlInputElement.selectionStart;\n  var selection_001 = htmlInputElement.selectionEnd;\n  var selection =\n  /* tuple */\n  [selection_000, selection_001];\n  return Curry._1(send,\n  /* SetSelection */\n  Block.__(0, [selection]));\n}\n\nfunction handleEscapeKey(send, $$event) {\n  var _anyOtherKey = $$event.key;\n\n  if (_anyOtherKey === \"Escape\") {\n    return Curry._1(send,\n    /* PressEscapeKey */\n    3);\n  } else {\n    return (\n      /* () */\n      0\n    );\n  }\n}\n\nfunction handleKeyboardControls(value, state, send, onChange, $$event) {\n  var curriedModifyPhrase = function curriedModifyPhrase(param) {\n    return modifyPhrase(value, state, send, onChange, param);\n  };\n\n  var _anyOtherKey = $$event.key;\n\n  switch (_anyOtherKey) {\n    case \"b\":\n      if ($$event.ctrlKey || $$event.metaKey) {\n        return curriedModifyPhrase(\n        /* Bold */\n        0);\n      } else {\n        return (\n          /* () */\n          0\n        );\n      }\n\n    case \"i\":\n      if ($$event.ctrlKey || $$event.metaKey) {\n        return curriedModifyPhrase(\n        /* Italic */\n        1);\n      } else {\n        return (\n          /* () */\n          0\n        );\n      }\n\n    default:\n      return (\n        /* () */\n        0\n      );\n  }\n}\n\nfunction scrollTargetToSource(source, target, _event) {\n  var sourceScrollTop = source.scrollTop;\n  var sourceOffsetHeight = source.offsetHeight;\n  var sourceScrollHeight = source.scrollHeight;\n  var scrollFraction = sourceScrollTop / (sourceScrollHeight - sourceOffsetHeight | 0);\n  var maxTargetScrollTop = target.scrollHeight - target.offsetHeight | 0;\n  target.scrollTop = scrollFraction * maxTargetScrollTop;\n  return (\n    /* () */\n    0\n  );\n}\n\nvar ScrollSync = {\n  scrollTargetToSource: scrollTargetToSource\n};\n\nfunction MarkdownEditor(Props) {\n  var value = Props.value;\n  var _onChange2 = Props.onChange;\n  var profile = Props.profile;\n  var textareaId = Props.textareaId;\n  var maxLengthOpt = Props.maxLength;\n  var defaultModeOpt = Props.defaultMode;\n  var placeholder = Props.placeholder;\n  var tabIndex = Props.tabIndex;\n  var maxLength = maxLengthOpt !== undefined ? maxLengthOpt : 1000;\n  var defaultMode = defaultModeOpt !== undefined ? defaultModeOpt :\n  /* Windowed */\n  Block.__(1, [\n  /* Editor */\n  -260983347]);\n  var match = React.useReducer(reducer,\n  /* tuple */\n  [value, textareaId, defaultMode], computeInitialState);\n  var send = match[1];\n  var state = match[0];\n  React.useEffect(function () {\n    var match = state.mode;\n\n    if (match.tag && match[0] < 153880552) {\n      TextareaAutosize.create(state.id);\n    }\n\n    return function (param) {\n      return TextareaAutosize.destroy(state.id);\n    };\n  }, [state.mode]);\n  React.useEffect(function () {\n    var curriedHandler = function curriedHandler(param) {\n      return handleEscapeKey(send, param);\n    };\n\n    var documentEventTarget = document;\n    documentEventTarget.addEventListener(\"keydown\", curriedHandler);\n    return function (param) {\n      documentEventTarget.removeEventListener(\"keydown\", curriedHandler);\n      return (\n        /* () */\n        0\n      );\n    };\n  }, []);\n  React.useEffect(function () {\n    var curriedHandler = function curriedHandler(param) {\n      return handleKeyboardControls(value, state, send, _onChange2, param);\n    };\n\n    var textareaEventTarget = OptionUtils.map(function (prim) {\n      return prim;\n    }, Caml_option.nullable_to_opt(document.getElementById(state.id)));\n    OptionUtils.mapWithDefault(function (param) {\n      param.addEventListener(\"keydown\", curriedHandler);\n      return (\n        /* () */\n        0\n      );\n    },\n    /* () */\n    0, textareaEventTarget);\n    return function (param) {\n      return OptionUtils.mapWithDefault(function (param) {\n        param.removeEventListener(\"keydown\", curriedHandler);\n        return (\n          /* () */\n          0\n        );\n      },\n      /* () */\n      0, textareaEventTarget);\n    };\n  });\n  React.useEffect(function () {\n    var textarea = document.getElementById(state.id);\n    var preview = document.getElementById(state.id + \"-preview\");\n\n    if (textarea == null || preview == null) {\n      return;\n    } else {\n      var scrollCallback = function scrollCallback(param) {\n        return scrollTargetToSource(textarea, preview, param);\n      };\n\n      var _anyOtherMode = state.mode;\n\n      if (_anyOtherMode.tag) {\n        textarea.removeEventListener(\"scroll\", scrollCallback);\n        return;\n      } else if (_anyOtherMode[0] !== 345791162) {\n        textarea.removeEventListener(\"scroll\", scrollCallback);\n        return;\n      } else {\n        textarea.addEventListener(\"scroll\", scrollCallback);\n        return function (param) {\n          textarea.removeEventListener(\"scroll\", scrollCallback);\n          return (\n            /* () */\n            0\n          );\n        };\n      }\n    }\n  }, [state.mode]);\n  var tmp = {\n    \"aria-label\": \"Markdown editor\",\n    className: textareaClasses(state.mode),\n    id: state.id,\n    maxLength: maxLength,\n    rows: 4,\n    value: value,\n    onChange: function onChange(param) {\n      return Curry._1(_onChange2, param.target.value);\n    },\n    onSelect: function onSelect(param) {\n      return _onSelect(send, param);\n    }\n  };\n\n  if (tabIndex !== undefined) {\n    tmp.tabIndex = Caml_option.valFromOption(tabIndex);\n  }\n\n  if (placeholder !== undefined) {\n    tmp.placeholder = Caml_option.valFromOption(placeholder);\n  }\n\n  var match$1 = state.mode;\n  return React.createElement(\"div\", {\n    className: containerClasses(state.mode)\n  }, controls(value, state, send, _onChange2), React.createElement(\"div\", {\n    className: modeClasses(state.mode)\n  }, React.createElement(\"div\", {\n    className: editorContainerClasses(state.mode)\n  }, React.createElement(DisablingCover.make, {\n    disabled: state.uploadState ===\n    /* Uploading */\n    0,\n    message: \"Uploading...\",\n    containerClasses: \"h-full\",\n    children: React.createElement(\"textarea\", tmp)\n  })), match$1[0] >= 153880552 ? React.createElement(\"div\", {\n    className: previewContainerClasses(state.mode)\n  }, React.createElement(\"div\", {\n    className: previewClasses(state.mode),\n    id: state.id + \"-preview\"\n  }, React.createElement(MarkdownBlock.make, {\n    markdown: value,\n    className: \"max-w-3xl mx-auto\",\n    profile: profile\n  }))) : null), footer(value, state, send, _onChange2));\n}\n\nvar make = MarkdownEditor;\nexports.InvalidModeForPreview = InvalidModeForPreview;\nexports.str = str;\nexports.reducer = reducer;\nexports.computeInitialState = computeInitialState;\nexports.containerClasses = containerClasses;\nexports.modeIcon = modeIcon;\nexports.onClickFullscreen = onClickFullscreen;\nexports.onClickPreview = onClickPreview;\nexports.onClickSplit = onClickSplit;\nexports.insertAt = insertAt;\nexports.wrapWith = wrapWith;\nexports.updateTextareaAfterDelay = updateTextareaAfterDelay;\nexports.finalizeChange = finalizeChange;\nexports.insertAndWrapper = insertAndWrapper;\nexports.modifyPhrase = modifyPhrase;\nexports.controlsContainerClasses = controlsContainerClasses;\nexports.controls = controls;\nexports.modeClasses = modeClasses;\nexports.editorContainerClasses = editorContainerClasses;\nexports.previewType = previewType;\nexports.previewContainerClasses = previewContainerClasses;\nexports.previewClasses = previewClasses;\nexports.focusOnEditor = focusOnEditor;\nexports.handleUploadFileResponse = handleUploadFileResponse;\nexports.submitForm = submitForm;\nexports.attachFile = attachFile;\nexports.footerContainerClasses = footerContainerClasses;\nexports.footer = footer;\nexports.textareaClasses = textareaClasses;\nexports.onChangeWrapper = onChangeWrapper;\nexports.onSelect = _onSelect;\nexports.handleEscapeKey = handleEscapeKey;\nexports.handleKeyboardControls = handleKeyboardControls;\nexports.ScrollSync = ScrollSync;\nexports.make = make;\n/*  Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/shared/components/MarkdownEditor.bs.js"],"names":["Api","require","Block","Curry","React","FaIcon","$$String","Caml_obj","DateTime","Caml_array","Caml_option","Json_decode","OptionUtils","MarkdownBlock","DisablingCover","Caml_exceptions","TextareaAutosize","AuthenticityToken","Webapi__Dom__HtmlElement","InvalidModeForPreview","create","str","prim","reducer","state","action","match","mode","tag","__","id","selection","uploadState","match$1","mode$1","match$2","mode$2","match$3","mode$3","match$4","undefined","offset","match$5","computeInitialState","param","textareaId","randomId","length","containerClasses","modeIcon","desiredMode","currentMode","icon","createElement","make","classes","onClickFullscreen","send","_event","destroy","_1","onClickPreview","onClickSplit","insertAt","textToInsert","position","sourceText","head","sub","tail","wrapWith","wrapper","selectionStart","selectionEnd","updateTextareaAfterDelay","cursorPosition","setTimeout","update","document","getElementById","setSelectionRange","finalizeChange","oldValue","newValue","onChange","insertAndWrapper","phraseModifer","modifyPhrase","controlsContainerClasses","tmp","controls","value","buttonClasses","curriedModifyPhrase","exit","className","onClick","tmp$1","modeClasses","editorContainerClasses","previewType","previewContainerClasses","previewClasses","focusOnEditor","mapWithDefault","element","focus","flatMap","ofElement","nullable_to_opt","handleUploadFileResponse","json","errors","field","array","string","caml_equal","markdownEmbedCode","insert","join","submitForm","formId","formData","FormData","sendFormData","attachFile","fileFormId","$$event","files","target","file","caml_array_get","error","size","footerContainerClasses","footer","fileInputId","htmlFor","name","type","fromHead","multiple","href","textareaClasses","onChangeWrapper","onSelect","htmlInputElement","selection_000","selection_001","handleEscapeKey","_anyOtherKey","key","handleKeyboardControls","ctrlKey","metaKey","scrollTargetToSource","source","sourceScrollTop","scrollTop","sourceOffsetHeight","offsetHeight","sourceScrollHeight","scrollHeight","scrollFraction","maxTargetScrollTop","ScrollSync","MarkdownEditor","Props","profile","maxLengthOpt","maxLength","defaultModeOpt","defaultMode","placeholder","tabIndex","useReducer","useEffect","curriedHandler","documentEventTarget","addEventListener","removeEventListener","textareaEventTarget","map","textarea","preview","scrollCallback","_anyOtherMode","rows","valFromOption","disabled","message","children","markdown","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../Api.bs.js\");\nvar Block = require(\"bs-platform/lib/js/block.js\");\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar FaIcon = require(\"./FaIcon.bs.js\");\nvar $$String = require(\"bs-platform/lib/js/string.js\");\nvar Caml_obj = require(\"bs-platform/lib/js/caml_obj.js\");\nvar DateTime = require(\"../utils/DateTime.bs.js\");\nvar Caml_array = require(\"bs-platform/lib/js/caml_array.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\nvar OptionUtils = require(\"../utils/OptionUtils.bs.js\");\nvar MarkdownBlock = require(\"./MarkdownBlock.bs.js\");\nvar DisablingCover = require(\"./DisablingCover.bs.js\");\nvar Caml_exceptions = require(\"bs-platform/lib/js/caml_exceptions.js\");\nvar TextareaAutosize = require(\"../utils/TextareaAutosize.bs.js\");\nvar AuthenticityToken = require(\"../utils/AuthenticityToken.bs.js\");\nvar Webapi__Dom__HtmlElement = require(\"bs-webapi/src/Webapi/Webapi__Dom/Webapi__Dom__HtmlElement.js\");\n\nvar InvalidModeForPreview = Caml_exceptions.create(\"MarkdownEditor.InvalidModeForPreview\");\n\n((require(\"./MarkdownEditor.css\")));\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    switch (action) {\n      case /* ClickPreview */0 :\n          var match = state.mode;\n          var mode;\n          mode = match.tag ? (\n              match[0] >= 153880552 ? /* Windowed */Block.__(1, [/* Editor */-260983347]) : /* Windowed */Block.__(1, [/* Preview */153880552])\n            ) : (\n              match[0] !== 153880552 ? /* Fullscreen */Block.__(0, [/* Preview */153880552]) : /* Fullscreen */Block.__(0, [/* Editor */-260983347])\n            );\n          return {\n                  id: state.id,\n                  mode: mode,\n                  selection: state.selection,\n                  uploadState: state.uploadState\n                };\n      case /* ClickSplit */1 :\n          var match$1 = state.mode;\n          var mode$1;\n          mode$1 = match$1.tag || match$1[0] < 345791162 ? /* Fullscreen */Block.__(0, [/* Split */345791162]) : /* Fullscreen */Block.__(0, [/* Editor */-260983347]);\n          return {\n                  id: state.id,\n                  mode: mode$1,\n                  selection: state.selection,\n                  uploadState: state.uploadState\n                };\n      case /* ClickFullscreen */2 :\n          var match$2 = state.mode;\n          var mode$2;\n          mode$2 = match$2.tag ? (\n              match$2[0] >= 153880552 ? /* Fullscreen */Block.__(0, [/* Preview */153880552]) : /* Fullscreen */Block.__(0, [/* Editor */-260983347])\n            ) : (\n              match$2[0] !== 153880552 ? /* Windowed */Block.__(1, [/* Editor */-260983347]) : /* Windowed */Block.__(1, [/* Preview */153880552])\n            );\n          return {\n                  id: state.id,\n                  mode: mode$2,\n                  selection: state.selection,\n                  uploadState: state.uploadState\n                };\n      case /* PressEscapeKey */3 :\n          var match$3 = state.mode;\n          var mode$3;\n          if (match$3.tag) {\n            mode$3 = match$3[0] >= 153880552 ? /* Windowed */Block.__(1, [/* Preview */153880552]) : /* Windowed */Block.__(1, [/* Editor */-260983347]);\n          } else {\n            var match$4 = match$3[0];\n            mode$3 = match$4 !== 153880552 ? /* Windowed */Block.__(1, [/* Editor */-260983347]) : /* Windowed */Block.__(1, [/* Preview */153880552]);\n          }\n          return {\n                  id: state.id,\n                  mode: mode$3,\n                  selection: state.selection,\n                  uploadState: state.uploadState\n                };\n      case /* SetUploading */4 :\n          return {\n                  id: state.id,\n                  mode: state.mode,\n                  selection: state.selection,\n                  uploadState: /* Uploading */0\n                };\n      case /* FinishUploading */5 :\n          return {\n                  id: state.id,\n                  mode: state.mode,\n                  selection: state.selection,\n                  uploadState: /* ReadyToUpload */[undefined]\n                };\n      \n    }\n  } else {\n    switch (action.tag | 0) {\n      case /* SetSelection */0 :\n          return {\n                  id: state.id,\n                  mode: state.mode,\n                  selection: action[0],\n                  uploadState: state.uploadState\n                };\n      case /* BumpSelection */1 :\n          var offset = action[0];\n          var match$5 = state.selection;\n          return {\n                  id: state.id,\n                  mode: state.mode,\n                  selection: /* tuple */[\n                    match$5[0] + offset | 0,\n                    match$5[1] + offset | 0\n                  ],\n                  uploadState: state.uploadState\n                };\n      case /* SetUploadError */2 :\n          return {\n                  id: state.id,\n                  mode: state.mode,\n                  selection: state.selection,\n                  uploadState: /* ReadyToUpload */[action[0]]\n                };\n      \n    }\n  }\n}\n\nfunction computeInitialState(param) {\n  var textareaId = param[1];\n  var id = textareaId !== undefined ? textareaId : DateTime.randomId(/* () */0);\n  var length = param[0].length;\n  return {\n          id: id,\n          mode: param[2],\n          selection: /* tuple */[\n            length,\n            length\n          ],\n          uploadState: /* ReadyToUpload */[undefined]\n        };\n}\n\nfunction containerClasses(mode) {\n  if (mode.tag) {\n    return \"relative bg-white\";\n  } else {\n    return \"bg-white fixed z-50 top-0 left-0 h-screen w-screen flex flex-col\";\n  }\n}\n\nfunction modeIcon(desiredMode, currentMode) {\n  var icon = desiredMode !== 153880552 ? (\n      desiredMode >= 345791162 ? (\n          currentMode.tag || currentMode[0] < 345791162 ? \"fas fa-columns\" : \"far fa-window-maximize\"\n        ) : (\n          currentMode.tag ? \"fas fa-expand\" : \"fas fa-compress\"\n        )\n    ) : (\n      currentMode.tag ? (\n          currentMode[0] >= 153880552 ? \"fas fa-pen-nib\" : \"fas fa-eye\"\n        ) : (\n          currentMode[0] !== 153880552 ? \"fas fa-eye\" : \"fas fa-pen-nib\"\n        )\n    );\n  return React.createElement(FaIcon.make, {\n              classes: \"fa-fw \" + icon\n            });\n}\n\nfunction onClickFullscreen(state, send, _event) {\n  var match = state.mode;\n  if (match.tag) {\n    TextareaAutosize.destroy(state.id);\n  }\n  return Curry._1(send, /* ClickFullscreen */2);\n}\n\nfunction onClickPreview(state, send, _event) {\n  var match = state.mode;\n  if (match.tag && match[0] < 153880552) {\n    TextareaAutosize.destroy(state.id);\n  }\n  return Curry._1(send, /* ClickPreview */0);\n}\n\nfunction onClickSplit(state, send, _event) {\n  var match = state.mode;\n  if (match.tag) {\n    TextareaAutosize.destroy(state.id);\n  }\n  return Curry._1(send, /* ClickSplit */1);\n}\n\nfunction insertAt(textToInsert, position, sourceText) {\n  var head = $$String.sub(sourceText, 0, position);\n  var tail = $$String.sub(sourceText, position, sourceText.length - position | 0);\n  return head + (textToInsert + tail);\n}\n\nfunction wrapWith(wrapper, selectionStart, selectionEnd, sourceText) {\n  var head = $$String.sub(sourceText, 0, selectionStart);\n  var selection = $$String.sub(sourceText, selectionStart, selectionEnd - selectionStart | 0);\n  var tail = $$String.sub(sourceText, selectionEnd, sourceText.length - selectionEnd | 0);\n  return head + (wrapper + (selection + (wrapper + tail)));\n}\n\nfunction updateTextareaAfterDelay(state, cursorPosition) {\n  var match = state.mode;\n  if (match.tag) {\n    setTimeout((function (param) {\n            return TextareaAutosize.update(state.id);\n          }), 25);\n  }\n  var match$1 = document.getElementById(state.id);\n  if (match$1 == null) {\n    return /* () */0;\n  } else {\n    setTimeout((function (param) {\n            match$1.setSelectionRange(cursorPosition, cursorPosition);\n            return /* () */0;\n          }), 25);\n    return /* () */0;\n  }\n}\n\nfunction finalizeChange(oldValue, newValue, state, send, onChange) {\n  var offset = newValue.length - oldValue.length | 0;\n  var match = state.selection;\n  Curry._1(send, /* BumpSelection */Block.__(1, [offset / 2 | 0]));\n  Curry._1(onChange, newValue);\n  return updateTextareaAfterDelay(state, match[1] + offset | 0);\n}\n\nfunction insertAndWrapper(phraseModifer) {\n  switch (phraseModifer) {\n    case /* Bold */0 :\n        return /* tuple */[\n                \"**bold**\",\n                \"**\"\n              ];\n    case /* Italic */1 :\n        return /* tuple */[\n                \"*italics*\",\n                \"*\"\n              ];\n    case /* Strikethrough */2 :\n        return /* tuple */[\n                \"~~strikethrough~~\",\n                \"~~\"\n              ];\n    \n  }\n}\n\nfunction modifyPhrase(oldValue, state, send, onChange, phraseModifer) {\n  var match = state.selection;\n  var selectionEnd = match[1];\n  var selectionStart = match[0];\n  var match$1 = insertAndWrapper(phraseModifer);\n  var newValue = selectionStart === selectionEnd ? insertAt(match$1[0], selectionStart, oldValue) : wrapWith(match$1[1], selectionStart, selectionEnd, oldValue);\n  return finalizeChange(oldValue, newValue, state, send, onChange);\n}\n\nfunction controlsContainerClasses(mode) {\n  var tmp;\n  tmp = mode.tag ? \"rounded-t border-gray-400 sticky top-0 z-20\" : \"border-gray-400 \";\n  return \"border bg-gray-100 text-sm px-2 flex justify-between items-end \" + tmp;\n}\n\nfunction controls(value, state, send, onChange) {\n  var buttonClasses = \"px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none \";\n  var mode = state.mode;\n  var curriedModifyPhrase = function (param) {\n    return modifyPhrase(value, state, send, onChange, param);\n  };\n  var tmp;\n  var exit = 0;\n  if (mode.tag) {\n    if (mode[0] >= 153880552) {\n      tmp = React.createElement(\"div\", undefined);\n    } else {\n      exit = 1;\n    }\n  } else if (mode[0] !== 153880552) {\n    exit = 1;\n  } else {\n    tmp = React.createElement(\"div\", undefined);\n  }\n  if (exit === 1) {\n    tmp = React.createElement(\"div\", {\n          className: \"bg-white border border-gray-400 rounded-t border-b-0\"\n        }, React.createElement(\"button\", {\n              className: buttonClasses,\n              onClick: (function (param) {\n                  return curriedModifyPhrase(/* Bold */0);\n                })\n            }, React.createElement(\"i\", {\n                  className: \"fas fa-bold fa-fw\"\n                })), React.createElement(\"button\", {\n              className: \"px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none border-l border-gray-400\",\n              onClick: (function (param) {\n                  return curriedModifyPhrase(/* Italic */1);\n                })\n            }, React.createElement(\"i\", {\n                  className: \"fas fa-italic fa-fw\"\n                })), React.createElement(\"button\", {\n              className: \"px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none border-l border-gray-400\",\n              onClick: (function (param) {\n                  return curriedModifyPhrase(/* Strikethrough */2);\n                })\n            }, React.createElement(\"i\", {\n                  className: \"fas fa-strikethrough fa-fw\"\n                })));\n  }\n  var tmp$1;\n  tmp$1 = mode.tag ? null : React.createElement(\"span\", {\n          className: \"ml-2 text-xs font-semibold\"\n        }, \"Exit full-screen\");\n  return React.createElement(\"div\", {\n              className: controlsContainerClasses(state.mode)\n            }, tmp, React.createElement(\"div\", {\n                  className: \"py-1\"\n                }, React.createElement(\"button\", {\n                      className: \"rounded px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none \",\n                      onClick: (function (param) {\n                          return onClickPreview(state, send, param);\n                        })\n                    }, modeIcon(/* Preview */153880552, mode)), React.createElement(\"button\", {\n                      className: \"px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none rounded ml-1 hidden md:inline\",\n                      onClick: (function (param) {\n                          return onClickSplit(state, send, param);\n                        })\n                    }, modeIcon(/* Split */345791162, mode)), React.createElement(\"button\", {\n                      className: \"px-2 py-1 hover:bg-gray-300 hover:text-primary-500 focus:outline-none rounded  ml-1 hidden md:inline\",\n                      onClick: (function (param) {\n                          return onClickFullscreen(state, send, param);\n                        })\n                    }, modeIcon(/* Fullscreen */-261800357, mode), tmp$1)));\n}\n\nfunction modeClasses(mode) {\n  if (mode.tag) {\n    return \"\";\n  } else {\n    return \"flex flex-grow\";\n  }\n}\n\nfunction editorContainerClasses(mode) {\n  var tmp;\n  if (mode.tag) {\n    tmp = mode[0] >= 153880552 ? \"hidden\" : \"border-l\";\n  } else {\n    var match = mode[0];\n    tmp = match !== 153880552 ? (\n        match >= 345791162 ? \"w-1/2\" : \"w-full\"\n      ) : \"hidden\";\n  }\n  return \"border-r border-gray-400 \" + tmp;\n}\n\nfunction previewType(mode) {\n  if (mode.tag) {\n    if (mode[0] >= 153880552) {\n      return /* WindowedPreview */-12288167;\n    } else {\n      throw InvalidModeForPreview;\n    }\n  } else {\n    var match = mode[0];\n    if (match !== 153880552) {\n      if (match >= 345791162) {\n        return /* FullscreenSplit */418394751;\n      } else {\n        throw InvalidModeForPreview;\n      }\n    } else {\n      return /* FullscreenPreview */737745645;\n    }\n  }\n}\n\nfunction previewContainerClasses(mode) {\n  var match = previewType(mode);\n  return \"border-gray-400 bg-gray-100 \" + (\n          match !== 418394751 ? (\n              match >= 737745645 ? \"w-screen mx-auto\" : \"markdown-editor__windowed-preview-container border-l border-r border-b rounded-b px-2 md:px-3\"\n            ) : \"w-1/2 relative\"\n        );\n}\n\nfunction previewClasses(mode) {\n  if (mode.tag || mode[0] < 153880552) {\n    return \"\";\n  } else {\n    return \"absolute max-h-full overflow-auto w-full px-4 pb-8\";\n  }\n}\n\nfunction focusOnEditor(id) {\n  return OptionUtils.mapWithDefault((function (element) {\n                element.focus();\n                return /* () */0;\n              }), /* () */0, OptionUtils.flatMap(Webapi__Dom__HtmlElement.ofElement, Caml_option.nullable_to_opt(document.getElementById(id))));\n}\n\nfunction handleUploadFileResponse(oldValue, state, send, onChange, json) {\n  var errors = Json_decode.field(\"errors\", (function (param) {\n          return Json_decode.array(Json_decode.string, param);\n        }), json);\n  if (Caml_obj.caml_equal(errors, [])) {\n    var markdownEmbedCode = Json_decode.field(\"markdownEmbedCode\", Json_decode.string, json);\n    var insert = \"\\n\" + (markdownEmbedCode + \"\\n\");\n    var match = state.selection;\n    var newValue = insertAt(insert, match[1], oldValue);\n    finalizeChange(oldValue, newValue, state, send, onChange);\n    return Curry._1(send, /* FinishUploading */5);\n  } else {\n    return Curry._1(send, /* SetUploadError */Block.__(2, [\"Failed to attach file! \" + errors.join(\", \")]));\n  }\n}\n\nfunction submitForm(formId, oldValue, state, send, onChange) {\n  return OptionUtils.mapWithDefault((function (element) {\n                var formData = new FormData(element);\n                return Api.sendFormData(\"/markdown_attachments/\", formData, (function (param) {\n                              return handleUploadFileResponse(oldValue, state, send, onChange, param);\n                            }), (function (param) {\n                              return Curry._1(send, /* SetUploadError */Block.__(2, [\"An unexpected error occured! Please reload the page before trying again.\"]));\n                            }));\n              }), /* () */0, Caml_option.nullable_to_opt(document.getElementById(formId)));\n}\n\nfunction attachFile(fileFormId, oldValue, state, send, onChange, $$event) {\n  var files = $$event.target.files;\n  if (files.length !== 0) {\n    var file = Caml_array.caml_array_get(files, 0);\n    var error = file.size > 5242880 ? \"The maximum file size is 5 MB. Please select another file.\" : undefined;\n    if (error !== undefined) {\n      return Curry._1(send, /* SetUploadError */Block.__(2, [error]));\n    } else {\n      Curry._1(send, /* SetUploading */4);\n      return submitForm(fileFormId, oldValue, state, send, onChange);\n    }\n  } else {\n    return /* () */0;\n  }\n}\n\nfunction footerContainerClasses(mode) {\n  var tmp;\n  tmp = mode.tag ? \"rounded-b border-gray-400\" : \"border-gray-400\";\n  return \"markdown-editor__footer-container border bg-gray-100 flex justify-between items-center \" + tmp;\n}\n\nfunction footer(oldValue, state, send, onChange) {\n  var id = state.id;\n  var fileFormId = id + \"-file-form\";\n  var fileInputId = id + \"-file-input\";\n  var match = state.mode;\n  if (match.tag) {\n    if (match[0] >= 153880552) {\n      return null;\n    }\n    \n  } else if (match[0] === 153880552) {\n    return null;\n  }\n  var match$1 = state.uploadState;\n  var tmp;\n  if (match$1) {\n    var error = match$1[0];\n    tmp = React.createElement(\"label\", {\n          className: \"text-xs px-3 py-2 flex-grow cursor-pointer\",\n          htmlFor: fileInputId\n        }, error !== undefined ? React.createElement(\"span\", {\n                className: \"text-red-500\"\n              }, React.createElement(\"i\", {\n                    className: \"fas fa-exclamation-triangle mr-2\"\n                  }), error) : React.createElement(\"span\", undefined, React.createElement(\"i\", {\n                    className: \"far fa-file-image mr-2\"\n                  }), \"Click here to attach a file.\"));\n  } else {\n    tmp = React.createElement(\"span\", {\n          className: \"text-xs px-3 py-2 flex-grow cursor-wait\"\n        }, React.createElement(\"i\", {\n              className: \"fas fa-spinner fa-pulse mr-2\"\n            }), \"Please wait for the file to upload...\");\n  }\n  return React.createElement(\"div\", {\n              className: footerContainerClasses(state.mode)\n            }, React.createElement(\"form\", {\n                  className: \"flex items-center flex-wrap flex-1 text-sm font-semibold hover:bg-gray-300 hover:text-primary-500\",\n                  id: fileFormId\n                }, React.createElement(\"input\", {\n                      name: \"authenticity_token\",\n                      type: \"hidden\",\n                      value: AuthenticityToken.fromHead(/* () */0)\n                    }), React.createElement(\"input\", {\n                      className: \"hidden\",\n                      id: fileInputId,\n                      multiple: false,\n                      name: \"markdown_attachment[file]\",\n                      type: \"file\",\n                      onChange: (function (param) {\n                          return attachFile(fileFormId, oldValue, state, send, onChange, param);\n                        })\n                    }), tmp), React.createElement(\"a\", {\n                  className: \"flex items-center px-3 py-2 hover:bg-gray-300 hover:text-secondary-500 cursor-pointer\",\n                  href: \"/help/markdown_editor\",\n                  target: \"_blank\"\n                }, React.createElement(\"i\", {\n                      className: \"fab fa-markdown text-sm\"\n                    }), React.createElement(\"span\", {\n                      className: \"text-xs ml-1 font-semibold hidden sm:inline\"\n                    }, \"Need help?\")));\n}\n\nfunction textareaClasses(mode) {\n  var tmp;\n  tmp = mode.tag ? \"p-3\" : \"px-3 pt-4 pb-8 h-full resize-none\";\n  return \"w-full outline-none font-mono \" + tmp;\n}\n\nfunction onChangeWrapper(onChange, $$event) {\n  return Curry._1(onChange, $$event.target.value);\n}\n\nfunction onSelect(send, $$event) {\n  var htmlInputElement = $$event.target;\n  var selection_000 = htmlInputElement.selectionStart;\n  var selection_001 = htmlInputElement.selectionEnd;\n  var selection = /* tuple */[\n    selection_000,\n    selection_001\n  ];\n  return Curry._1(send, /* SetSelection */Block.__(0, [selection]));\n}\n\nfunction handleEscapeKey(send, $$event) {\n  var _anyOtherKey = $$event.key;\n  if (_anyOtherKey === \"Escape\") {\n    return Curry._1(send, /* PressEscapeKey */3);\n  } else {\n    return /* () */0;\n  }\n}\n\nfunction handleKeyboardControls(value, state, send, onChange, $$event) {\n  var curriedModifyPhrase = function (param) {\n    return modifyPhrase(value, state, send, onChange, param);\n  };\n  var _anyOtherKey = $$event.key;\n  switch (_anyOtherKey) {\n    case \"b\" :\n        if ($$event.ctrlKey || $$event.metaKey) {\n          return curriedModifyPhrase(/* Bold */0);\n        } else {\n          return /* () */0;\n        }\n    case \"i\" :\n        if ($$event.ctrlKey || $$event.metaKey) {\n          return curriedModifyPhrase(/* Italic */1);\n        } else {\n          return /* () */0;\n        }\n    default:\n      return /* () */0;\n  }\n}\n\nfunction scrollTargetToSource(source, target, _event) {\n  var sourceScrollTop = source.scrollTop;\n  var sourceOffsetHeight = source.offsetHeight;\n  var sourceScrollHeight = source.scrollHeight;\n  var scrollFraction = sourceScrollTop / (sourceScrollHeight - sourceOffsetHeight | 0);\n  var maxTargetScrollTop = target.scrollHeight - target.offsetHeight | 0;\n  target.scrollTop = scrollFraction * maxTargetScrollTop;\n  return /* () */0;\n}\n\nvar ScrollSync = {\n  scrollTargetToSource: scrollTargetToSource\n};\n\nfunction MarkdownEditor(Props) {\n  var value = Props.value;\n  var onChange = Props.onChange;\n  var profile = Props.profile;\n  var textareaId = Props.textareaId;\n  var maxLengthOpt = Props.maxLength;\n  var defaultModeOpt = Props.defaultMode;\n  var placeholder = Props.placeholder;\n  var tabIndex = Props.tabIndex;\n  var maxLength = maxLengthOpt !== undefined ? maxLengthOpt : 1000;\n  var defaultMode = defaultModeOpt !== undefined ? defaultModeOpt : /* Windowed */Block.__(1, [/* Editor */-260983347]);\n  var match = React.useReducer(reducer, /* tuple */[\n        value,\n        textareaId,\n        defaultMode\n      ], computeInitialState);\n  var send = match[1];\n  var state = match[0];\n  React.useEffect((function () {\n          var match = state.mode;\n          if (match.tag && match[0] < 153880552) {\n            TextareaAutosize.create(state.id);\n          }\n          return (function (param) {\n                    return TextareaAutosize.destroy(state.id);\n                  });\n        }), [state.mode]);\n  React.useEffect((function () {\n          var curriedHandler = function (param) {\n            return handleEscapeKey(send, param);\n          };\n          var documentEventTarget = document;\n          documentEventTarget.addEventListener(\"keydown\", curriedHandler);\n          return (function (param) {\n                    documentEventTarget.removeEventListener(\"keydown\", curriedHandler);\n                    return /* () */0;\n                  });\n        }), ([]));\n  React.useEffect((function () {\n          var curriedHandler = function (param) {\n            return handleKeyboardControls(value, state, send, onChange, param);\n          };\n          var textareaEventTarget = OptionUtils.map((function (prim) {\n                  return prim;\n                }), Caml_option.nullable_to_opt(document.getElementById(state.id)));\n          OptionUtils.mapWithDefault((function (param) {\n                  param.addEventListener(\"keydown\", curriedHandler);\n                  return /* () */0;\n                }), /* () */0, textareaEventTarget);\n          return (function (param) {\n                    return OptionUtils.mapWithDefault((function (param) {\n                                  param.removeEventListener(\"keydown\", curriedHandler);\n                                  return /* () */0;\n                                }), /* () */0, textareaEventTarget);\n                  });\n        }));\n  React.useEffect((function () {\n          var textarea = document.getElementById(state.id);\n          var preview = document.getElementById(state.id + \"-preview\");\n          if ((textarea == null) || (preview == null)) {\n            return ;\n          } else {\n            var scrollCallback = function (param) {\n              return scrollTargetToSource(textarea, preview, param);\n            };\n            var _anyOtherMode = state.mode;\n            if (_anyOtherMode.tag) {\n              textarea.removeEventListener(\"scroll\", scrollCallback);\n              return ;\n            } else if (_anyOtherMode[0] !== 345791162) {\n              textarea.removeEventListener(\"scroll\", scrollCallback);\n              return ;\n            } else {\n              textarea.addEventListener(\"scroll\", scrollCallback);\n              return (function (param) {\n                        textarea.removeEventListener(\"scroll\", scrollCallback);\n                        return /* () */0;\n                      });\n            }\n          }\n        }), [state.mode]);\n  var tmp = {\n    \"aria-label\": \"Markdown editor\",\n    className: textareaClasses(state.mode),\n    id: state.id,\n    maxLength: maxLength,\n    rows: 4,\n    value: value,\n    onChange: (function (param) {\n        return Curry._1(onChange, param.target.value);\n      }),\n    onSelect: (function (param) {\n        return onSelect(send, param);\n      })\n  };\n  if (tabIndex !== undefined) {\n    tmp.tabIndex = Caml_option.valFromOption(tabIndex);\n  }\n  if (placeholder !== undefined) {\n    tmp.placeholder = Caml_option.valFromOption(placeholder);\n  }\n  var match$1 = state.mode;\n  return React.createElement(\"div\", {\n              className: containerClasses(state.mode)\n            }, controls(value, state, send, onChange), React.createElement(\"div\", {\n                  className: modeClasses(state.mode)\n                }, React.createElement(\"div\", {\n                      className: editorContainerClasses(state.mode)\n                    }, React.createElement(DisablingCover.make, {\n                          disabled: state.uploadState === /* Uploading */0,\n                          message: \"Uploading...\",\n                          containerClasses: \"h-full\",\n                          children: React.createElement(\"textarea\", tmp)\n                        })), match$1[0] >= 153880552 ? React.createElement(\"div\", {\n                        className: previewContainerClasses(state.mode)\n                      }, React.createElement(\"div\", {\n                            className: previewClasses(state.mode),\n                            id: state.id + \"-preview\"\n                          }, React.createElement(MarkdownBlock.make, {\n                                markdown: value,\n                                className: \"max-w-3xl mx-auto\",\n                                profile: profile\n                              }))) : null), footer(value, state, send, onChange));\n}\n\nvar make = MarkdownEditor;\n\nexports.InvalidModeForPreview = InvalidModeForPreview;\nexports.str = str;\nexports.reducer = reducer;\nexports.computeInitialState = computeInitialState;\nexports.containerClasses = containerClasses;\nexports.modeIcon = modeIcon;\nexports.onClickFullscreen = onClickFullscreen;\nexports.onClickPreview = onClickPreview;\nexports.onClickSplit = onClickSplit;\nexports.insertAt = insertAt;\nexports.wrapWith = wrapWith;\nexports.updateTextareaAfterDelay = updateTextareaAfterDelay;\nexports.finalizeChange = finalizeChange;\nexports.insertAndWrapper = insertAndWrapper;\nexports.modifyPhrase = modifyPhrase;\nexports.controlsContainerClasses = controlsContainerClasses;\nexports.controls = controls;\nexports.modeClasses = modeClasses;\nexports.editorContainerClasses = editorContainerClasses;\nexports.previewType = previewType;\nexports.previewContainerClasses = previewContainerClasses;\nexports.previewClasses = previewClasses;\nexports.focusOnEditor = focusOnEditor;\nexports.handleUploadFileResponse = handleUploadFileResponse;\nexports.submitForm = submitForm;\nexports.attachFile = attachFile;\nexports.footerContainerClasses = footerContainerClasses;\nexports.footer = footer;\nexports.textareaClasses = textareaClasses;\nexports.onChangeWrapper = onChangeWrapper;\nexports.onSelect = onSelect;\nexports.handleEscapeKey = handleEscapeKey;\nexports.handleKeyboardControls = handleKeyboardControls;\nexports.ScrollSync = ScrollSync;\nexports.make = make;\n/*  Not a pure module */\n"]},"metadata":{},"sourceType":"module"}