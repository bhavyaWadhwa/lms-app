{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar FaIcon = require(\"../../../shared/components/FaIcon.bs.js\");\n\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\n\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\n\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\n\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar GraphqlQuery = require(\"../../../shared/utils/GraphqlQuery.bs.js\");\n\nvar $$Notification = require(\"../../../shared/Notification.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nvar ppx_printed_query = \"mutation UndoSubmissionMutation($targetId: ID!)  {\\nundoSubmission(targetId: $targetId)  {\\nsuccess  \\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"undoSubmission\");\n  var tmp;\n\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"success\");\n    var tmp$1;\n\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeBoolean(value$3);\n      tmp$1 = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$3));\n    } else {\n      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field success on type UndoSubmissionPayload is missing\");\n    }\n\n    tmp = {\n      success: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field undoSubmission on type Mutation is missing\");\n  }\n\n  return {\n    undoSubmission: tmp\n  };\n}\n\nfunction make(targetId, param) {\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"targetId\", targetId]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeWithVariables(variables) {\n  var targetId = variables.targetId;\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"targetId\", targetId]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeVariables(targetId, param) {\n  return Js_dict.fromArray([\n  /* tuple */\n  [\"targetId\", targetId]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  }));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, targetId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n  /* tuple */\n  [\"targetId\", targetId]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  })));\n}\n\nvar definition =\n/* tuple */\n[parse, ppx_printed_query, definition_002];\n\nfunction ret_type(f) {\n  return {};\n}\n\nvar MT_Ret = {};\nvar DeleteSubmissionQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction handleClick(targetId, setStatus, undoSubmissionCB, $$event) {\n  $$event.preventDefault();\n\n  if (window.confirm(\"Are you sure you want to delete this submission?\")) {\n    Curry._1(setStatus, function (param) {\n      return (\n        /* Undoing */\n        1\n      );\n    });\n\n    (function (eta) {\n      return GraphqlQuery.sendQuery(undefined, eta);\n    })(make(targetId,\n    /* () */\n    0)).then(function (response) {\n      if (response.undoSubmission.success) {\n        Curry._1(undoSubmissionCB,\n        /* () */\n        0);\n      } else {\n        $$Notification.notice(\"Could not undo submission\", \"Please reload the page and check the status of the submission before trying again.\");\n\n        Curry._1(setStatus, function (param) {\n          return (\n            /* Errored */\n            2\n          );\n        });\n      }\n\n      return Promise.resolve(\n      /* () */\n      0);\n    })[\"catch\"](function (param) {\n      $$Notification.error(\"Unexpected Error\", \"An unexpected error occured, and our team has been notified about this. Please reload the page before trying again.\");\n\n      Curry._1(setStatus, function (param) {\n        return (\n          /* Errored */\n          2\n        );\n      });\n\n      return Promise.resolve(\n      /* () */\n      0);\n    });\n    return (\n      /* () */\n      0\n    );\n  } else {\n    return (\n      /* () */\n      0\n    );\n  }\n}\n\nfunction buttonContents(status) {\n  switch (status) {\n    case\n    /* Pending */\n    0:\n      return React.createElement(\"span\", undefined, React.createElement(FaIcon.make, {\n        classes: \"fas fa-undo mr-2\"\n      }), React.createElement(\"span\", {\n        className: \"hidden md:inline\"\n      }, \"Undo submission\"), React.createElement(\"span\", {\n        className: \"md:hidden\"\n      }, \"Undo\"));\n\n    case\n    /* Undoing */\n    1:\n      return React.createElement(\"span\", undefined, React.createElement(FaIcon.make, {\n        classes: \"fas fa-spinner fa-spin mr-2\"\n      }), \"Undoing...\");\n\n    case\n    /* Errored */\n    2:\n      return React.createElement(\"span\", undefined, React.createElement(FaIcon.make, {\n        classes: \"fas fa-exclamation-triangle mr-2\"\n      }), \"Error!\");\n  }\n}\n\nfunction isDisabled(status) {\n  return status !== 0;\n}\n\nfunction buttonClasses(status) {\n  var tmp;\n\n  switch (status) {\n    case\n    /* Pending */\n    0:\n      tmp = \"pointer\";\n      break;\n\n    case\n    /* Undoing */\n    1:\n      tmp = \"wait\";\n      break;\n\n    case\n    /* Errored */\n    2:\n      tmp = \"not-allowed\";\n      break;\n  }\n\n  return \"btn btn-small btn-danger cursor-\" + tmp;\n}\n\nfunction CoursesCurriculum__UndoButton(Props) {\n  var undoSubmissionCB = Props.undoSubmissionCB;\n  var targetId = Props.targetId;\n  var match = React.useState(function () {\n    return (\n      /* Pending */\n      0\n    );\n  });\n  var setStatus = match[1];\n  var status = match[0];\n  return React.createElement(\"button\", {\n    className: buttonClasses(status),\n    title: \"Delete this submission\",\n    disabled: status !== 0,\n    onClick: function onClick(param) {\n      return handleClick(targetId, setStatus, undoSubmissionCB, param);\n    }\n  }, buttonContents(status));\n}\n\nvar make$1 = CoursesCurriculum__UndoButton;\nexports.str = str;\nexports.DeleteSubmissionQuery = DeleteSubmissionQuery;\nexports.handleClick = handleClick;\nexports.buttonContents = buttonContents;\nexports.isDisabled = isDisabled;\nexports.buttonClasses = buttonClasses;\nexports.make = make$1;\n/* react Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/courses/curricula/components/CoursesCurriculum__UndoButton.bs.js"],"names":["Curry","require","React","FaIcon","Js_exn","Js_dict","Js_json","Js_option","Caml_option","GraphqlQuery","$$Notification","str","prim","ppx_printed_query","parse","value","value$1","getExn","decodeObject","match","get","tmp","undefined","value$2","valFromOption","match$1","tmp$1","value$3","match$2","decodeBoolean","raiseError","JSON","stringify","success","undoSubmission","make","targetId","param","query","variables","fromArray","filter","test","makeWithVariables","makeVariables","definition_002","graphql_ppx_use_json_variables_fn","_1","definition","ret_type","f","MT_Ret","DeleteSubmissionQuery","handleClick","setStatus","undoSubmissionCB","$$event","preventDefault","window","confirm","eta","sendQuery","then","response","notice","Promise","resolve","error","buttonContents","status","createElement","classes","className","isDisabled","buttonClasses","CoursesCurriculum__UndoButton","Props","useState","title","disabled","onClick","make$1","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar FaIcon = require(\"../../../shared/components/FaIcon.bs.js\");\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar GraphqlQuery = require(\"../../../shared/utils/GraphqlQuery.bs.js\");\nvar $$Notification = require(\"../../../shared/Notification.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nvar ppx_printed_query = \"mutation UndoSubmissionMutation($targetId: ID!)  {\\nundoSubmission(targetId: $targetId)  {\\nsuccess  \\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"undoSubmission\");\n  var tmp;\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"success\");\n    var tmp$1;\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeBoolean(value$3);\n      tmp$1 = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$3));\n    } else {\n      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field success on type UndoSubmissionPayload is missing\");\n    }\n    tmp = {\n      success: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field undoSubmission on type Mutation is missing\");\n  }\n  return {\n          undoSubmission: tmp\n        };\n}\n\nfunction make(targetId, param) {\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([/* tuple */[\n                    \"targetId\",\n                    targetId\n                  ]].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeWithVariables(variables) {\n  var targetId = variables.targetId;\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([/* tuple */[\n                    \"targetId\",\n                    targetId\n                  ]].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeVariables(targetId, param) {\n  return Js_dict.fromArray([/* tuple */[\n                  \"targetId\",\n                  targetId\n                ]].filter((function (param) {\n                    return !Js_json.test(param[1], /* Null */5);\n                  })));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, targetId, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([/* tuple */[\n                      \"targetId\",\n                      targetId\n                    ]].filter((function (param) {\n                        return !Js_json.test(param[1], /* Null */5);\n                      }))));\n}\n\nvar definition = /* tuple */[\n  parse,\n  ppx_printed_query,\n  definition_002\n];\n\nfunction ret_type(f) {\n  return { };\n}\n\nvar MT_Ret = { };\n\nvar DeleteSubmissionQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction handleClick(targetId, setStatus, undoSubmissionCB, $$event) {\n  $$event.preventDefault();\n  if (window.confirm(\"Are you sure you want to delete this submission?\")) {\n    Curry._1(setStatus, (function (param) {\n            return /* Undoing */1;\n          }));\n    (function (eta) {\n              return GraphqlQuery.sendQuery(undefined, eta);\n            })(make(targetId, /* () */0)).then((function (response) {\n              if (response.undoSubmission.success) {\n                Curry._1(undoSubmissionCB, /* () */0);\n              } else {\n                $$Notification.notice(\"Could not undo submission\", \"Please reload the page and check the status of the submission before trying again.\");\n                Curry._1(setStatus, (function (param) {\n                        return /* Errored */2;\n                      }));\n              }\n              return Promise.resolve(/* () */0);\n            })).catch((function (param) {\n            $$Notification.error(\"Unexpected Error\", \"An unexpected error occured, and our team has been notified about this. Please reload the page before trying again.\");\n            Curry._1(setStatus, (function (param) {\n                    return /* Errored */2;\n                  }));\n            return Promise.resolve(/* () */0);\n          }));\n    return /* () */0;\n  } else {\n    return /* () */0;\n  }\n}\n\nfunction buttonContents(status) {\n  switch (status) {\n    case /* Pending */0 :\n        return React.createElement(\"span\", undefined, React.createElement(FaIcon.make, {\n                        classes: \"fas fa-undo mr-2\"\n                      }), React.createElement(\"span\", {\n                        className: \"hidden md:inline\"\n                      }, \"Undo submission\"), React.createElement(\"span\", {\n                        className: \"md:hidden\"\n                      }, \"Undo\"));\n    case /* Undoing */1 :\n        return React.createElement(\"span\", undefined, React.createElement(FaIcon.make, {\n                        classes: \"fas fa-spinner fa-spin mr-2\"\n                      }), \"Undoing...\");\n    case /* Errored */2 :\n        return React.createElement(\"span\", undefined, React.createElement(FaIcon.make, {\n                        classes: \"fas fa-exclamation-triangle mr-2\"\n                      }), \"Error!\");\n    \n  }\n}\n\nfunction isDisabled(status) {\n  return status !== 0;\n}\n\nfunction buttonClasses(status) {\n  var tmp;\n  switch (status) {\n    case /* Pending */0 :\n        tmp = \"pointer\";\n        break;\n    case /* Undoing */1 :\n        tmp = \"wait\";\n        break;\n    case /* Errored */2 :\n        tmp = \"not-allowed\";\n        break;\n    \n  }\n  return \"btn btn-small btn-danger cursor-\" + tmp;\n}\n\nfunction CoursesCurriculum__UndoButton(Props) {\n  var undoSubmissionCB = Props.undoSubmissionCB;\n  var targetId = Props.targetId;\n  var match = React.useState((function () {\n          return /* Pending */0;\n        }));\n  var setStatus = match[1];\n  var status = match[0];\n  return React.createElement(\"button\", {\n              className: buttonClasses(status),\n              title: \"Delete this submission\",\n              disabled: status !== 0,\n              onClick: (function (param) {\n                  return handleClick(targetId, setStatus, undoSubmissionCB, param);\n                })\n            }, buttonContents(status));\n}\n\nvar make$1 = CoursesCurriculum__UndoButton;\n\nexports.str = str;\nexports.DeleteSubmissionQuery = DeleteSubmissionQuery;\nexports.handleClick = handleClick;\nexports.buttonContents = buttonContents;\nexports.isDisabled = isDisabled;\nexports.buttonClasses = buttonClasses;\nexports.make = make$1;\n/* react Not a pure module */\n"]},"metadata":{},"sourceType":"module"}