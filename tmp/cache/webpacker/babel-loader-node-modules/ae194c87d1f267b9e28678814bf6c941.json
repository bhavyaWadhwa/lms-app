{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar FaIcon = require(\"../../../shared/components/FaIcon.bs.js\");\n\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\n\nvar DateFns = require(\"../../../shared/utils/DateFns.bs.js\");\n\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\n\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\n\nvar Tooltip = require(\"../../../shared/components/Tooltip.bs.js\");\n\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\n\nvar ArrayUtils = require(\"../../../shared/utils/ArrayUtils.bs.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\n\nvar GraphqlQuery = require(\"../../../shared/utils/GraphqlQuery.bs.js\");\n\nvar DisablingCover = require(\"../../../shared/components/DisablingCover.bs.js\");\n\nvar SubmissionChecklistItem = require(\"../../review/types/SubmissionChecklistItem.bs.js\");\n\nvar CoursesCurriculum__Target = require(\"../types/CoursesCurriculum__Target.bs.js\");\n\nvar CoursesCurriculum__Submission = require(\"../types/CoursesCurriculum__Submission.bs.js\");\n\nvar CoursesCurriculum__ChecklistItem = require(\"../types/CoursesCurriculum__ChecklistItem.bs.js\");\n\nvar CoursesCurriculum__SubmissionItem = require(\"./CoursesCurriculum__SubmissionItem.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction buttonContents(formState, checklist) {\n  var icon = formState >= 2 ? React.createElement(FaIcon.make, {\n    classes: \"fas fa-cloud-upload-alt mr-2\"\n  }) : React.createElement(FaIcon.make, {\n    classes: \"fas fa-spinner fa-pulse mr-2\"\n  });\n  var text;\n\n  switch (formState) {\n    case\n    /* Attaching */\n    0:\n      text = \"Attaching...\";\n      break;\n\n    case\n    /* Saving */\n    1:\n      text = \"Submitting...\";\n      break;\n\n    case\n    /* Ready */\n    2:\n      text = ArrayUtils.isEmpty(checklist) ? \"Complete\" : \"Submit\";\n      break;\n  }\n\n  return React.createElement(\"span\", undefined, icon, text);\n}\n\nfunction initialState(checklist) {\n  return {\n    formState:\n    /* Ready */\n    2,\n    checklist: CoursesCurriculum__ChecklistItem.fromTargetChecklistItem(checklist)\n  };\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    switch (action) {\n      case\n      /* SetAttaching */\n      0:\n        return {\n          formState:\n          /* Attaching */\n          0,\n          checklist: state.checklist\n        };\n\n      case\n      /* SetSaving */\n      1:\n        return {\n          formState:\n          /* Saving */\n          1,\n          checklist: state.checklist\n        };\n\n      case\n      /* SetReady */\n      2:\n        return {\n          formState:\n          /* Ready */\n          2,\n          checklist: state.checklist\n        };\n    }\n  } else {\n    return {\n      formState:\n      /* Ready */\n      2,\n      checklist: action[0]\n    };\n  }\n}\n\nfunction isBusy(formState) {\n  return formState < 2;\n}\n\nvar ppx_printed_query = \"mutation CreateSubmissionMutation($targetId: ID!, $checklist: JSON!, $fileIds: [ID!]!)  {\\ncreateSubmission(targetId: $targetId, checklist: $checklist, fileIds: $fileIds)  {\\nsubmission  {\\nid  \\ncreatedAt  \\n}\\n\\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"createSubmission\");\n  var tmp;\n\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"submission\");\n    var tmp$1;\n\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeNull(value$3);\n\n      if (match$2 !== undefined) {\n        tmp$1 = undefined;\n      } else {\n        var value$4 = Js_option.getExn(Js_json.decodeObject(value$3));\n        var match$3 = Js_dict.get(value$4, \"id\");\n        var tmp$2;\n\n        if (match$3 !== undefined) {\n          var value$5 = Caml_option.valFromOption(match$3);\n          var match$4 = Js_json.decodeString(value$5);\n          tmp$2 = match$4 !== undefined ? match$4 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$5));\n        } else {\n          tmp$2 = Js_exn.raiseError(\"graphql_ppx: Field id on type Submission is missing\");\n        }\n\n        var match$5 = Js_dict.get(value$4, \"createdAt\");\n        tmp$1 = {\n          id: tmp$2,\n          createdAt: match$5 !== undefined ? Caml_option.valFromOption(match$5) : Js_exn.raiseError(\"graphql_ppx: Field createdAt on type Submission is missing\")\n        };\n      }\n    } else {\n      tmp$1 = undefined;\n    }\n\n    tmp = {\n      submission: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field createSubmission on type Mutation is missing\");\n  }\n\n  return {\n    createSubmission: tmp\n  };\n}\n\nfunction make(targetId, checklist, fileIds, param) {\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"targetId\", targetId],\n    /* tuple */\n    [\"checklist\", checklist],\n    /* tuple */\n    [\"fileIds\", fileIds.map(function (prim) {\n      return prim;\n    })]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeWithVariables(variables) {\n  var targetId = variables.targetId;\n  var checklist = variables.checklist;\n  var fileIds = variables.fileIds;\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"targetId\", targetId],\n    /* tuple */\n    [\"checklist\", checklist],\n    /* tuple */\n    [\"fileIds\", fileIds.map(function (prim) {\n      return prim;\n    })]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeVariables(targetId, checklist, fileIds, param) {\n  return Js_dict.fromArray([\n  /* tuple */\n  [\"targetId\", targetId],\n  /* tuple */\n  [\"checklist\", checklist],\n  /* tuple */\n  [\"fileIds\", fileIds.map(function (prim) {\n    return prim;\n  })]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  }));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, targetId, checklist, fileIds, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n  /* tuple */\n  [\"targetId\", targetId],\n  /* tuple */\n  [\"checklist\", checklist],\n  /* tuple */\n  [\"fileIds\", fileIds.map(function (prim) {\n    return prim;\n  })]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  })));\n}\n\nvar definition =\n/* tuple */\n[parse, ppx_printed_query, definition_002];\n\nfunction ret_type(f) {\n  return {};\n}\n\nvar MT_Ret = {};\nvar CreateSubmissionQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction isButtonDisabled(state) {\n  var match = state.formState;\n\n  if (match < 2) {\n    return true;\n  } else {\n    return !CoursesCurriculum__ChecklistItem.validChecklist(state.checklist);\n  }\n}\n\nfunction submit(state, send, target, addSubmissionCB, $$event) {\n  $$event.preventDefault();\n\n  Curry._1(send,\n  /* SetSaving */\n  1);\n\n  var fileIds = CoursesCurriculum__ChecklistItem.fileIds(state.checklist);\n  var checklist = CoursesCurriculum__ChecklistItem.encodeArray(state.checklist);\n  (function (eta) {\n    return GraphqlQuery.sendQuery(undefined, eta);\n  })(make(CoursesCurriculum__Target.id(target), checklist, fileIds,\n  /* () */\n  0)).then(function (response) {\n    var match = response.createSubmission.submission;\n\n    if (match !== undefined) {\n      var submission = Caml_option.valFromOption(match);\n      var files = CoursesCurriculum__ChecklistItem.makeFiles(state.checklist);\n      var submissionChecklist = Json_decode.array(function (param) {\n        return SubmissionChecklistItem.decode(files, param);\n      }, checklist);\n\n      Curry._1(addSubmissionCB, CoursesCurriculum__Submission.make(submission.id, DateFns.decodeISO(submission.createdAt),\n      /* Pending */\n      1, submissionChecklist));\n    } else {\n      Curry._1(send,\n      /* SetReady */\n      2);\n    }\n\n    return Promise.resolve(\n    /* () */\n    0);\n  })[\"catch\"](function (_error) {\n    Curry._1(send,\n    /* SetReady */\n    2);\n\n    return Promise.resolve(\n    /* () */\n    0);\n  });\n  return (\n    /* () */\n    0\n  );\n}\n\nfunction updateResult(state, send, index, result) {\n  return Curry._1(send,\n  /* UpdateResponse */\n  [CoursesCurriculum__ChecklistItem.updateResultAtIndex(index, result, state.checklist)]);\n}\n\nfunction buttonClasses(checklist) {\n  return \"flex mt-3 \" + (ArrayUtils.isEmpty(checklist) ? \"justify-center\" : \"justify-end\");\n}\n\nfunction setAttaching(send, bool) {\n  return Curry._1(send, bool ?\n  /* SetAttaching */\n  0 :\n  /* SetReady */\n  2);\n}\n\nfunction statusText(formState) {\n  switch (formState) {\n    case\n    /* Attaching */\n    0:\n      return \"Attaching...\";\n\n    case\n    /* Saving */\n    1:\n      return \"Submitting...\";\n\n    case\n    /* Ready */\n    2:\n      return \"Submit\";\n  }\n}\n\nfunction tooltipText(preview) {\n  if (preview) {\n    return React.createElement(\"span\", undefined, \"You are accessing the preview mode\", React.createElement(\"br\", undefined), \"for this course\");\n  } else {\n    return React.createElement(\"span\", undefined, \"Please complete all the required\", React.createElement(\"br\", undefined), \"steps to submit this target\");\n  }\n}\n\nfunction CoursesCurriculum__SubmissionBuilder(Props) {\n  var target = Props.target;\n  var addSubmissionCB = Props.addSubmissionCB;\n  var preview = Props.preview;\n  var checklist = Props.checklist;\n  var match = React.useReducer(reducer, {\n    formState:\n    /* Ready */\n    2,\n    checklist: CoursesCurriculum__ChecklistItem.fromTargetChecklistItem(checklist)\n  });\n  var send = match[1];\n  var state = match[0];\n  return React.createElement(\"div\", {\n    className: \"bg-gray-100 p-4 my-4 border rounded-lg\"\n  }, React.createElement(DisablingCover.make, {\n    disabled: state.formState < 2,\n    message: statusText(state.formState),\n    children: null\n  }, ArrayUtils.isEmpty(state.checklist) ? React.createElement(\"div\", {\n    className: \"text-center\"\n  }, \"This target has no actions. Click submit to complete the target\") : $$Array.mapi(function (index, checklistItem) {\n    return React.createElement(CoursesCurriculum__SubmissionItem.make, {\n      index: index,\n      checklistItem: checklistItem,\n      updateResultCB: function updateResultCB(param) {\n        return updateResult(state, send, index, param);\n      },\n      attachingCB: function attachingCB(param) {\n        return setAttaching(send, param);\n      },\n      preview: preview,\n      key: String(index)\n    });\n  }, state.checklist), React.createElement(\"div\", {\n    className: buttonClasses(state.checklist)\n  }, React.createElement(Tooltip.make, {\n    tip: tooltipText(preview),\n    position:\n    /* Left */\n    847852583,\n    disabled: !isButtonDisabled(state),\n    children: React.createElement(\"button\", {\n      className: \"btn btn-primary flex justify-center flex-grow md:flex-grow-0\",\n      disabled: isButtonDisabled(state) || preview,\n      onClick: function onClick(param) {\n        return submit(state, send, target, addSubmissionCB, param);\n      }\n    }, buttonContents(state.formState, checklist))\n  }))));\n}\n\nvar make$1 = CoursesCurriculum__SubmissionBuilder;\nexports.str = str;\nexports.buttonContents = buttonContents;\nexports.initialState = initialState;\nexports.reducer = reducer;\nexports.isBusy = isBusy;\nexports.CreateSubmissionQuery = CreateSubmissionQuery;\nexports.isButtonDisabled = isButtonDisabled;\nexports.submit = submit;\nexports.updateResult = updateResult;\nexports.buttonClasses = buttonClasses;\nexports.setAttaching = setAttaching;\nexports.statusText = statusText;\nexports.tooltipText = tooltipText;\nexports.make = make$1;\n/* react Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/courses/curricula/components/CoursesCurriculum__SubmissionBuilder.bs.js"],"names":["$$Array","require","Curry","React","FaIcon","Js_exn","DateFns","Js_dict","Js_json","Tooltip","Js_option","ArrayUtils","Caml_option","Json_decode","GraphqlQuery","DisablingCover","SubmissionChecklistItem","CoursesCurriculum__Target","CoursesCurriculum__Submission","CoursesCurriculum__ChecklistItem","CoursesCurriculum__SubmissionItem","str","prim","buttonContents","formState","checklist","icon","createElement","make","classes","text","isEmpty","undefined","initialState","fromTargetChecklistItem","reducer","state","action","isBusy","ppx_printed_query","parse","value","value$1","getExn","decodeObject","match","get","tmp","value$2","valFromOption","match$1","tmp$1","value$3","match$2","decodeNull","value$4","match$3","tmp$2","value$5","match$4","decodeString","raiseError","JSON","stringify","match$5","id","createdAt","submission","createSubmission","targetId","fileIds","param","query","variables","fromArray","map","filter","test","makeWithVariables","makeVariables","definition_002","graphql_ppx_use_json_variables_fn","_1","definition","ret_type","f","MT_Ret","CreateSubmissionQuery","isButtonDisabled","validChecklist","submit","send","target","addSubmissionCB","$$event","preventDefault","encodeArray","eta","sendQuery","then","response","files","makeFiles","submissionChecklist","array","decode","decodeISO","Promise","resolve","_error","updateResult","index","result","updateResultAtIndex","buttonClasses","setAttaching","bool","statusText","tooltipText","preview","CoursesCurriculum__SubmissionBuilder","Props","useReducer","className","disabled","message","children","mapi","checklistItem","updateResultCB","attachingCB","key","String","tip","position","onClick","make$1","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar FaIcon = require(\"../../../shared/components/FaIcon.bs.js\");\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\nvar DateFns = require(\"../../../shared/utils/DateFns.bs.js\");\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\nvar Tooltip = require(\"../../../shared/components/Tooltip.bs.js\");\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\nvar ArrayUtils = require(\"../../../shared/utils/ArrayUtils.bs.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\nvar GraphqlQuery = require(\"../../../shared/utils/GraphqlQuery.bs.js\");\nvar DisablingCover = require(\"../../../shared/components/DisablingCover.bs.js\");\nvar SubmissionChecklistItem = require(\"../../review/types/SubmissionChecklistItem.bs.js\");\nvar CoursesCurriculum__Target = require(\"../types/CoursesCurriculum__Target.bs.js\");\nvar CoursesCurriculum__Submission = require(\"../types/CoursesCurriculum__Submission.bs.js\");\nvar CoursesCurriculum__ChecklistItem = require(\"../types/CoursesCurriculum__ChecklistItem.bs.js\");\nvar CoursesCurriculum__SubmissionItem = require(\"./CoursesCurriculum__SubmissionItem.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction buttonContents(formState, checklist) {\n  var icon = formState >= 2 ? React.createElement(FaIcon.make, {\n          classes: \"fas fa-cloud-upload-alt mr-2\"\n        }) : React.createElement(FaIcon.make, {\n          classes: \"fas fa-spinner fa-pulse mr-2\"\n        });\n  var text;\n  switch (formState) {\n    case /* Attaching */0 :\n        text = \"Attaching...\";\n        break;\n    case /* Saving */1 :\n        text = \"Submitting...\";\n        break;\n    case /* Ready */2 :\n        text = ArrayUtils.isEmpty(checklist) ? \"Complete\" : \"Submit\";\n        break;\n    \n  }\n  return React.createElement(\"span\", undefined, icon, text);\n}\n\nfunction initialState(checklist) {\n  return {\n          formState: /* Ready */2,\n          checklist: CoursesCurriculum__ChecklistItem.fromTargetChecklistItem(checklist)\n        };\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    switch (action) {\n      case /* SetAttaching */0 :\n          return {\n                  formState: /* Attaching */0,\n                  checklist: state.checklist\n                };\n      case /* SetSaving */1 :\n          return {\n                  formState: /* Saving */1,\n                  checklist: state.checklist\n                };\n      case /* SetReady */2 :\n          return {\n                  formState: /* Ready */2,\n                  checklist: state.checklist\n                };\n      \n    }\n  } else {\n    return {\n            formState: /* Ready */2,\n            checklist: action[0]\n          };\n  }\n}\n\nfunction isBusy(formState) {\n  return formState < 2;\n}\n\nvar ppx_printed_query = \"mutation CreateSubmissionMutation($targetId: ID!, $checklist: JSON!, $fileIds: [ID!]!)  {\\ncreateSubmission(targetId: $targetId, checklist: $checklist, fileIds: $fileIds)  {\\nsubmission  {\\nid  \\ncreatedAt  \\n}\\n\\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"createSubmission\");\n  var tmp;\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"submission\");\n    var tmp$1;\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeNull(value$3);\n      if (match$2 !== undefined) {\n        tmp$1 = undefined;\n      } else {\n        var value$4 = Js_option.getExn(Js_json.decodeObject(value$3));\n        var match$3 = Js_dict.get(value$4, \"id\");\n        var tmp$2;\n        if (match$3 !== undefined) {\n          var value$5 = Caml_option.valFromOption(match$3);\n          var match$4 = Js_json.decodeString(value$5);\n          tmp$2 = match$4 !== undefined ? match$4 : Js_exn.raiseError(\"graphql_ppx: Expected string, got \" + JSON.stringify(value$5));\n        } else {\n          tmp$2 = Js_exn.raiseError(\"graphql_ppx: Field id on type Submission is missing\");\n        }\n        var match$5 = Js_dict.get(value$4, \"createdAt\");\n        tmp$1 = {\n          id: tmp$2,\n          createdAt: match$5 !== undefined ? Caml_option.valFromOption(match$5) : Js_exn.raiseError(\"graphql_ppx: Field createdAt on type Submission is missing\")\n        };\n      }\n    } else {\n      tmp$1 = undefined;\n    }\n    tmp = {\n      submission: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field createSubmission on type Mutation is missing\");\n  }\n  return {\n          createSubmission: tmp\n        };\n}\n\nfunction make(targetId, checklist, fileIds, param) {\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"targetId\",\n                    targetId\n                  ],\n                  /* tuple */[\n                    \"checklist\",\n                    checklist\n                  ],\n                  /* tuple */[\n                    \"fileIds\",\n                    fileIds.map((function (prim) {\n                            return prim;\n                          }))\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeWithVariables(variables) {\n  var targetId = variables.targetId;\n  var checklist = variables.checklist;\n  var fileIds = variables.fileIds;\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"targetId\",\n                    targetId\n                  ],\n                  /* tuple */[\n                    \"checklist\",\n                    checklist\n                  ],\n                  /* tuple */[\n                    \"fileIds\",\n                    fileIds.map((function (prim) {\n                            return prim;\n                          }))\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeVariables(targetId, checklist, fileIds, param) {\n  return Js_dict.fromArray([\n                /* tuple */[\n                  \"targetId\",\n                  targetId\n                ],\n                /* tuple */[\n                  \"checklist\",\n                  checklist\n                ],\n                /* tuple */[\n                  \"fileIds\",\n                  fileIds.map((function (prim) {\n                          return prim;\n                        }))\n                ]\n              ].filter((function (param) {\n                    return !Js_json.test(param[1], /* Null */5);\n                  })));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, targetId, checklist, fileIds, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n                    /* tuple */[\n                      \"targetId\",\n                      targetId\n                    ],\n                    /* tuple */[\n                      \"checklist\",\n                      checklist\n                    ],\n                    /* tuple */[\n                      \"fileIds\",\n                      fileIds.map((function (prim) {\n                              return prim;\n                            }))\n                    ]\n                  ].filter((function (param) {\n                        return !Js_json.test(param[1], /* Null */5);\n                      }))));\n}\n\nvar definition = /* tuple */[\n  parse,\n  ppx_printed_query,\n  definition_002\n];\n\nfunction ret_type(f) {\n  return { };\n}\n\nvar MT_Ret = { };\n\nvar CreateSubmissionQuery = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction isButtonDisabled(state) {\n  var match = state.formState;\n  if (match < 2) {\n    return true;\n  } else {\n    return !CoursesCurriculum__ChecklistItem.validChecklist(state.checklist);\n  }\n}\n\nfunction submit(state, send, target, addSubmissionCB, $$event) {\n  $$event.preventDefault();\n  Curry._1(send, /* SetSaving */1);\n  var fileIds = CoursesCurriculum__ChecklistItem.fileIds(state.checklist);\n  var checklist = CoursesCurriculum__ChecklistItem.encodeArray(state.checklist);\n  (function (eta) {\n            return GraphqlQuery.sendQuery(undefined, eta);\n          })(make(CoursesCurriculum__Target.id(target), checklist, fileIds, /* () */0)).then((function (response) {\n            var match = response.createSubmission.submission;\n            if (match !== undefined) {\n              var submission = Caml_option.valFromOption(match);\n              var files = CoursesCurriculum__ChecklistItem.makeFiles(state.checklist);\n              var submissionChecklist = Json_decode.array((function (param) {\n                      return SubmissionChecklistItem.decode(files, param);\n                    }), checklist);\n              Curry._1(addSubmissionCB, CoursesCurriculum__Submission.make(submission.id, DateFns.decodeISO(submission.createdAt), /* Pending */1, submissionChecklist));\n            } else {\n              Curry._1(send, /* SetReady */2);\n            }\n            return Promise.resolve(/* () */0);\n          })).catch((function (_error) {\n          Curry._1(send, /* SetReady */2);\n          return Promise.resolve(/* () */0);\n        }));\n  return /* () */0;\n}\n\nfunction updateResult(state, send, index, result) {\n  return Curry._1(send, /* UpdateResponse */[CoursesCurriculum__ChecklistItem.updateResultAtIndex(index, result, state.checklist)]);\n}\n\nfunction buttonClasses(checklist) {\n  return \"flex mt-3 \" + (\n          ArrayUtils.isEmpty(checklist) ? \"justify-center\" : \"justify-end\"\n        );\n}\n\nfunction setAttaching(send, bool) {\n  return Curry._1(send, bool ? /* SetAttaching */0 : /* SetReady */2);\n}\n\nfunction statusText(formState) {\n  switch (formState) {\n    case /* Attaching */0 :\n        return \"Attaching...\";\n    case /* Saving */1 :\n        return \"Submitting...\";\n    case /* Ready */2 :\n        return \"Submit\";\n    \n  }\n}\n\nfunction tooltipText(preview) {\n  if (preview) {\n    return React.createElement(\"span\", undefined, \"You are accessing the preview mode\", React.createElement(\"br\", undefined), \"for this course\");\n  } else {\n    return React.createElement(\"span\", undefined, \"Please complete all the required\", React.createElement(\"br\", undefined), \"steps to submit this target\");\n  }\n}\n\nfunction CoursesCurriculum__SubmissionBuilder(Props) {\n  var target = Props.target;\n  var addSubmissionCB = Props.addSubmissionCB;\n  var preview = Props.preview;\n  var checklist = Props.checklist;\n  var match = React.useReducer(reducer, {\n        formState: /* Ready */2,\n        checklist: CoursesCurriculum__ChecklistItem.fromTargetChecklistItem(checklist)\n      });\n  var send = match[1];\n  var state = match[0];\n  return React.createElement(\"div\", {\n              className: \"bg-gray-100 p-4 my-4 border rounded-lg\"\n            }, React.createElement(DisablingCover.make, {\n                  disabled: state.formState < 2,\n                  message: statusText(state.formState),\n                  children: null\n                }, ArrayUtils.isEmpty(state.checklist) ? React.createElement(\"div\", {\n                        className: \"text-center\"\n                      }, \"This target has no actions. Click submit to complete the target\") : $$Array.mapi((function (index, checklistItem) {\n                          return React.createElement(CoursesCurriculum__SubmissionItem.make, {\n                                      index: index,\n                                      checklistItem: checklistItem,\n                                      updateResultCB: (function (param) {\n                                          return updateResult(state, send, index, param);\n                                        }),\n                                      attachingCB: (function (param) {\n                                          return setAttaching(send, param);\n                                        }),\n                                      preview: preview,\n                                      key: String(index)\n                                    });\n                        }), state.checklist), React.createElement(\"div\", {\n                      className: buttonClasses(state.checklist)\n                    }, React.createElement(Tooltip.make, {\n                          tip: tooltipText(preview),\n                          position: /* Left */847852583,\n                          disabled: !isButtonDisabled(state),\n                          children: React.createElement(\"button\", {\n                                className: \"btn btn-primary flex justify-center flex-grow md:flex-grow-0\",\n                                disabled: isButtonDisabled(state) || preview,\n                                onClick: (function (param) {\n                                    return submit(state, send, target, addSubmissionCB, param);\n                                  })\n                              }, buttonContents(state.formState, checklist))\n                        }))));\n}\n\nvar make$1 = CoursesCurriculum__SubmissionBuilder;\n\nexports.str = str;\nexports.buttonContents = buttonContents;\nexports.initialState = initialState;\nexports.reducer = reducer;\nexports.isBusy = isBusy;\nexports.CreateSubmissionQuery = CreateSubmissionQuery;\nexports.isButtonDisabled = isButtonDisabled;\nexports.submit = submit;\nexports.updateResult = updateResult;\nexports.buttonClasses = buttonClasses;\nexports.setAttaching = setAttaching;\nexports.statusText = statusText;\nexports.tooltipText = tooltipText;\nexports.make = make$1;\n/* react Not a pure module */\n"]},"metadata":{},"sourceType":"module"}