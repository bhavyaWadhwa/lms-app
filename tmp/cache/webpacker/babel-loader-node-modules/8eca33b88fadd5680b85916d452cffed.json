{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\n\nvar Block = require(\"bs-platform/lib/js/block.js\");\n\nvar $$String = require(\"bs-platform/lib/js/string.js\");\n\nvar Caml_obj = require(\"bs-platform/lib/js/caml_obj.js\");\n\nvar UrlUtils = require(\"../../../shared/utils/UrlUtils.bs.js\");\n\nvar ArrayUtils = require(\"../../../shared/utils/ArrayUtils.bs.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar Json_encode = require(\"@glennsl/bs-json/src/Json_encode.bs.js\");\n\nvar OptionUtils = require(\"../../../shared/utils/OptionUtils.bs.js\");\n\nvar TargetChecklistItem = require(\"../../../schools/courses/types/curriculum_editor/TargetChecklistItem.bs.js\");\n\nvar SubmissionChecklistItem = require(\"../../review/types/SubmissionChecklistItem.bs.js\");\n\nfunction title(t) {\n  return t.title;\n}\n\nfunction result(t) {\n  return t.result;\n}\n\nfunction optional(t) {\n  return t.optional;\n}\n\nfunction make(result, title, optional) {\n  return {\n    title: title,\n    optional: optional,\n    result: result\n  };\n}\n\nfunction fromTargetChecklistItem(targetChecklist) {\n  return $$Array.map(function (tc) {\n    var title = TargetChecklistItem.title(tc);\n    var optional = TargetChecklistItem.optional(tc);\n    var match = TargetChecklistItem.kind(tc);\n    var result;\n\n    if (typeof match === \"number\") {\n      switch (match) {\n        case\n        /* Files */\n        0:\n          result =\n          /* Files */\n          Block.__(0, [[]]);\n          break;\n\n        case\n        /* Link */\n        1:\n          result =\n          /* Link */\n          Block.__(1, [\"\"]);\n          break;\n\n        case\n        /* ShortText */\n        2:\n          result =\n          /* ShortText */\n          Block.__(2, [\"\"]);\n          break;\n\n        case\n        /* LongText */\n        3:\n          result =\n          /* LongText */\n          Block.__(3, [\"\"]);\n          break;\n      }\n    } else {\n      result =\n      /* MultiChoice */\n      Block.__(4, [match[0], undefined]);\n    }\n\n    return {\n      title: title,\n      optional: optional,\n      result: result\n    };\n  }, targetChecklist);\n}\n\nfunction updateResultAtIndex(index, result, checklist) {\n  return $$Array.mapi(function (i, c) {\n    if (i === index) {\n      return {\n        title: c.title,\n        optional: c.optional,\n        result: result\n      };\n    } else {\n      return c;\n    }\n  }, checklist);\n}\n\nfunction makeFile(id, name) {\n  return {\n    id: id,\n    name: name\n  };\n}\n\nfunction filename(file) {\n  return file.name;\n}\n\nfunction fileId(file) {\n  return file.id;\n}\n\nfunction fileIds(checklist) {\n  return ArrayUtils.flatten($$Array.map(function (c) {\n    var _anyOtherResult = c.result;\n\n    if (_anyOtherResult.tag) {\n      return (\n        /* [] */\n        0\n      );\n    } else {\n      return $$Array.to_list($$Array.map(function (a) {\n        return a.id;\n      }, _anyOtherResult[0]));\n    }\n  }, checklist));\n}\n\nfunction kindAsString(t) {\n  var match = t.result;\n\n  switch (match.tag | 0) {\n    case\n    /* Files */\n    0:\n      return \"files\";\n\n    case\n    /* Link */\n    1:\n      return \"link\";\n\n    case\n    /* ShortText */\n    2:\n      return \"shortText\";\n\n    case\n    /* LongText */\n    3:\n      return \"longText\";\n\n    case\n    /* MultiChoice */\n    4:\n      return \"multiChoice\";\n  }\n}\n\nfunction resultAsString(t) {\n  var match = t.result;\n\n  switch (match.tag | 0) {\n    case\n    /* Files */\n    0:\n      return \"files\";\n\n    case\n    /* MultiChoice */\n    4:\n      var choices = match[0];\n      return OptionUtils.$$default(\"\", OptionUtils.flatMap(function (i) {\n        return ArrayUtils.getOpt(i, choices);\n      }, match[1]));\n\n    default:\n      return match[0];\n  }\n}\n\nfunction validString(s, maxLength) {\n  var length = $$String.trim(s).length;\n\n  if (length >= 1) {\n    return length <= maxLength;\n  } else {\n    return false;\n  }\n}\n\nfunction validShortText(s) {\n  return validString(s, 250);\n}\n\nfunction validLongText(s) {\n  return validString(s, 5000);\n}\n\nfunction validFiles(files) {\n  if (Caml_obj.caml_notequal(files, [])) {\n    return files.length < 3;\n  } else {\n    return false;\n  }\n}\n\nfunction validMultiChoice(choices, index) {\n  return OptionUtils.mapWithDefault(function (i) {\n    return choices.length > i;\n  }, false, index);\n}\n\nfunction validResponse(response, allowBlank) {\n  var optional = allowBlank ? response.optional : false;\n  var match = response.result;\n\n  switch (match.tag | 0) {\n    case\n    /* Files */\n    0:\n      var files = match[0];\n\n      if (optional && ArrayUtils.isEmpty(files)) {\n        return true;\n      } else {\n        return validFiles(files);\n      }\n\n    case\n    /* Link */\n    1:\n      var link = match[0];\n\n      if (optional) {\n        return UrlUtils.isValid(true, link);\n      } else {\n        return UrlUtils.isValid(false, link);\n      }\n\n    case\n    /* ShortText */\n    2:\n      var t = match[0];\n\n      if (optional) {\n        if (validString(t, 250)) {\n          return true;\n        } else {\n          return t === \"\";\n        }\n      } else {\n        return validString(t, 250);\n      }\n\n    case\n    /* LongText */\n    3:\n      var t$1 = match[0];\n\n      if (optional) {\n        if (validString(t$1, 5000)) {\n          return true;\n        } else {\n          return t$1 === \"\";\n        }\n      } else {\n        return validString(t$1, 5000);\n      }\n\n    case\n    /* MultiChoice */\n    4:\n      var index = match[1];\n      var choices = match[0];\n\n      if (optional) {\n        if (validMultiChoice(choices, index)) {\n          return true;\n        } else {\n          return index === undefined;\n        }\n      } else {\n        return validMultiChoice(choices, index);\n      }\n\n  }\n}\n\nfunction validChecklist(checklist) {\n  return ArrayUtils.isEmpty($$Array.map(function (c) {\n    return validResponse(c, true);\n  }, checklist).filter(function (c) {\n    return !c;\n  }));\n}\n\nfunction validResonses(responses) {\n  return responses.filter(function (c) {\n    return validResponse(c, false);\n  });\n}\n\nfunction encode(t) {\n  return Json_encode.object_(\n  /* :: */\n  [\n  /* tuple */\n  [\"title\", t.title],\n  /* :: */\n  [\n  /* tuple */\n  [\"kind\", kindAsString(t)],\n  /* :: */\n  [\n  /* tuple */\n  [\"status\", \"noAnswer\"],\n  /* :: */\n  [\n  /* tuple */\n  [\"result\", resultAsString(t)],\n  /* [] */\n  0]]]]);\n}\n\nfunction encodeArray(checklist) {\n  return Json_encode.array(encode, validResonses(checklist));\n}\n\nfunction makeFiles(checklist) {\n  return $$Array.map(function (f) {\n    var url = \"/timeline_event_files/\" + (f.id + \"/download\");\n    return SubmissionChecklistItem.makeFile(f.name, url, f.id);\n  }, OptionUtils.mapWithDefault(function (c) {\n    var _anyOtherResult = c.result;\n\n    if (_anyOtherResult.tag) {\n      return [];\n    } else {\n      return _anyOtherResult[0];\n    }\n  }, [], Caml_option.undefined_to_opt(checklist.find(function (c) {\n    var _anyOtherResult = c.result;\n\n    if (_anyOtherResult.tag) {\n      return false;\n    } else {\n      return true;\n    }\n  }))));\n}\n\nexports.title = title;\nexports.result = result;\nexports.optional = optional;\nexports.make = make;\nexports.fromTargetChecklistItem = fromTargetChecklistItem;\nexports.updateResultAtIndex = updateResultAtIndex;\nexports.makeFile = makeFile;\nexports.filename = filename;\nexports.fileId = fileId;\nexports.fileIds = fileIds;\nexports.kindAsString = kindAsString;\nexports.resultAsString = resultAsString;\nexports.validString = validString;\nexports.validShortText = validShortText;\nexports.validLongText = validLongText;\nexports.validFiles = validFiles;\nexports.validMultiChoice = validMultiChoice;\nexports.validResponse = validResponse;\nexports.validChecklist = validChecklist;\nexports.validResonses = validResonses;\nexports.encode = encode;\nexports.encodeArray = encodeArray;\nexports.makeFiles = makeFiles;\n/* UrlUtils Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/courses/curricula/types/CoursesCurriculum__ChecklistItem.bs.js"],"names":["$$Array","require","Block","$$String","Caml_obj","UrlUtils","ArrayUtils","Caml_option","Json_encode","OptionUtils","TargetChecklistItem","SubmissionChecklistItem","title","t","result","optional","make","fromTargetChecklistItem","targetChecklist","map","tc","match","kind","__","undefined","updateResultAtIndex","index","checklist","mapi","i","c","makeFile","id","name","filename","file","fileId","fileIds","flatten","_anyOtherResult","tag","to_list","a","kindAsString","resultAsString","choices","$$default","flatMap","getOpt","validString","s","maxLength","length","trim","validShortText","validLongText","validFiles","files","caml_notequal","validMultiChoice","mapWithDefault","validResponse","response","allowBlank","isEmpty","link","isValid","t$1","validChecklist","filter","validResonses","responses","encode","object_","encodeArray","array","makeFiles","f","url","undefined_to_opt","find","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\nvar Block = require(\"bs-platform/lib/js/block.js\");\nvar $$String = require(\"bs-platform/lib/js/string.js\");\nvar Caml_obj = require(\"bs-platform/lib/js/caml_obj.js\");\nvar UrlUtils = require(\"../../../shared/utils/UrlUtils.bs.js\");\nvar ArrayUtils = require(\"../../../shared/utils/ArrayUtils.bs.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar Json_encode = require(\"@glennsl/bs-json/src/Json_encode.bs.js\");\nvar OptionUtils = require(\"../../../shared/utils/OptionUtils.bs.js\");\nvar TargetChecklistItem = require(\"../../../schools/courses/types/curriculum_editor/TargetChecklistItem.bs.js\");\nvar SubmissionChecklistItem = require(\"../../review/types/SubmissionChecklistItem.bs.js\");\n\nfunction title(t) {\n  return t.title;\n}\n\nfunction result(t) {\n  return t.result;\n}\n\nfunction optional(t) {\n  return t.optional;\n}\n\nfunction make(result, title, optional) {\n  return {\n          title: title,\n          optional: optional,\n          result: result\n        };\n}\n\nfunction fromTargetChecklistItem(targetChecklist) {\n  return $$Array.map((function (tc) {\n                var title = TargetChecklistItem.title(tc);\n                var optional = TargetChecklistItem.optional(tc);\n                var match = TargetChecklistItem.kind(tc);\n                var result;\n                if (typeof match === \"number\") {\n                  switch (match) {\n                    case /* Files */0 :\n                        result = /* Files */Block.__(0, [[]]);\n                        break;\n                    case /* Link */1 :\n                        result = /* Link */Block.__(1, [\"\"]);\n                        break;\n                    case /* ShortText */2 :\n                        result = /* ShortText */Block.__(2, [\"\"]);\n                        break;\n                    case /* LongText */3 :\n                        result = /* LongText */Block.__(3, [\"\"]);\n                        break;\n                    \n                  }\n                } else {\n                  result = /* MultiChoice */Block.__(4, [\n                      match[0],\n                      undefined\n                    ]);\n                }\n                return {\n                        title: title,\n                        optional: optional,\n                        result: result\n                      };\n              }), targetChecklist);\n}\n\nfunction updateResultAtIndex(index, result, checklist) {\n  return $$Array.mapi((function (i, c) {\n                if (i === index) {\n                  return {\n                          title: c.title,\n                          optional: c.optional,\n                          result: result\n                        };\n                } else {\n                  return c;\n                }\n              }), checklist);\n}\n\nfunction makeFile(id, name) {\n  return {\n          id: id,\n          name: name\n        };\n}\n\nfunction filename(file) {\n  return file.name;\n}\n\nfunction fileId(file) {\n  return file.id;\n}\n\nfunction fileIds(checklist) {\n  return ArrayUtils.flatten($$Array.map((function (c) {\n                    var _anyOtherResult = c.result;\n                    if (_anyOtherResult.tag) {\n                      return /* [] */0;\n                    } else {\n                      return $$Array.to_list($$Array.map((function (a) {\n                                        return a.id;\n                                      }), _anyOtherResult[0]));\n                    }\n                  }), checklist));\n}\n\nfunction kindAsString(t) {\n  var match = t.result;\n  switch (match.tag | 0) {\n    case /* Files */0 :\n        return \"files\";\n    case /* Link */1 :\n        return \"link\";\n    case /* ShortText */2 :\n        return \"shortText\";\n    case /* LongText */3 :\n        return \"longText\";\n    case /* MultiChoice */4 :\n        return \"multiChoice\";\n    \n  }\n}\n\nfunction resultAsString(t) {\n  var match = t.result;\n  switch (match.tag | 0) {\n    case /* Files */0 :\n        return \"files\";\n    case /* MultiChoice */4 :\n        var choices = match[0];\n        return OptionUtils.$$default(\"\", OptionUtils.flatMap((function (i) {\n                          return ArrayUtils.getOpt(i, choices);\n                        }), match[1]));\n    default:\n      return match[0];\n  }\n}\n\nfunction validString(s, maxLength) {\n  var length = $$String.trim(s).length;\n  if (length >= 1) {\n    return length <= maxLength;\n  } else {\n    return false;\n  }\n}\n\nfunction validShortText(s) {\n  return validString(s, 250);\n}\n\nfunction validLongText(s) {\n  return validString(s, 5000);\n}\n\nfunction validFiles(files) {\n  if (Caml_obj.caml_notequal(files, [])) {\n    return files.length < 3;\n  } else {\n    return false;\n  }\n}\n\nfunction validMultiChoice(choices, index) {\n  return OptionUtils.mapWithDefault((function (i) {\n                return choices.length > i;\n              }), false, index);\n}\n\nfunction validResponse(response, allowBlank) {\n  var optional = allowBlank ? response.optional : false;\n  var match = response.result;\n  switch (match.tag | 0) {\n    case /* Files */0 :\n        var files = match[0];\n        if (optional && ArrayUtils.isEmpty(files)) {\n          return true;\n        } else {\n          return validFiles(files);\n        }\n    case /* Link */1 :\n        var link = match[0];\n        if (optional) {\n          return UrlUtils.isValid(true, link);\n        } else {\n          return UrlUtils.isValid(false, link);\n        }\n    case /* ShortText */2 :\n        var t = match[0];\n        if (optional) {\n          if (validString(t, 250)) {\n            return true;\n          } else {\n            return t === \"\";\n          }\n        } else {\n          return validString(t, 250);\n        }\n    case /* LongText */3 :\n        var t$1 = match[0];\n        if (optional) {\n          if (validString(t$1, 5000)) {\n            return true;\n          } else {\n            return t$1 === \"\";\n          }\n        } else {\n          return validString(t$1, 5000);\n        }\n    case /* MultiChoice */4 :\n        var index = match[1];\n        var choices = match[0];\n        if (optional) {\n          if (validMultiChoice(choices, index)) {\n            return true;\n          } else {\n            return index === undefined;\n          }\n        } else {\n          return validMultiChoice(choices, index);\n        }\n    \n  }\n}\n\nfunction validChecklist(checklist) {\n  return ArrayUtils.isEmpty($$Array.map((function (c) {\n                      return validResponse(c, true);\n                    }), checklist).filter((function (c) {\n                    return !c;\n                  })));\n}\n\nfunction validResonses(responses) {\n  return responses.filter((function (c) {\n                return validResponse(c, false);\n              }));\n}\n\nfunction encode(t) {\n  return Json_encode.object_(/* :: */[\n              /* tuple */[\n                \"title\",\n                t.title\n              ],\n              /* :: */[\n                /* tuple */[\n                  \"kind\",\n                  kindAsString(t)\n                ],\n                /* :: */[\n                  /* tuple */[\n                    \"status\",\n                    \"noAnswer\"\n                  ],\n                  /* :: */[\n                    /* tuple */[\n                      \"result\",\n                      resultAsString(t)\n                    ],\n                    /* [] */0\n                  ]\n                ]\n              ]\n            ]);\n}\n\nfunction encodeArray(checklist) {\n  return Json_encode.array(encode, validResonses(checklist));\n}\n\nfunction makeFiles(checklist) {\n  return $$Array.map((function (f) {\n                var url = \"/timeline_event_files/\" + (f.id + \"/download\");\n                return SubmissionChecklistItem.makeFile(f.name, url, f.id);\n              }), OptionUtils.mapWithDefault((function (c) {\n                    var _anyOtherResult = c.result;\n                    if (_anyOtherResult.tag) {\n                      return [];\n                    } else {\n                      return _anyOtherResult[0];\n                    }\n                  }), [], Caml_option.undefined_to_opt(checklist.find((function (c) {\n                            var _anyOtherResult = c.result;\n                            if (_anyOtherResult.tag) {\n                              return false;\n                            } else {\n                              return true;\n                            }\n                          })))));\n}\n\nexports.title = title;\nexports.result = result;\nexports.optional = optional;\nexports.make = make;\nexports.fromTargetChecklistItem = fromTargetChecklistItem;\nexports.updateResultAtIndex = updateResultAtIndex;\nexports.makeFile = makeFile;\nexports.filename = filename;\nexports.fileId = fileId;\nexports.fileIds = fileIds;\nexports.kindAsString = kindAsString;\nexports.resultAsString = resultAsString;\nexports.validString = validString;\nexports.validShortText = validShortText;\nexports.validLongText = validLongText;\nexports.validFiles = validFiles;\nexports.validMultiChoice = validMultiChoice;\nexports.validResponse = validResponse;\nexports.validChecklist = validChecklist;\nexports.validResonses = validResonses;\nexports.encode = encode;\nexports.encodeArray = encodeArray;\nexports.makeFiles = makeFiles;\n/* UrlUtils Not a pure module */\n"]},"metadata":{},"sourceType":"module"}