{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../../../../shared/Api.bs.js\");\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\n\nvar Block = require(\"bs-platform/lib/js/block.js\");\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar ArrayUtils = require(\"../../../../shared/utils/ArrayUtils.bs.js\");\n\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\n\nvar Json_encode = require(\"@glennsl/bs-json/src/Json_encode.bs.js\");\n\nvar $$Notification = require(\"../../../../shared/Notification.bs.js\");\n\nvar AuthenticityToken = require(\"../../../../shared/utils/AuthenticityToken.bs.js\");\n\nvar MultiselectInline = require(\"../../../../packages/multiselect-inline/src/components/MultiselectInline.bs.js\");\n\nvar CourseCoaches__CourseCoach = require(\"../../types/course_coaches/CourseCoaches__CourseCoach.bs.js\");\n\nvar CourseCoaches__SchoolCoach = require(\"../../types/course_coaches/CourseCoaches__SchoolCoach.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    return {\n      courseCoaches: state.courseCoaches,\n      coachSearchInput: state.coachSearchInput,\n      saving: !state.saving\n    };\n  } else if (action.tag) {\n    return {\n      courseCoaches: state.courseCoaches,\n      coachSearchInput: action[0],\n      saving: state.saving\n    };\n  } else {\n    return {\n      courseCoaches: action[0],\n      coachSearchInput: state.coachSearchInput,\n      saving: state.saving\n    };\n  }\n}\n\nfunction makePayload(state) {\n  var payload = {};\n  payload[\"authenticity_token\"] = AuthenticityToken.fromHead(\n  /* () */\n  0);\n  payload[\"coach_ids\"] = Json_encode.array(function (prim) {\n    return prim;\n  }, state.courseCoaches);\n  return payload;\n}\n\nvar value = CourseCoaches__SchoolCoach.name;\nvar SelectableCourseCoaches = {\n  value: value,\n  searchString: value\n};\n\nfunction setCoachSearchInput(send, value) {\n  return Curry._1(send,\n  /* UpdateCoachSearchInput */\n  Block.__(1, [value]));\n}\n\nfunction selectCoach(send, state, coach) {\n  var updatedCoaches = state.courseCoaches.concat([CourseCoaches__SchoolCoach.id(coach)]);\n  return Curry._1(send,\n  /* UpdateCoachesList */\n  Block.__(0, [updatedCoaches]));\n}\n\nfunction deSelectCoach(send, state, coach) {\n  var updatedCoaches = state.courseCoaches.filter(function (coachId) {\n    return coachId !== CourseCoaches__SchoolCoach.id(coach);\n  });\n  return Curry._1(send,\n  /* UpdateCoachesList */\n  Block.__(0, [updatedCoaches]));\n}\n\nvar MultiselectForCourseCoaches = MultiselectInline.Make(SelectableCourseCoaches);\n\nfunction courseCoachEditor(coaches, state, send) {\n  var selected = coaches.filter(function (coach) {\n    return $$Array.mem(CourseCoaches__SchoolCoach.id(coach), state.courseCoaches);\n  });\n  var unselected = coaches.filter(function (coach) {\n    return !$$Array.mem(CourseCoaches__SchoolCoach.id(coach), state.courseCoaches);\n  });\n  return React.createElement(MultiselectForCourseCoaches.make, {\n    placeholder: \"Search coaches\",\n    onChange: function onChange(param) {\n      return Curry._1(send,\n      /* UpdateCoachSearchInput */\n      Block.__(1, [param]));\n    },\n    value: state.coachSearchInput,\n    unselected: unselected,\n    selected: selected,\n    onSelect: function onSelect(param) {\n      return selectCoach(send, state, param);\n    },\n    onDeselect: function onDeselect(param) {\n      return deSelectCoach(send, state, param);\n    },\n    emptySelectionMessage: \"No coaches selected\",\n    allItemsSelectedMessage: \"You have selected all coaches!\"\n  });\n}\n\nfunction handleResponseCB(updateCoachesCB, json) {\n  var courseCoaches = Json_decode.field(\"course_coaches\", function (param) {\n    return Json_decode.array(CourseCoaches__CourseCoach.decode, param);\n  }, json);\n\n  Curry._1(updateCoachesCB, courseCoaches);\n\n  return $$Notification.success(\"Success\", \"Coach enrollments updated successfully\");\n}\n\nfunction updateCourseCoaches(state, send, courseId, updateCoachesCB) {\n  Curry._1(send,\n  /* ToggleSaving */\n  0);\n\n  var payload = makePayload(state);\n  var url = \"/school/courses/\" + (courseId + \"/update_coach_enrollments\");\n  return Api.create(url, payload, function (param) {\n    return handleResponseCB(updateCoachesCB, param);\n  }, function (param) {\n    return Curry._1(send,\n    /* ToggleSaving */\n    0);\n  });\n}\n\nfunction computeAvailableCoaches(schoolCoaches, courseCoaches) {\n  var courseCoachIds = $$Array.map(CourseCoaches__CourseCoach.id, courseCoaches);\n  return schoolCoaches.filter(function (coach) {\n    return !$$Array.mem(CourseCoaches__SchoolCoach.id(coach), courseCoachIds);\n  });\n}\n\nfunction CourseCoaches__EnrollmentForm(Props) {\n  var schoolCoaches = Props.schoolCoaches;\n  var courseCoaches = Props.courseCoaches;\n  var courseId = Props.courseId;\n  var updateCoachesCB = Props.updateCoachesCB;\n  var match = React.useReducer(reducer, {\n    courseCoaches: [],\n    coachSearchInput: \"\",\n    saving: false\n  });\n  var send = match[1];\n  var state = match[0];\n  var coaches = computeAvailableCoaches(schoolCoaches, courseCoaches);\n  var saveDisabled = ArrayUtils.isEmpty(state.courseCoaches) || state.saving;\n  return React.createElement(\"div\", {\n    className: \"w-full\"\n  }, React.createElement(\"div\", {\n    className: \"w-full\"\n  }, React.createElement(\"div\", {\n    className: \"mx-auto bg-white\"\n  }, React.createElement(\"div\", {\n    className: \"max-w-2xl pt-6 px-6 mx-auto\"\n  }, React.createElement(\"h5\", {\n    className: \"uppercase text-center border-b border-gray-400 pb-2 mb-4\"\n  }, \"ASSIGN COACHES TO THE COURSE\"), coaches.length !== 0 ? React.createElement(\"div\", undefined, React.createElement(\"div\", {\n    id: \"course_coaches\"\n  }, React.createElement(\"span\", {\n    className: \"inline-block mr-1 mb-2 text-xs font-semibold\"\n  }, \"Select coaches:\"), courseCoachEditor(coaches, state, send))) : null), React.createElement(\"div\", {\n    className: \"flex max-w-2xl w-full mt-5 px-6 pb-5 mx-auto\"\n  }, React.createElement(\"button\", {\n    className: \"w-full btn btn-primary btn-large\",\n    disabled: saveDisabled,\n    onClick: function onClick(_e) {\n      return updateCourseCoaches(state, send, courseId, updateCoachesCB);\n    }\n  }, \"Add Course Coaches\")))));\n}\n\nvar make = CourseCoaches__EnrollmentForm;\nexports.str = str;\nexports.reducer = reducer;\nexports.makePayload = makePayload;\nexports.SelectableCourseCoaches = SelectableCourseCoaches;\nexports.setCoachSearchInput = setCoachSearchInput;\nexports.selectCoach = selectCoach;\nexports.deSelectCoach = deSelectCoach;\nexports.MultiselectForCourseCoaches = MultiselectForCourseCoaches;\nexports.courseCoachEditor = courseCoachEditor;\nexports.handleResponseCB = handleResponseCB;\nexports.updateCourseCoaches = updateCourseCoaches;\nexports.computeAvailableCoaches = computeAvailableCoaches;\nexports.make = make;\n/* MultiselectForCourseCoaches Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/schools/courses/components/course_coaches/CourseCoaches__EnrollmentForm.bs.js"],"names":["Api","require","$$Array","Block","Curry","React","ArrayUtils","Json_decode","Json_encode","$$Notification","AuthenticityToken","MultiselectInline","CourseCoaches__CourseCoach","CourseCoaches__SchoolCoach","str","prim","reducer","state","action","courseCoaches","coachSearchInput","saving","tag","makePayload","payload","fromHead","array","value","name","SelectableCourseCoaches","searchString","setCoachSearchInput","send","_1","__","selectCoach","coach","updatedCoaches","concat","id","deSelectCoach","filter","coachId","MultiselectForCourseCoaches","Make","courseCoachEditor","coaches","selected","mem","unselected","createElement","make","placeholder","onChange","param","onSelect","onDeselect","emptySelectionMessage","allItemsSelectedMessage","handleResponseCB","updateCoachesCB","json","field","decode","success","updateCourseCoaches","courseId","url","create","computeAvailableCoaches","schoolCoaches","courseCoachIds","map","CourseCoaches__EnrollmentForm","Props","match","useReducer","saveDisabled","isEmpty","className","length","undefined","disabled","onClick","_e","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../../../../shared/Api.bs.js\");\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\nvar Block = require(\"bs-platform/lib/js/block.js\");\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar ArrayUtils = require(\"../../../../shared/utils/ArrayUtils.bs.js\");\nvar Json_decode = require(\"@glennsl/bs-json/src/Json_decode.bs.js\");\nvar Json_encode = require(\"@glennsl/bs-json/src/Json_encode.bs.js\");\nvar $$Notification = require(\"../../../../shared/Notification.bs.js\");\nvar AuthenticityToken = require(\"../../../../shared/utils/AuthenticityToken.bs.js\");\nvar MultiselectInline = require(\"../../../../packages/multiselect-inline/src/components/MultiselectInline.bs.js\");\nvar CourseCoaches__CourseCoach = require(\"../../types/course_coaches/CourseCoaches__CourseCoach.bs.js\");\nvar CourseCoaches__SchoolCoach = require(\"../../types/course_coaches/CourseCoaches__SchoolCoach.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    return {\n            courseCoaches: state.courseCoaches,\n            coachSearchInput: state.coachSearchInput,\n            saving: !state.saving\n          };\n  } else if (action.tag) {\n    return {\n            courseCoaches: state.courseCoaches,\n            coachSearchInput: action[0],\n            saving: state.saving\n          };\n  } else {\n    return {\n            courseCoaches: action[0],\n            coachSearchInput: state.coachSearchInput,\n            saving: state.saving\n          };\n  }\n}\n\nfunction makePayload(state) {\n  var payload = { };\n  payload[\"authenticity_token\"] = AuthenticityToken.fromHead(/* () */0);\n  payload[\"coach_ids\"] = Json_encode.array((function (prim) {\n          return prim;\n        }), state.courseCoaches);\n  return payload;\n}\n\nvar value = CourseCoaches__SchoolCoach.name;\n\nvar SelectableCourseCoaches = {\n  value: value,\n  searchString: value\n};\n\nfunction setCoachSearchInput(send, value) {\n  return Curry._1(send, /* UpdateCoachSearchInput */Block.__(1, [value]));\n}\n\nfunction selectCoach(send, state, coach) {\n  var updatedCoaches = state.courseCoaches.concat([CourseCoaches__SchoolCoach.id(coach)]);\n  return Curry._1(send, /* UpdateCoachesList */Block.__(0, [updatedCoaches]));\n}\n\nfunction deSelectCoach(send, state, coach) {\n  var updatedCoaches = state.courseCoaches.filter((function (coachId) {\n          return coachId !== CourseCoaches__SchoolCoach.id(coach);\n        }));\n  return Curry._1(send, /* UpdateCoachesList */Block.__(0, [updatedCoaches]));\n}\n\nvar MultiselectForCourseCoaches = MultiselectInline.Make(SelectableCourseCoaches);\n\nfunction courseCoachEditor(coaches, state, send) {\n  var selected = coaches.filter((function (coach) {\n          return $$Array.mem(CourseCoaches__SchoolCoach.id(coach), state.courseCoaches);\n        }));\n  var unselected = coaches.filter((function (coach) {\n          return !$$Array.mem(CourseCoaches__SchoolCoach.id(coach), state.courseCoaches);\n        }));\n  return React.createElement(MultiselectForCourseCoaches.make, {\n              placeholder: \"Search coaches\",\n              onChange: (function (param) {\n                  return Curry._1(send, /* UpdateCoachSearchInput */Block.__(1, [param]));\n                }),\n              value: state.coachSearchInput,\n              unselected: unselected,\n              selected: selected,\n              onSelect: (function (param) {\n                  return selectCoach(send, state, param);\n                }),\n              onDeselect: (function (param) {\n                  return deSelectCoach(send, state, param);\n                }),\n              emptySelectionMessage: \"No coaches selected\",\n              allItemsSelectedMessage: \"You have selected all coaches!\"\n            });\n}\n\nfunction handleResponseCB(updateCoachesCB, json) {\n  var courseCoaches = Json_decode.field(\"course_coaches\", (function (param) {\n          return Json_decode.array(CourseCoaches__CourseCoach.decode, param);\n        }), json);\n  Curry._1(updateCoachesCB, courseCoaches);\n  return $$Notification.success(\"Success\", \"Coach enrollments updated successfully\");\n}\n\nfunction updateCourseCoaches(state, send, courseId, updateCoachesCB) {\n  Curry._1(send, /* ToggleSaving */0);\n  var payload = makePayload(state);\n  var url = \"/school/courses/\" + (courseId + \"/update_coach_enrollments\");\n  return Api.create(url, payload, (function (param) {\n                return handleResponseCB(updateCoachesCB, param);\n              }), (function (param) {\n                return Curry._1(send, /* ToggleSaving */0);\n              }));\n}\n\nfunction computeAvailableCoaches(schoolCoaches, courseCoaches) {\n  var courseCoachIds = $$Array.map(CourseCoaches__CourseCoach.id, courseCoaches);\n  return schoolCoaches.filter((function (coach) {\n                return !$$Array.mem(CourseCoaches__SchoolCoach.id(coach), courseCoachIds);\n              }));\n}\n\nfunction CourseCoaches__EnrollmentForm(Props) {\n  var schoolCoaches = Props.schoolCoaches;\n  var courseCoaches = Props.courseCoaches;\n  var courseId = Props.courseId;\n  var updateCoachesCB = Props.updateCoachesCB;\n  var match = React.useReducer(reducer, {\n        courseCoaches: [],\n        coachSearchInput: \"\",\n        saving: false\n      });\n  var send = match[1];\n  var state = match[0];\n  var coaches = computeAvailableCoaches(schoolCoaches, courseCoaches);\n  var saveDisabled = ArrayUtils.isEmpty(state.courseCoaches) || state.saving;\n  return React.createElement(\"div\", {\n              className: \"w-full\"\n            }, React.createElement(\"div\", {\n                  className: \"w-full\"\n                }, React.createElement(\"div\", {\n                      className: \"mx-auto bg-white\"\n                    }, React.createElement(\"div\", {\n                          className: \"max-w-2xl pt-6 px-6 mx-auto\"\n                        }, React.createElement(\"h5\", {\n                              className: \"uppercase text-center border-b border-gray-400 pb-2 mb-4\"\n                            }, \"ASSIGN COACHES TO THE COURSE\"), coaches.length !== 0 ? React.createElement(\"div\", undefined, React.createElement(\"div\", {\n                                    id: \"course_coaches\"\n                                  }, React.createElement(\"span\", {\n                                        className: \"inline-block mr-1 mb-2 text-xs font-semibold\"\n                                      }, \"Select coaches:\"), courseCoachEditor(coaches, state, send))) : null), React.createElement(\"div\", {\n                          className: \"flex max-w-2xl w-full mt-5 px-6 pb-5 mx-auto\"\n                        }, React.createElement(\"button\", {\n                              className: \"w-full btn btn-primary btn-large\",\n                              disabled: saveDisabled,\n                              onClick: (function (_e) {\n                                  return updateCourseCoaches(state, send, courseId, updateCoachesCB);\n                                })\n                            }, \"Add Course Coaches\")))));\n}\n\nvar make = CourseCoaches__EnrollmentForm;\n\nexports.str = str;\nexports.reducer = reducer;\nexports.makePayload = makePayload;\nexports.SelectableCourseCoaches = SelectableCourseCoaches;\nexports.setCoachSearchInput = setCoachSearchInput;\nexports.selectCoach = selectCoach;\nexports.deSelectCoach = deSelectCoach;\nexports.MultiselectForCourseCoaches = MultiselectForCourseCoaches;\nexports.courseCoachEditor = courseCoachEditor;\nexports.handleResponseCB = handleResponseCB;\nexports.updateCourseCoaches = updateCourseCoaches;\nexports.computeAvailableCoaches = computeAvailableCoaches;\nexports.make = make;\n/* MultiselectForCourseCoaches Not a pure module */\n"]},"metadata":{},"sourceType":"module"}