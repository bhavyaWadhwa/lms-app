{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../../../shared/Api.bs.js\");\n\nvar Block = require(\"bs-platform/lib/js/block.js\");\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar Caml_array = require(\"bs-platform/lib/js/caml_array.js\");\n\nvar OptionUtils = require(\"../../../shared/utils/OptionUtils.bs.js\");\n\nvar $$Notification = require(\"../../../shared/Notification.bs.js\");\n\nvar DisablingCover = require(\"../../../shared/components/DisablingCover.bs.js\");\n\nvar School__InputGroupError = require(\"../../shared/components/School__InputGroupError.bs.js\");\n\nvar SchoolCustomize__Customizations = require(\"../types/SchoolCustomize__Customizations.bs.js\");\n\nvar SchoolCustomize__ImageFileInput = require(\"./SchoolCustomize__ImageFileInput.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction updateButtonText(updating) {\n  if (updating) {\n    return \"Updating...\";\n  } else {\n    return \"Update Images\";\n  }\n}\n\nvar formId = \"sc-images-editor__form\";\n\nfunction handleUpdateImages(send, updateImagesCB, $$event) {\n  $$event.preventDefault();\n\n  Curry._1(send,\n  /* BeginUpdate */\n  0);\n\n  var element = document.getElementById(formId);\n\n  if (element == null) {\n    return (\n      /* () */\n      0\n    );\n  } else {\n    return Api.sendFormData(\"/school/images\", new FormData(element), function (json) {\n      $$Notification.success(\"Done!\", \"Images have been updated successfully.\");\n\n      Curry._1(updateImagesCB, json);\n\n      return Curry._1(send,\n      /* DoneUpdating */\n      2);\n    }, function (param) {\n      return Curry._1(send,\n      /* ErrorOccured */\n      1);\n    });\n  }\n}\n\nfunction updateButtonDisabled(state) {\n  if (state.updating || !state.formDirty || state.logoOnLightBgInvalid) {\n    return true;\n  } else {\n    return state.iconInvalid;\n  }\n}\n\nfunction isInvalidImageFile(image) {\n  var match = image.type;\n  var tmp;\n\n  switch (match) {\n    case \"image/jpeg\":\n    case \"image/png\":\n      tmp = false;\n      break;\n\n    default:\n      tmp = true;\n  }\n\n  if (tmp) {\n    return true;\n  } else {\n    return image.size > 2097152;\n  }\n}\n\nfunction updateLogoOnLightBg(send, $$event) {\n  var imageFile = Caml_array.caml_array_get($$event.target.files, 0);\n  return Curry._1(send,\n  /* SelectLogoOnLightBgFile */\n  Block.__(0, [imageFile.name, isInvalidImageFile(imageFile)]));\n}\n\nfunction updateCoverImage(send, $$event) {\n  var imageFile = Caml_array.caml_array_get($$event.target.files, 0);\n  return Curry._1(send,\n  /* SelectCoverImageFile */\n  Block.__(1, [imageFile.name, isInvalidImageFile(imageFile)]));\n}\n\nfunction updateIcon(send, $$event) {\n  var imageFile = Caml_array.caml_array_get($$event.target.files, 0);\n  return Curry._1(send,\n  /* SelectIconFile */\n  Block.__(2, [imageFile.name, isInvalidImageFile(imageFile)]));\n}\n\nfunction imageUploader(id, disabled, name, onChange, labelText, optionalImageLabel, errorState, errorMessage) {\n  return React.createElement(\"div\", {\n    key: id,\n    className: \"mt-4\"\n  }, React.createElement(\"label\", {\n    className: \"block tracking-wide text-gray-800 text-xs font-semibold\",\n    htmlFor: id\n  }, labelText), React.createElement(\"input\", {\n    className: \"hidden\",\n    id: id,\n    accept: \".jpg,.jpeg,.png,.gif,image/x-png,image/gif,image/jpeg\",\n    disabled: disabled,\n    multiple: false,\n    name: name,\n    required: false,\n    type: \"file\",\n    onChange: onChange\n  }), React.createElement(\"label\", {\n    className: \"file-input-label mt-2\",\n    htmlFor: id\n  }, React.createElement(\"i\", {\n    className: \"fas fa-upload\"\n  }), React.createElement(\"span\", {\n    className: \"ml-2 truncate\"\n  }, optionalImageLabel)), React.createElement(School__InputGroupError.make, {\n    message: errorMessage,\n    active: errorState\n  }));\n}\n\nfunction initialState(param) {\n  return {\n    logoOnLightBgFilename: undefined,\n    logoOnLightBgInvalid: false,\n    coverImageFilename: undefined,\n    coverImageInvalid: false,\n    iconFilename: undefined,\n    iconInvalid: false,\n    updating: false,\n    formDirty: false\n  };\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    switch (action) {\n      case\n      /* BeginUpdate */\n      0:\n        return {\n          logoOnLightBgFilename: state.logoOnLightBgFilename,\n          logoOnLightBgInvalid: state.logoOnLightBgInvalid,\n          coverImageFilename: state.coverImageFilename,\n          coverImageInvalid: state.coverImageInvalid,\n          iconFilename: state.iconFilename,\n          iconInvalid: state.iconInvalid,\n          updating: true,\n          formDirty: state.formDirty\n        };\n\n      case\n      /* ErrorOccured */\n      1:\n        return {\n          logoOnLightBgFilename: state.logoOnLightBgFilename,\n          logoOnLightBgInvalid: state.logoOnLightBgInvalid,\n          coverImageFilename: state.coverImageFilename,\n          coverImageInvalid: state.coverImageInvalid,\n          iconFilename: state.iconFilename,\n          iconInvalid: state.iconInvalid,\n          updating: false,\n          formDirty: state.formDirty\n        };\n\n      case\n      /* DoneUpdating */\n      2:\n        return {\n          logoOnLightBgFilename: undefined,\n          logoOnLightBgInvalid: false,\n          coverImageFilename: undefined,\n          coverImageInvalid: false,\n          iconFilename: undefined,\n          iconInvalid: false,\n          updating: false,\n          formDirty: false\n        };\n    }\n  } else {\n    switch (action.tag | 0) {\n      case\n      /* SelectLogoOnLightBgFile */\n      0:\n        return {\n          logoOnLightBgFilename: action[0],\n          logoOnLightBgInvalid: action[1],\n          coverImageFilename: state.coverImageFilename,\n          coverImageInvalid: state.coverImageInvalid,\n          iconFilename: state.iconFilename,\n          iconInvalid: state.iconInvalid,\n          updating: state.updating,\n          formDirty: true\n        };\n\n      case\n      /* SelectCoverImageFile */\n      1:\n        return {\n          logoOnLightBgFilename: state.logoOnLightBgFilename,\n          logoOnLightBgInvalid: state.logoOnLightBgInvalid,\n          coverImageFilename: action[0],\n          coverImageInvalid: action[1],\n          iconFilename: state.iconFilename,\n          iconInvalid: state.iconInvalid,\n          updating: state.updating,\n          formDirty: true\n        };\n\n      case\n      /* SelectIconFile */\n      2:\n        return {\n          logoOnLightBgFilename: state.logoOnLightBgFilename,\n          logoOnLightBgInvalid: state.logoOnLightBgInvalid,\n          coverImageFilename: state.coverImageFilename,\n          coverImageInvalid: state.coverImageInvalid,\n          iconFilename: action[0],\n          iconInvalid: action[1],\n          updating: state.updating,\n          formDirty: true\n        };\n    }\n  }\n}\n\nfunction SchoolCustomize__ImagesEditor(Props) {\n  var customizations = Props.customizations;\n  var updateImagesCB = Props.updateImagesCB;\n  var authenticityToken = Props.authenticityToken;\n  var match = React.useReducer(reducer, {\n    logoOnLightBgFilename: undefined,\n    logoOnLightBgInvalid: false,\n    coverImageFilename: undefined,\n    coverImageInvalid: false,\n    iconFilename: undefined,\n    iconInvalid: false,\n    updating: false,\n    formDirty: false\n  });\n  var send = match[1];\n  var state = match[0];\n  var logoOnLightBg = SchoolCustomize__Customizations.logoOnLightBg(customizations);\n  var coverImage = SchoolCustomize__Customizations.coverImage(customizations);\n  var icon = SchoolCustomize__Customizations.icon(customizations);\n  return React.createElement(\"form\", {\n    key: \"sc-images-editor__form\",\n    className: \"mx-8 pt-8\",\n    id: formId,\n    onSubmit: function onSubmit(param) {\n      return handleUpdateImages(send, updateImagesCB, param);\n    }\n  }, React.createElement(\"input\", {\n    name: \"authenticity_token\",\n    type: \"hidden\",\n    value: authenticityToken\n  }), React.createElement(\"h5\", {\n    className: \"uppercase text-center border-b border-gray-400 pb-2\"\n  }, \"Manage Images\"), React.createElement(DisablingCover.make, {\n    disabled: state.updating,\n    children: null\n  }, React.createElement(SchoolCustomize__ImageFileInput.make, {\n    id: \"sc-images-editor__logo-on-400-bg-input\",\n    disabled: state.updating,\n    name: \"logo_on_light_bg\",\n    onChange: function onChange(param) {\n      return updateLogoOnLightBg(send, param);\n    },\n    labelText: \"Logo on a light background\",\n    imageName: OptionUtils.map(SchoolCustomize__Customizations.filename, logoOnLightBg),\n    selectedImageName: state.logoOnLightBgFilename,\n    errorState: state.logoOnLightBgInvalid\n  }), React.createElement(SchoolCustomize__ImageFileInput.make, {\n    id: \"sc-images-editor__icon-input\",\n    disabled: state.updating,\n    name: \"icon\",\n    onChange: function onChange(param) {\n      return updateIcon(send, param);\n    },\n    labelText: \"Icon\",\n    imageName: SchoolCustomize__Customizations.filename(icon),\n    selectedImageName: state.iconFilename,\n    errorState: state.iconInvalid\n  }), React.createElement(SchoolCustomize__ImageFileInput.make, {\n    id: \"sc-images-editor__cover-image-input\",\n    disabled: state.updating,\n    name: \"cover_image\",\n    onChange: function onChange(param) {\n      return updateCoverImage(send, param);\n    },\n    labelText: \"Cover image\",\n    imageName: OptionUtils.map(SchoolCustomize__Customizations.filename, coverImage),\n    selectedImageName: state.coverImageFilename,\n    errorState: state.coverImageInvalid\n  }), React.createElement(\"div\", {\n    className: \"flex justify-end\"\n  }, React.createElement(\"button\", {\n    key: \"sc-images-editor__update-button\",\n    className: \"btn btn-primary btn-large mt-6\",\n    disabled: updateButtonDisabled(state),\n    type: \"submit\"\n  }, state.updating ? \"Updating...\" : \"Update Images\"))));\n}\n\nvar maxAllowedSize = 2097152;\nvar make = SchoolCustomize__ImagesEditor;\nexports.str = str;\nexports.updateButtonText = updateButtonText;\nexports.formId = formId;\nexports.handleUpdateImages = handleUpdateImages;\nexports.updateButtonDisabled = updateButtonDisabled;\nexports.maxAllowedSize = maxAllowedSize;\nexports.isInvalidImageFile = isInvalidImageFile;\nexports.updateLogoOnLightBg = updateLogoOnLightBg;\nexports.updateCoverImage = updateCoverImage;\nexports.updateIcon = updateIcon;\nexports.imageUploader = imageUploader;\nexports.initialState = initialState;\nexports.reducer = reducer;\nexports.make = make;\n/* Api Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/schools/settings/components/SchoolCustomize__ImagesEditor.bs.js"],"names":["Api","require","Block","Curry","React","Caml_array","OptionUtils","$$Notification","DisablingCover","School__InputGroupError","SchoolCustomize__Customizations","SchoolCustomize__ImageFileInput","str","prim","updateButtonText","updating","formId","handleUpdateImages","send","updateImagesCB","$$event","preventDefault","_1","element","document","getElementById","sendFormData","FormData","json","success","param","updateButtonDisabled","state","formDirty","logoOnLightBgInvalid","iconInvalid","isInvalidImageFile","image","match","type","tmp","size","updateLogoOnLightBg","imageFile","caml_array_get","target","files","__","name","updateCoverImage","updateIcon","imageUploader","id","disabled","onChange","labelText","optionalImageLabel","errorState","errorMessage","createElement","key","className","htmlFor","accept","multiple","required","make","message","active","initialState","logoOnLightBgFilename","undefined","coverImageFilename","coverImageInvalid","iconFilename","reducer","action","tag","SchoolCustomize__ImagesEditor","Props","customizations","authenticityToken","useReducer","logoOnLightBg","coverImage","icon","onSubmit","value","children","imageName","map","filename","selectedImageName","maxAllowedSize","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar Api = require(\"../../../shared/Api.bs.js\");\nvar Block = require(\"bs-platform/lib/js/block.js\");\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar Caml_array = require(\"bs-platform/lib/js/caml_array.js\");\nvar OptionUtils = require(\"../../../shared/utils/OptionUtils.bs.js\");\nvar $$Notification = require(\"../../../shared/Notification.bs.js\");\nvar DisablingCover = require(\"../../../shared/components/DisablingCover.bs.js\");\nvar School__InputGroupError = require(\"../../shared/components/School__InputGroupError.bs.js\");\nvar SchoolCustomize__Customizations = require(\"../types/SchoolCustomize__Customizations.bs.js\");\nvar SchoolCustomize__ImageFileInput = require(\"./SchoolCustomize__ImageFileInput.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction updateButtonText(updating) {\n  if (updating) {\n    return \"Updating...\";\n  } else {\n    return \"Update Images\";\n  }\n}\n\nvar formId = \"sc-images-editor__form\";\n\nfunction handleUpdateImages(send, updateImagesCB, $$event) {\n  $$event.preventDefault();\n  Curry._1(send, /* BeginUpdate */0);\n  var element = document.getElementById(formId);\n  if (element == null) {\n    return /* () */0;\n  } else {\n    return Api.sendFormData(\"/school/images\", new FormData(element), (function (json) {\n                  $$Notification.success(\"Done!\", \"Images have been updated successfully.\");\n                  Curry._1(updateImagesCB, json);\n                  return Curry._1(send, /* DoneUpdating */2);\n                }), (function (param) {\n                  return Curry._1(send, /* ErrorOccured */1);\n                }));\n  }\n}\n\nfunction updateButtonDisabled(state) {\n  if (state.updating || !state.formDirty || state.logoOnLightBgInvalid) {\n    return true;\n  } else {\n    return state.iconInvalid;\n  }\n}\n\nfunction isInvalidImageFile(image) {\n  var match = image.type;\n  var tmp;\n  switch (match) {\n    case \"image/jpeg\" :\n    case \"image/png\" :\n        tmp = false;\n        break;\n    default:\n      tmp = true;\n  }\n  if (tmp) {\n    return true;\n  } else {\n    return image.size > 2097152;\n  }\n}\n\nfunction updateLogoOnLightBg(send, $$event) {\n  var imageFile = Caml_array.caml_array_get($$event.target.files, 0);\n  return Curry._1(send, /* SelectLogoOnLightBgFile */Block.__(0, [\n                imageFile.name,\n                isInvalidImageFile(imageFile)\n              ]));\n}\n\nfunction updateCoverImage(send, $$event) {\n  var imageFile = Caml_array.caml_array_get($$event.target.files, 0);\n  return Curry._1(send, /* SelectCoverImageFile */Block.__(1, [\n                imageFile.name,\n                isInvalidImageFile(imageFile)\n              ]));\n}\n\nfunction updateIcon(send, $$event) {\n  var imageFile = Caml_array.caml_array_get($$event.target.files, 0);\n  return Curry._1(send, /* SelectIconFile */Block.__(2, [\n                imageFile.name,\n                isInvalidImageFile(imageFile)\n              ]));\n}\n\nfunction imageUploader(id, disabled, name, onChange, labelText, optionalImageLabel, errorState, errorMessage) {\n  return React.createElement(\"div\", {\n              key: id,\n              className: \"mt-4\"\n            }, React.createElement(\"label\", {\n                  className: \"block tracking-wide text-gray-800 text-xs font-semibold\",\n                  htmlFor: id\n                }, labelText), React.createElement(\"input\", {\n                  className: \"hidden\",\n                  id: id,\n                  accept: \".jpg,.jpeg,.png,.gif,image/x-png,image/gif,image/jpeg\",\n                  disabled: disabled,\n                  multiple: false,\n                  name: name,\n                  required: false,\n                  type: \"file\",\n                  onChange: onChange\n                }), React.createElement(\"label\", {\n                  className: \"file-input-label mt-2\",\n                  htmlFor: id\n                }, React.createElement(\"i\", {\n                      className: \"fas fa-upload\"\n                    }), React.createElement(\"span\", {\n                      className: \"ml-2 truncate\"\n                    }, optionalImageLabel)), React.createElement(School__InputGroupError.make, {\n                  message: errorMessage,\n                  active: errorState\n                }));\n}\n\nfunction initialState(param) {\n  return {\n          logoOnLightBgFilename: undefined,\n          logoOnLightBgInvalid: false,\n          coverImageFilename: undefined,\n          coverImageInvalid: false,\n          iconFilename: undefined,\n          iconInvalid: false,\n          updating: false,\n          formDirty: false\n        };\n}\n\nfunction reducer(state, action) {\n  if (typeof action === \"number\") {\n    switch (action) {\n      case /* BeginUpdate */0 :\n          return {\n                  logoOnLightBgFilename: state.logoOnLightBgFilename,\n                  logoOnLightBgInvalid: state.logoOnLightBgInvalid,\n                  coverImageFilename: state.coverImageFilename,\n                  coverImageInvalid: state.coverImageInvalid,\n                  iconFilename: state.iconFilename,\n                  iconInvalid: state.iconInvalid,\n                  updating: true,\n                  formDirty: state.formDirty\n                };\n      case /* ErrorOccured */1 :\n          return {\n                  logoOnLightBgFilename: state.logoOnLightBgFilename,\n                  logoOnLightBgInvalid: state.logoOnLightBgInvalid,\n                  coverImageFilename: state.coverImageFilename,\n                  coverImageInvalid: state.coverImageInvalid,\n                  iconFilename: state.iconFilename,\n                  iconInvalid: state.iconInvalid,\n                  updating: false,\n                  formDirty: state.formDirty\n                };\n      case /* DoneUpdating */2 :\n          return {\n                  logoOnLightBgFilename: undefined,\n                  logoOnLightBgInvalid: false,\n                  coverImageFilename: undefined,\n                  coverImageInvalid: false,\n                  iconFilename: undefined,\n                  iconInvalid: false,\n                  updating: false,\n                  formDirty: false\n                };\n      \n    }\n  } else {\n    switch (action.tag | 0) {\n      case /* SelectLogoOnLightBgFile */0 :\n          return {\n                  logoOnLightBgFilename: action[0],\n                  logoOnLightBgInvalid: action[1],\n                  coverImageFilename: state.coverImageFilename,\n                  coverImageInvalid: state.coverImageInvalid,\n                  iconFilename: state.iconFilename,\n                  iconInvalid: state.iconInvalid,\n                  updating: state.updating,\n                  formDirty: true\n                };\n      case /* SelectCoverImageFile */1 :\n          return {\n                  logoOnLightBgFilename: state.logoOnLightBgFilename,\n                  logoOnLightBgInvalid: state.logoOnLightBgInvalid,\n                  coverImageFilename: action[0],\n                  coverImageInvalid: action[1],\n                  iconFilename: state.iconFilename,\n                  iconInvalid: state.iconInvalid,\n                  updating: state.updating,\n                  formDirty: true\n                };\n      case /* SelectIconFile */2 :\n          return {\n                  logoOnLightBgFilename: state.logoOnLightBgFilename,\n                  logoOnLightBgInvalid: state.logoOnLightBgInvalid,\n                  coverImageFilename: state.coverImageFilename,\n                  coverImageInvalid: state.coverImageInvalid,\n                  iconFilename: action[0],\n                  iconInvalid: action[1],\n                  updating: state.updating,\n                  formDirty: true\n                };\n      \n    }\n  }\n}\n\nfunction SchoolCustomize__ImagesEditor(Props) {\n  var customizations = Props.customizations;\n  var updateImagesCB = Props.updateImagesCB;\n  var authenticityToken = Props.authenticityToken;\n  var match = React.useReducer(reducer, {\n        logoOnLightBgFilename: undefined,\n        logoOnLightBgInvalid: false,\n        coverImageFilename: undefined,\n        coverImageInvalid: false,\n        iconFilename: undefined,\n        iconInvalid: false,\n        updating: false,\n        formDirty: false\n      });\n  var send = match[1];\n  var state = match[0];\n  var logoOnLightBg = SchoolCustomize__Customizations.logoOnLightBg(customizations);\n  var coverImage = SchoolCustomize__Customizations.coverImage(customizations);\n  var icon = SchoolCustomize__Customizations.icon(customizations);\n  return React.createElement(\"form\", {\n              key: \"sc-images-editor__form\",\n              className: \"mx-8 pt-8\",\n              id: formId,\n              onSubmit: (function (param) {\n                  return handleUpdateImages(send, updateImagesCB, param);\n                })\n            }, React.createElement(\"input\", {\n                  name: \"authenticity_token\",\n                  type: \"hidden\",\n                  value: authenticityToken\n                }), React.createElement(\"h5\", {\n                  className: \"uppercase text-center border-b border-gray-400 pb-2\"\n                }, \"Manage Images\"), React.createElement(DisablingCover.make, {\n                  disabled: state.updating,\n                  children: null\n                }, React.createElement(SchoolCustomize__ImageFileInput.make, {\n                      id: \"sc-images-editor__logo-on-400-bg-input\",\n                      disabled: state.updating,\n                      name: \"logo_on_light_bg\",\n                      onChange: (function (param) {\n                          return updateLogoOnLightBg(send, param);\n                        }),\n                      labelText: \"Logo on a light background\",\n                      imageName: OptionUtils.map(SchoolCustomize__Customizations.filename, logoOnLightBg),\n                      selectedImageName: state.logoOnLightBgFilename,\n                      errorState: state.logoOnLightBgInvalid\n                    }), React.createElement(SchoolCustomize__ImageFileInput.make, {\n                      id: \"sc-images-editor__icon-input\",\n                      disabled: state.updating,\n                      name: \"icon\",\n                      onChange: (function (param) {\n                          return updateIcon(send, param);\n                        }),\n                      labelText: \"Icon\",\n                      imageName: SchoolCustomize__Customizations.filename(icon),\n                      selectedImageName: state.iconFilename,\n                      errorState: state.iconInvalid\n                    }), React.createElement(SchoolCustomize__ImageFileInput.make, {\n                      id: \"sc-images-editor__cover-image-input\",\n                      disabled: state.updating,\n                      name: \"cover_image\",\n                      onChange: (function (param) {\n                          return updateCoverImage(send, param);\n                        }),\n                      labelText: \"Cover image\",\n                      imageName: OptionUtils.map(SchoolCustomize__Customizations.filename, coverImage),\n                      selectedImageName: state.coverImageFilename,\n                      errorState: state.coverImageInvalid\n                    }), React.createElement(\"div\", {\n                      className: \"flex justify-end\"\n                    }, React.createElement(\"button\", {\n                          key: \"sc-images-editor__update-button\",\n                          className: \"btn btn-primary btn-large mt-6\",\n                          disabled: updateButtonDisabled(state),\n                          type: \"submit\"\n                        }, state.updating ? \"Updating...\" : \"Update Images\"))));\n}\n\nvar maxAllowedSize = 2097152;\n\nvar make = SchoolCustomize__ImagesEditor;\n\nexports.str = str;\nexports.updateButtonText = updateButtonText;\nexports.formId = formId;\nexports.handleUpdateImages = handleUpdateImages;\nexports.updateButtonDisabled = updateButtonDisabled;\nexports.maxAllowedSize = maxAllowedSize;\nexports.isInvalidImageFile = isInvalidImageFile;\nexports.updateLogoOnLightBg = updateLogoOnLightBg;\nexports.updateCoverImage = updateCoverImage;\nexports.updateIcon = updateIcon;\nexports.imageUploader = imageUploader;\nexports.initialState = initialState;\nexports.reducer = reducer;\nexports.make = make;\n/* Api Not a pure module */\n"]},"metadata":{},"sourceType":"module"}