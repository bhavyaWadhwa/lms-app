{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar Avatar = require(\"../../../shared/Avatar.bs.js\");\n\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\n\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\n\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\n\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\n\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\n\nvar GraphqlQuery = require(\"../../../shared/utils/GraphqlQuery.bs.js\");\n\nvar MarkdownBlock = require(\"../../../shared/components/MarkdownBlock.bs.js\");\n\nvar DisablingCover = require(\"../../../shared/components/DisablingCover.bs.js\");\n\nvar CoursesReview__Feedback = require(\"../types/CoursesReview__Feedback.bs.js\");\n\nvar CoursesReview__FeedbackEditor = require(\"./CoursesReview__FeedbackEditor.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nvar ppx_printed_query = \"mutation CreateFeedbackMutation($submissionId: ID!, $feedback: String!)  {\\ncreateFeedback(submissionId: $submissionId, feedback: $feedback)  {\\nsuccess  \\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"createFeedback\");\n  var tmp;\n\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"success\");\n    var tmp$1;\n\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeBoolean(value$3);\n      tmp$1 = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$3));\n    } else {\n      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field success on type CreateFeedbackPayload is missing\");\n    }\n\n    tmp = {\n      success: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field createFeedback on type Mutation is missing\");\n  }\n\n  return {\n    createFeedback: tmp\n  };\n}\n\nfunction make(submissionId, feedback, param) {\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"submissionId\", submissionId],\n    /* tuple */\n    [\"feedback\", feedback]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeWithVariables(variables) {\n  var submissionId = variables.submissionId;\n  var feedback = variables.feedback;\n  return {\n    query: ppx_printed_query,\n    variables: Js_dict.fromArray([\n    /* tuple */\n    [\"submissionId\", submissionId],\n    /* tuple */\n    [\"feedback\", feedback]].filter(function (param) {\n      return !Js_json.test(param[1],\n      /* Null */\n      5);\n    })),\n    parse: parse\n  };\n}\n\nfunction makeVariables(submissionId, feedback, param) {\n  return Js_dict.fromArray([\n  /* tuple */\n  [\"submissionId\", submissionId],\n  /* tuple */\n  [\"feedback\", feedback]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  }));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, submissionId, feedback, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n  /* tuple */\n  [\"submissionId\", submissionId],\n  /* tuple */\n  [\"feedback\", feedback]].filter(function (param) {\n    return !Js_json.test(param[1],\n    /* Null */\n    5);\n  })));\n}\n\nvar definition =\n/* tuple */\n[parse, ppx_printed_query, definition_002];\n\nfunction ret_type(f) {\n  return {};\n}\n\nvar MT_Ret = {};\nvar CreateFeedbackMutation = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction createFeedback(submissionId, feedback, setState, addFeedbackCB) {\n  Curry._1(setState, function (state) {\n    return {\n      saving: true,\n      newFeedback: state.newFeedback,\n      showFeedbackEditor: state.showFeedbackEditor\n    };\n  });\n\n  (function (eta) {\n    return GraphqlQuery.sendQuery(undefined, eta);\n  })(make(submissionId, feedback,\n  /* () */\n  0)).then(function (response) {\n    if (response.createFeedback.success) {\n      Curry._1(addFeedbackCB, feedback);\n\n      Curry._1(setState, function (param) {\n        return {\n          saving: false,\n          newFeedback: \"\",\n          showFeedbackEditor: false\n        };\n      });\n    } else {\n      Curry._1(setState, function (state) {\n        return {\n          saving: false,\n          newFeedback: state.newFeedback,\n          showFeedbackEditor: state.showFeedbackEditor\n        };\n      });\n    }\n\n    return Promise.resolve(\n    /* () */\n    0);\n  });\n  return (\n    /* () */\n    0\n  );\n}\n\nfunction showFeedback(feedback) {\n  return $$Array.mapi(function (index, f) {\n    var match = CoursesReview__Feedback.coachAvatarUrl(f);\n    return React.createElement(\"div\", {\n      key: String(index),\n      className: \"border-t p-4 md:p-6\"\n    }, React.createElement(\"div\", {\n      className: \"flex items-center\"\n    }, React.createElement(\"div\", {\n      className: \"flex-shrink-0 w-12 h-12 bg-gray-300 rounded-full overflow-hidden mr-3 object-cover\"\n    }, match !== undefined ? React.createElement(\"img\", {\n      src: match\n    }) : React.createElement(Avatar.make, {\n      name: CoursesReview__Feedback.coachName(f)\n    })), React.createElement(\"div\", undefined, React.createElement(\"p\", {\n      className: \"text-xs leading-tight\"\n    }, \"Feedback from:\"), React.createElement(\"div\", undefined, React.createElement(\"h4\", {\n      className: \"font-semibold text-base leading-tight block md:inline-flex self-end\"\n    }, CoursesReview__Feedback.coachName(f)), React.createElement(\"span\", {\n      className: \"block md:inline-flex text-xs text-gray-800 md:ml-2 leading-tight self-end\"\n    }, \"(\" + (CoursesReview__Feedback.coachTitle(f) + \")\"))))), React.createElement(\"div\", {\n      className: \"md:ml-15\"\n    }, React.createElement(\"p\", {\n      className: \"text-xs leading-tight font-semibold inline-block p-1 bg-gray-200 rounded mt-3\"\n    }, CoursesReview__Feedback.createdAtPretty(f)), React.createElement(MarkdownBlock.make, {\n      markdown: CoursesReview__Feedback.value(f),\n      className: \"pt-1 text-sm\",\n      profile:\n      /* Permissive */\n      2\n    })));\n  }, feedback);\n}\n\nfunction _updateFeedbackCB(setState, newFeedback) {\n  return Curry._1(setState, function (state) {\n    return {\n      saving: state.saving,\n      newFeedback: newFeedback,\n      showFeedbackEditor: state.showFeedbackEditor\n    };\n  });\n}\n\nfunction CoursesReview__ShowFeedback(Props) {\n  var feedback = Props.feedback;\n  var reviewed = Props.reviewed;\n  var submissionId = Props.submissionId;\n  var reviewChecklist = Props.reviewChecklist;\n  var addFeedbackCB = Props.addFeedbackCB;\n  var updateReviewChecklistCB = Props.updateReviewChecklistCB;\n  var targetId = Props.targetId;\n  var match = React.useState(function () {\n    return {\n      saving: false,\n      newFeedback: \"\",\n      showFeedbackEditor: false\n    };\n  });\n  var setState = match[1];\n  var state = match[0];\n  return React.createElement(\"div\", {\n    \"aria-label\": \"feedback-section\",\n    className: \"pt-6\"\n  }, showFeedback(feedback), reviewed ? React.createElement(\"div\", {\n    className: \"bg-white rounded-b-lg\"\n  }, state.showFeedbackEditor ? React.createElement(\"div\", undefined, React.createElement(DisablingCover.make, {\n    disabled: state.saving,\n    children: React.createElement(CoursesReview__FeedbackEditor.make, {\n      feedback: state.newFeedback,\n      updateFeedbackCB: function updateFeedbackCB(param) {\n        return _updateFeedbackCB(setState, param);\n      },\n      label: \"Add feedback\",\n      reviewChecklist: reviewChecklist,\n      updateReviewChecklistCB: updateReviewChecklistCB,\n      checklistVisible: false,\n      targetId: targetId\n    })\n  }), React.createElement(\"div\", {\n    className: \"flex justify-end pr-4 pl-10 pt-2 pb-4 md:px-6 md:pb-6\"\n  }, React.createElement(\"button\", {\n    className: \"btn btn-success border border-green-600 w-full md:w-auto\",\n    disabled: state.newFeedback === \"\" || state.saving,\n    onClick: function onClick(param) {\n      return createFeedback(submissionId, state.newFeedback, setState, addFeedbackCB);\n    }\n  }, \"Share Feedback\"))) : React.createElement(\"div\", {\n    className: \"bg-gray-200 px-3 py-5 shadow-inner rounded-b-lg text-center\"\n  }, React.createElement(\"button\", {\n    className: \"btn btn-primary-ghost cursor-pointer shadow hover:shadow-lg w-full md:w-auto\",\n    onClick: function onClick(param) {\n      return Curry._1(setState, function (state) {\n        return {\n          saving: state.saving,\n          newFeedback: state.newFeedback,\n          showFeedbackEditor: true\n        };\n      });\n    }\n  }, feedback.length !== 0 ? \"Add another feedback\" : \"Add feedback\"))) : null);\n}\n\nvar make$1 = CoursesReview__ShowFeedback;\nexports.str = str;\nexports.CreateFeedbackMutation = CreateFeedbackMutation;\nexports.createFeedback = createFeedback;\nexports.showFeedback = showFeedback;\nexports.updateFeedbackCB = _updateFeedbackCB;\nexports.make = make$1;\n/* react Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/courses/review/components/CoursesReview__ShowFeedback.bs.js"],"names":["$$Array","require","Curry","React","Avatar","Js_exn","Js_dict","Js_json","Js_option","Caml_option","GraphqlQuery","MarkdownBlock","DisablingCover","CoursesReview__Feedback","CoursesReview__FeedbackEditor","str","prim","ppx_printed_query","parse","value","value$1","getExn","decodeObject","match","get","tmp","undefined","value$2","valFromOption","match$1","tmp$1","value$3","match$2","decodeBoolean","raiseError","JSON","stringify","success","createFeedback","make","submissionId","feedback","param","query","variables","fromArray","filter","test","makeWithVariables","makeVariables","definition_002","graphql_ppx_use_json_variables_fn","_1","definition","ret_type","f","MT_Ret","CreateFeedbackMutation","setState","addFeedbackCB","state","saving","newFeedback","showFeedbackEditor","eta","sendQuery","then","response","Promise","resolve","showFeedback","mapi","index","coachAvatarUrl","createElement","key","String","className","src","name","coachName","coachTitle","createdAtPretty","markdown","profile","updateFeedbackCB","CoursesReview__ShowFeedback","Props","reviewed","reviewChecklist","updateReviewChecklistCB","targetId","useState","disabled","children","label","checklistVisible","onClick","length","make$1","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar Avatar = require(\"../../../shared/Avatar.bs.js\");\nvar Js_exn = require(\"bs-platform/lib/js/js_exn.js\");\nvar Js_dict = require(\"bs-platform/lib/js/js_dict.js\");\nvar Js_json = require(\"bs-platform/lib/js/js_json.js\");\nvar Js_option = require(\"bs-platform/lib/js/js_option.js\");\nvar Caml_option = require(\"bs-platform/lib/js/caml_option.js\");\nvar GraphqlQuery = require(\"../../../shared/utils/GraphqlQuery.bs.js\");\nvar MarkdownBlock = require(\"../../../shared/components/MarkdownBlock.bs.js\");\nvar DisablingCover = require(\"../../../shared/components/DisablingCover.bs.js\");\nvar CoursesReview__Feedback = require(\"../types/CoursesReview__Feedback.bs.js\");\nvar CoursesReview__FeedbackEditor = require(\"./CoursesReview__FeedbackEditor.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nvar ppx_printed_query = \"mutation CreateFeedbackMutation($submissionId: ID!, $feedback: String!)  {\\ncreateFeedback(submissionId: $submissionId, feedback: $feedback)  {\\nsuccess  \\n}\\n\\n}\\n\";\n\nfunction parse(value) {\n  var value$1 = Js_option.getExn(Js_json.decodeObject(value));\n  var match = Js_dict.get(value$1, \"createFeedback\");\n  var tmp;\n  if (match !== undefined) {\n    var value$2 = Js_option.getExn(Js_json.decodeObject(Caml_option.valFromOption(match)));\n    var match$1 = Js_dict.get(value$2, \"success\");\n    var tmp$1;\n    if (match$1 !== undefined) {\n      var value$3 = Caml_option.valFromOption(match$1);\n      var match$2 = Js_json.decodeBoolean(value$3);\n      tmp$1 = match$2 !== undefined ? match$2 : Js_exn.raiseError(\"graphql_ppx: Expected boolean, got \" + JSON.stringify(value$3));\n    } else {\n      tmp$1 = Js_exn.raiseError(\"graphql_ppx: Field success on type CreateFeedbackPayload is missing\");\n    }\n    tmp = {\n      success: tmp$1\n    };\n  } else {\n    tmp = Js_exn.raiseError(\"graphql_ppx: Field createFeedback on type Mutation is missing\");\n  }\n  return {\n          createFeedback: tmp\n        };\n}\n\nfunction make(submissionId, feedback, param) {\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"submissionId\",\n                    submissionId\n                  ],\n                  /* tuple */[\n                    \"feedback\",\n                    feedback\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeWithVariables(variables) {\n  var submissionId = variables.submissionId;\n  var feedback = variables.feedback;\n  return {\n          query: ppx_printed_query,\n          variables: Js_dict.fromArray([\n                  /* tuple */[\n                    \"submissionId\",\n                    submissionId\n                  ],\n                  /* tuple */[\n                    \"feedback\",\n                    feedback\n                  ]\n                ].filter((function (param) {\n                      return !Js_json.test(param[1], /* Null */5);\n                    }))),\n          parse: parse\n        };\n}\n\nfunction makeVariables(submissionId, feedback, param) {\n  return Js_dict.fromArray([\n                /* tuple */[\n                  \"submissionId\",\n                  submissionId\n                ],\n                /* tuple */[\n                  \"feedback\",\n                  feedback\n                ]\n              ].filter((function (param) {\n                    return !Js_json.test(param[1], /* Null */5);\n                  })));\n}\n\nfunction definition_002(graphql_ppx_use_json_variables_fn, submissionId, feedback, param) {\n  return Curry._1(graphql_ppx_use_json_variables_fn, Js_dict.fromArray([\n                    /* tuple */[\n                      \"submissionId\",\n                      submissionId\n                    ],\n                    /* tuple */[\n                      \"feedback\",\n                      feedback\n                    ]\n                  ].filter((function (param) {\n                        return !Js_json.test(param[1], /* Null */5);\n                      }))));\n}\n\nvar definition = /* tuple */[\n  parse,\n  ppx_printed_query,\n  definition_002\n];\n\nfunction ret_type(f) {\n  return { };\n}\n\nvar MT_Ret = { };\n\nvar CreateFeedbackMutation = {\n  ppx_printed_query: ppx_printed_query,\n  query: ppx_printed_query,\n  parse: parse,\n  make: make,\n  makeWithVariables: makeWithVariables,\n  makeVariables: makeVariables,\n  definition: definition,\n  ret_type: ret_type,\n  MT_Ret: MT_Ret\n};\n\nfunction createFeedback(submissionId, feedback, setState, addFeedbackCB) {\n  Curry._1(setState, (function (state) {\n          return {\n                  saving: true,\n                  newFeedback: state.newFeedback,\n                  showFeedbackEditor: state.showFeedbackEditor\n                };\n        }));\n  (function (eta) {\n          return GraphqlQuery.sendQuery(undefined, eta);\n        })(make(submissionId, feedback, /* () */0)).then((function (response) {\n          if (response.createFeedback.success) {\n            Curry._1(addFeedbackCB, feedback);\n            Curry._1(setState, (function (param) {\n                    return {\n                            saving: false,\n                            newFeedback: \"\",\n                            showFeedbackEditor: false\n                          };\n                  }));\n          } else {\n            Curry._1(setState, (function (state) {\n                    return {\n                            saving: false,\n                            newFeedback: state.newFeedback,\n                            showFeedbackEditor: state.showFeedbackEditor\n                          };\n                  }));\n          }\n          return Promise.resolve(/* () */0);\n        }));\n  return /* () */0;\n}\n\nfunction showFeedback(feedback) {\n  return $$Array.mapi((function (index, f) {\n                var match = CoursesReview__Feedback.coachAvatarUrl(f);\n                return React.createElement(\"div\", {\n                            key: String(index),\n                            className: \"border-t p-4 md:p-6\"\n                          }, React.createElement(\"div\", {\n                                className: \"flex items-center\"\n                              }, React.createElement(\"div\", {\n                                    className: \"flex-shrink-0 w-12 h-12 bg-gray-300 rounded-full overflow-hidden mr-3 object-cover\"\n                                  }, match !== undefined ? React.createElement(\"img\", {\n                                          src: match\n                                        }) : React.createElement(Avatar.make, {\n                                          name: CoursesReview__Feedback.coachName(f)\n                                        })), React.createElement(\"div\", undefined, React.createElement(\"p\", {\n                                        className: \"text-xs leading-tight\"\n                                      }, \"Feedback from:\"), React.createElement(\"div\", undefined, React.createElement(\"h4\", {\n                                            className: \"font-semibold text-base leading-tight block md:inline-flex self-end\"\n                                          }, CoursesReview__Feedback.coachName(f)), React.createElement(\"span\", {\n                                            className: \"block md:inline-flex text-xs text-gray-800 md:ml-2 leading-tight self-end\"\n                                          }, \"(\" + (CoursesReview__Feedback.coachTitle(f) + \")\"))))), React.createElement(\"div\", {\n                                className: \"md:ml-15\"\n                              }, React.createElement(\"p\", {\n                                    className: \"text-xs leading-tight font-semibold inline-block p-1 bg-gray-200 rounded mt-3\"\n                                  }, CoursesReview__Feedback.createdAtPretty(f)), React.createElement(MarkdownBlock.make, {\n                                    markdown: CoursesReview__Feedback.value(f),\n                                    className: \"pt-1 text-sm\",\n                                    profile: /* Permissive */2\n                                  })));\n              }), feedback);\n}\n\nfunction updateFeedbackCB(setState, newFeedback) {\n  return Curry._1(setState, (function (state) {\n                return {\n                        saving: state.saving,\n                        newFeedback: newFeedback,\n                        showFeedbackEditor: state.showFeedbackEditor\n                      };\n              }));\n}\n\nfunction CoursesReview__ShowFeedback(Props) {\n  var feedback = Props.feedback;\n  var reviewed = Props.reviewed;\n  var submissionId = Props.submissionId;\n  var reviewChecklist = Props.reviewChecklist;\n  var addFeedbackCB = Props.addFeedbackCB;\n  var updateReviewChecklistCB = Props.updateReviewChecklistCB;\n  var targetId = Props.targetId;\n  var match = React.useState((function () {\n          return {\n                  saving: false,\n                  newFeedback: \"\",\n                  showFeedbackEditor: false\n                };\n        }));\n  var setState = match[1];\n  var state = match[0];\n  return React.createElement(\"div\", {\n              \"aria-label\": \"feedback-section\",\n              className: \"pt-6\"\n            }, showFeedback(feedback), reviewed ? React.createElement(\"div\", {\n                    className: \"bg-white rounded-b-lg\"\n                  }, state.showFeedbackEditor ? React.createElement(\"div\", undefined, React.createElement(DisablingCover.make, {\n                              disabled: state.saving,\n                              children: React.createElement(CoursesReview__FeedbackEditor.make, {\n                                    feedback: state.newFeedback,\n                                    updateFeedbackCB: (function (param) {\n                                        return updateFeedbackCB(setState, param);\n                                      }),\n                                    label: \"Add feedback\",\n                                    reviewChecklist: reviewChecklist,\n                                    updateReviewChecklistCB: updateReviewChecklistCB,\n                                    checklistVisible: false,\n                                    targetId: targetId\n                                  })\n                            }), React.createElement(\"div\", {\n                              className: \"flex justify-end pr-4 pl-10 pt-2 pb-4 md:px-6 md:pb-6\"\n                            }, React.createElement(\"button\", {\n                                  className: \"btn btn-success border border-green-600 w-full md:w-auto\",\n                                  disabled: state.newFeedback === \"\" || state.saving,\n                                  onClick: (function (param) {\n                                      return createFeedback(submissionId, state.newFeedback, setState, addFeedbackCB);\n                                    })\n                                }, \"Share Feedback\"))) : React.createElement(\"div\", {\n                          className: \"bg-gray-200 px-3 py-5 shadow-inner rounded-b-lg text-center\"\n                        }, React.createElement(\"button\", {\n                              className: \"btn btn-primary-ghost cursor-pointer shadow hover:shadow-lg w-full md:w-auto\",\n                              onClick: (function (param) {\n                                  return Curry._1(setState, (function (state) {\n                                                return {\n                                                        saving: state.saving,\n                                                        newFeedback: state.newFeedback,\n                                                        showFeedbackEditor: true\n                                                      };\n                                              }));\n                                })\n                            }, feedback.length !== 0 ? \"Add another feedback\" : \"Add feedback\"))) : null);\n}\n\nvar make$1 = CoursesReview__ShowFeedback;\n\nexports.str = str;\nexports.CreateFeedbackMutation = CreateFeedbackMutation;\nexports.createFeedback = createFeedback;\nexports.showFeedback = showFeedback;\nexports.updateFeedbackCB = updateFeedbackCB;\nexports.make = make$1;\n/* react Not a pure module */\n"]},"metadata":{},"sourceType":"module"}