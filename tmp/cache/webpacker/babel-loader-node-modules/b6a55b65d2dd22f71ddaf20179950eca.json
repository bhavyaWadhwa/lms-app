{"ast":null,"code":"// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\n\nvar Block = require(\"bs-platform/lib/js/block.js\");\n\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\n\nvar React = require(\"react\");\n\nvar MultiselectDropdown = require(\"../../../../packages/multiselect-dropdown/src/components/MultiselectDropdown.bs.js\");\n\nvar StudentsEditor__Level = require(\"../../types/students_editor/StudentsEditor__Level.bs.js\");\n\nvar StudentsEditor__Filter = require(\"../../types/students_editor/StudentsEditor__Filter.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction label(t) {\n  var tmp;\n\n  switch (t.tag | 0) {\n    case\n    /* Level */\n    0:\n      tmp = \"Level \" + String(StudentsEditor__Level.number(t[0]));\n      break;\n\n    case\n    /* Tag */\n    1:\n      tmp = \"Tag\";\n      break;\n\n    case\n    /* NameOrEmail */\n    2:\n      tmp = \"Name or Email\";\n      break;\n  }\n\n  return tmp;\n}\n\nfunction value(t) {\n  switch (t.tag | 0) {\n    case\n    /* Level */\n    0:\n      return StudentsEditor__Level.name(t[0]);\n\n    case\n    /* Tag */\n    1:\n    case\n    /* NameOrEmail */\n    2:\n      return t[0];\n  }\n}\n\nfunction searchString(t) {\n  switch (t.tag | 0) {\n    case\n    /* Level */\n    0:\n      return StudentsEditor__Level.title(t[0]);\n\n    case\n    /* Tag */\n    1:\n      return \"tag \" + t[0];\n\n    case\n    /* NameOrEmail */\n    2:\n      return t[0];\n  }\n}\n\nfunction color(t) {\n  switch (t.tag | 0) {\n    case\n    /* Level */\n    0:\n      return \"orange\";\n\n    case\n    /* Tag */\n    1:\n      return \"gray\";\n\n    case\n    /* NameOrEmail */\n    2:\n      return \"purple\";\n  }\n}\n\nfunction makeLevel(level) {\n  return (\n    /* Level */\n    Block.__(0, [level])\n  );\n}\n\nfunction makeTag(tag) {\n  return (\n    /* Tag */\n    Block.__(1, [tag])\n  );\n}\n\nfunction makeNameOrEmail(input) {\n  return (\n    /* NameOrEmail */\n    Block.__(2, [input])\n  );\n}\n\nvar Selectable = {\n  label: label,\n  value: value,\n  searchString: searchString,\n  color: color,\n  makeLevel: makeLevel,\n  makeTag: makeTag,\n  makeNameOrEmail: makeNameOrEmail\n};\nvar MultiselectDropdown$1 = MultiselectDropdown.Make(Selectable);\n\nfunction updateFilter(setSearchInput, updateFilterCB, filter) {\n  Curry._1(updateFilterCB, filter);\n\n  return Curry._1(setSearchInput, function (param) {\n    return \"\";\n  });\n}\n\nfunction selected(filter, levels) {\n  var match = StudentsEditor__Filter.levelId(filter);\n  var level = match !== undefined ? [\n  /* Level */\n  Block.__(0, [StudentsEditor__Level.unsafeFind(levels, \"Search\", match)])] : [];\n  var match$1 = StudentsEditor__Filter.searchString(filter);\n  var searchString;\n\n  if (match$1 !== undefined) {\n    var s = match$1;\n    searchString = s.trim() === \"\" ? [] : [\n    /* NameOrEmail */\n    Block.__(2, [s])];\n  } else {\n    searchString = [];\n  }\n\n  var tags = $$Array.map(function (t) {\n    return (\n      /* Tag */\n      Block.__(1, [t])\n    );\n  }, StudentsEditor__Filter.tags(filter));\n  return $$Array.append(level, $$Array.append(tags, searchString));\n}\n\nfunction unselected(tags, levels, filter, searchInput) {\n  var tagSuggestions = $$Array.map(function (t) {\n    return (\n      /* Tag */\n      Block.__(1, [t])\n    );\n  }, tags.filter(function (t) {\n    return !$$Array.mem(t, StudentsEditor__Filter.tags(filter));\n  }));\n  var match = StudentsEditor__Filter.levelId(filter);\n  var tmp;\n\n  if (match !== undefined) {\n    var levelId = match;\n    tmp = levels.filter(function (l) {\n      return StudentsEditor__Level.id(l) !== levelId;\n    });\n  } else {\n    tmp = levels;\n  }\n\n  var levelSuggestions = $$Array.map(function (l) {\n    return (\n      /* Level */\n      Block.__(0, [l])\n    );\n  }, tmp);\n  var searchSuggestion = searchInput.trim() === \"\" ? [] : [\n  /* NameOrEmail */\n  Block.__(2, [searchInput])];\n  return $$Array.append(levelSuggestions, $$Array.append(tagSuggestions, searchSuggestion));\n}\n\nfunction select(filter, updateFilterCB, setSearchInput, selectable) {\n  var filter$1;\n\n  switch (selectable.tag | 0) {\n    case\n    /* Level */\n    0:\n      filter$1 = StudentsEditor__Filter.changeLevelId(StudentsEditor__Level.id(selectable[0]), filter);\n      break;\n\n    case\n    /* Tag */\n    1:\n      filter$1 = StudentsEditor__Filter.addTag(selectable[0], filter);\n      break;\n\n    case\n    /* NameOrEmail */\n    2:\n      filter$1 = StudentsEditor__Filter.changeSearchString(selectable[0], filter);\n      break;\n  }\n\n  Curry._1(updateFilterCB, filter$1);\n\n  return Curry._1(setSearchInput, function (param) {\n    return \"\";\n  });\n}\n\nfunction deselect(filter, updateFilterCB, selectable) {\n  var tmp;\n\n  switch (selectable.tag | 0) {\n    case\n    /* Level */\n    0:\n      tmp = StudentsEditor__Filter.removeLevelId(filter);\n      break;\n\n    case\n    /* Tag */\n    1:\n      tmp = StudentsEditor__Filter.removeTag(selectable[0], filter);\n      break;\n\n    case\n    /* NameOrEmail */\n    2:\n      tmp = StudentsEditor__Filter.removeSearchString(filter);\n      break;\n  }\n\n  return Curry._1(updateFilterCB, tmp);\n}\n\nfunction updateSearchInput(setSearchInput, searchInput) {\n  return Curry._1(setSearchInput, function (param) {\n    return searchInput;\n  });\n}\n\nfunction StudentsEditor__Search(Props) {\n  var filter = Props.filter;\n  var updateFilterCB = Props.updateFilterCB;\n  var tags = Props.tags;\n  var levels = Props.levels;\n  var match = React.useState(function () {\n    return \"\";\n  });\n  var setSearchInput = match[1];\n  var searchInput = match[0];\n  var id = \"search\";\n  return React.createElement(\"div\", {\n    className: \"inline-block w-full\"\n  }, React.createElement(\"label\", {\n    className: \"block text-tiny font-semibold uppercase\",\n    htmlFor: id\n  }, \"Filter by:\"), React.createElement(MultiselectDropdown$1.make, {\n    id: id,\n    placeholder: \"Type name, tag or level\",\n    onChange: function onChange(param) {\n      return Curry._1(setSearchInput, function (param$1) {\n        return param;\n      });\n    },\n    value: searchInput,\n    unselected: unselected(tags, levels, filter, searchInput),\n    selected: selected(filter, levels),\n    onSelect: function onSelect(param) {\n      return select(filter, updateFilterCB, setSearchInput, param);\n    },\n    onDeselect: function onDeselect(param) {\n      return deselect(filter, updateFilterCB, param);\n    }\n  }));\n}\n\nvar make = StudentsEditor__Search;\nexports.str = str;\nexports.Selectable = Selectable;\nexports.MultiselectDropdown = MultiselectDropdown$1;\nexports.updateFilter = updateFilter;\nexports.selected = selected;\nexports.unselected = unselected;\nexports.select = select;\nexports.deselect = deselect;\nexports.updateSearchInput = updateSearchInput;\nexports.make = make;\n/* MultiselectDropdown Not a pure module */","map":{"version":3,"sources":["/home/kochar/Documents/pupilfirst-master/app/javascript/schools/courses/components/students_editor/StudentsEditor__Search.bs.js"],"names":["$$Array","require","Block","Curry","React","MultiselectDropdown","StudentsEditor__Level","StudentsEditor__Filter","str","prim","label","t","tmp","tag","String","number","value","name","searchString","title","color","makeLevel","level","__","makeTag","makeNameOrEmail","input","Selectable","MultiselectDropdown$1","Make","updateFilter","setSearchInput","updateFilterCB","filter","_1","param","selected","levels","match","levelId","undefined","unsafeFind","match$1","s","trim","tags","map","append","unselected","searchInput","tagSuggestions","mem","l","id","levelSuggestions","searchSuggestion","select","selectable","filter$1","changeLevelId","addTag","changeSearchString","deselect","removeLevelId","removeTag","removeSearchString","updateSearchInput","StudentsEditor__Search","Props","useState","createElement","className","htmlFor","make","placeholder","onChange","param$1","onSelect","onDeselect","exports"],"mappings":"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","sourcesContent":["// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE\n'use strict';\n\nvar $$Array = require(\"bs-platform/lib/js/array.js\");\nvar Block = require(\"bs-platform/lib/js/block.js\");\nvar Curry = require(\"bs-platform/lib/js/curry.js\");\nvar React = require(\"react\");\nvar MultiselectDropdown = require(\"../../../../packages/multiselect-dropdown/src/components/MultiselectDropdown.bs.js\");\nvar StudentsEditor__Level = require(\"../../types/students_editor/StudentsEditor__Level.bs.js\");\nvar StudentsEditor__Filter = require(\"../../types/students_editor/StudentsEditor__Filter.bs.js\");\n\nfunction str(prim) {\n  return prim;\n}\n\nfunction label(t) {\n  var tmp;\n  switch (t.tag | 0) {\n    case /* Level */0 :\n        tmp = \"Level \" + String(StudentsEditor__Level.number(t[0]));\n        break;\n    case /* Tag */1 :\n        tmp = \"Tag\";\n        break;\n    case /* NameOrEmail */2 :\n        tmp = \"Name or Email\";\n        break;\n    \n  }\n  return tmp;\n}\n\nfunction value(t) {\n  switch (t.tag | 0) {\n    case /* Level */0 :\n        return StudentsEditor__Level.name(t[0]);\n    case /* Tag */1 :\n    case /* NameOrEmail */2 :\n        return t[0];\n    \n  }\n}\n\nfunction searchString(t) {\n  switch (t.tag | 0) {\n    case /* Level */0 :\n        return StudentsEditor__Level.title(t[0]);\n    case /* Tag */1 :\n        return \"tag \" + t[0];\n    case /* NameOrEmail */2 :\n        return t[0];\n    \n  }\n}\n\nfunction color(t) {\n  switch (t.tag | 0) {\n    case /* Level */0 :\n        return \"orange\";\n    case /* Tag */1 :\n        return \"gray\";\n    case /* NameOrEmail */2 :\n        return \"purple\";\n    \n  }\n}\n\nfunction makeLevel(level) {\n  return /* Level */Block.__(0, [level]);\n}\n\nfunction makeTag(tag) {\n  return /* Tag */Block.__(1, [tag]);\n}\n\nfunction makeNameOrEmail(input) {\n  return /* NameOrEmail */Block.__(2, [input]);\n}\n\nvar Selectable = {\n  label: label,\n  value: value,\n  searchString: searchString,\n  color: color,\n  makeLevel: makeLevel,\n  makeTag: makeTag,\n  makeNameOrEmail: makeNameOrEmail\n};\n\nvar MultiselectDropdown$1 = MultiselectDropdown.Make(Selectable);\n\nfunction updateFilter(setSearchInput, updateFilterCB, filter) {\n  Curry._1(updateFilterCB, filter);\n  return Curry._1(setSearchInput, (function (param) {\n                return \"\";\n              }));\n}\n\nfunction selected(filter, levels) {\n  var match = StudentsEditor__Filter.levelId(filter);\n  var level = match !== undefined ? [/* Level */Block.__(0, [StudentsEditor__Level.unsafeFind(levels, \"Search\", match)])] : [];\n  var match$1 = StudentsEditor__Filter.searchString(filter);\n  var searchString;\n  if (match$1 !== undefined) {\n    var s = match$1;\n    searchString = s.trim() === \"\" ? [] : [/* NameOrEmail */Block.__(2, [s])];\n  } else {\n    searchString = [];\n  }\n  var tags = $$Array.map((function (t) {\n          return /* Tag */Block.__(1, [t]);\n        }), StudentsEditor__Filter.tags(filter));\n  return $$Array.append(level, $$Array.append(tags, searchString));\n}\n\nfunction unselected(tags, levels, filter, searchInput) {\n  var tagSuggestions = $$Array.map((function (t) {\n          return /* Tag */Block.__(1, [t]);\n        }), tags.filter((function (t) {\n              return !$$Array.mem(t, StudentsEditor__Filter.tags(filter));\n            })));\n  var match = StudentsEditor__Filter.levelId(filter);\n  var tmp;\n  if (match !== undefined) {\n    var levelId = match;\n    tmp = levels.filter((function (l) {\n            return StudentsEditor__Level.id(l) !== levelId;\n          }));\n  } else {\n    tmp = levels;\n  }\n  var levelSuggestions = $$Array.map((function (l) {\n          return /* Level */Block.__(0, [l]);\n        }), tmp);\n  var searchSuggestion = searchInput.trim() === \"\" ? [] : [/* NameOrEmail */Block.__(2, [searchInput])];\n  return $$Array.append(levelSuggestions, $$Array.append(tagSuggestions, searchSuggestion));\n}\n\nfunction select(filter, updateFilterCB, setSearchInput, selectable) {\n  var filter$1;\n  switch (selectable.tag | 0) {\n    case /* Level */0 :\n        filter$1 = StudentsEditor__Filter.changeLevelId(StudentsEditor__Level.id(selectable[0]), filter);\n        break;\n    case /* Tag */1 :\n        filter$1 = StudentsEditor__Filter.addTag(selectable[0], filter);\n        break;\n    case /* NameOrEmail */2 :\n        filter$1 = StudentsEditor__Filter.changeSearchString(selectable[0], filter);\n        break;\n    \n  }\n  Curry._1(updateFilterCB, filter$1);\n  return Curry._1(setSearchInput, (function (param) {\n                return \"\";\n              }));\n}\n\nfunction deselect(filter, updateFilterCB, selectable) {\n  var tmp;\n  switch (selectable.tag | 0) {\n    case /* Level */0 :\n        tmp = StudentsEditor__Filter.removeLevelId(filter);\n        break;\n    case /* Tag */1 :\n        tmp = StudentsEditor__Filter.removeTag(selectable[0], filter);\n        break;\n    case /* NameOrEmail */2 :\n        tmp = StudentsEditor__Filter.removeSearchString(filter);\n        break;\n    \n  }\n  return Curry._1(updateFilterCB, tmp);\n}\n\nfunction updateSearchInput(setSearchInput, searchInput) {\n  return Curry._1(setSearchInput, (function (param) {\n                return searchInput;\n              }));\n}\n\nfunction StudentsEditor__Search(Props) {\n  var filter = Props.filter;\n  var updateFilterCB = Props.updateFilterCB;\n  var tags = Props.tags;\n  var levels = Props.levels;\n  var match = React.useState((function () {\n          return \"\";\n        }));\n  var setSearchInput = match[1];\n  var searchInput = match[0];\n  var id = \"search\";\n  return React.createElement(\"div\", {\n              className: \"inline-block w-full\"\n            }, React.createElement(\"label\", {\n                  className: \"block text-tiny font-semibold uppercase\",\n                  htmlFor: id\n                }, \"Filter by:\"), React.createElement(MultiselectDropdown$1.make, {\n                  id: id,\n                  placeholder: \"Type name, tag or level\",\n                  onChange: (function (param) {\n                      return Curry._1(setSearchInput, (function (param$1) {\n                                    return param;\n                                  }));\n                    }),\n                  value: searchInput,\n                  unselected: unselected(tags, levels, filter, searchInput),\n                  selected: selected(filter, levels),\n                  onSelect: (function (param) {\n                      return select(filter, updateFilterCB, setSearchInput, param);\n                    }),\n                  onDeselect: (function (param) {\n                      return deselect(filter, updateFilterCB, param);\n                    })\n                }));\n}\n\nvar make = StudentsEditor__Search;\n\nexports.str = str;\nexports.Selectable = Selectable;\nexports.MultiselectDropdown = MultiselectDropdown$1;\nexports.updateFilter = updateFilter;\nexports.selected = selected;\nexports.unselected = unselected;\nexports.select = select;\nexports.deselect = deselect;\nexports.updateSearchInput = updateSearchInput;\nexports.make = make;\n/* MultiselectDropdown Not a pure module */\n"]},"metadata":{},"sourceType":"module"}